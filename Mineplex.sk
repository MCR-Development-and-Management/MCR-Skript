#(Old ugly acci text here)
#
#GitHub Version
#
#Mineplex Core Remake
#The best and only Mineplex Copy
#by Josh Roy (WheezyGold7931)
#Enjoy!
script options:
	$ use permissions

#Do not change these unless you want all hell to brake loose!
options:
	MCRVER: 2.3
	MCRHOTFIX: 1
	configver: taimen

#Functions

function Beam(e1: entity , e2: entity):
	spawn a squid at location 0 meter behind {_e1}'s head
	set {_el} to last spawned entity
	set target of {_el} to {_e2}
	apply invisibility to the last spawned entity
	add "{CustomName:""BeamGuar"", NoGravity:1, Silent:1, NoAI:1}" to nbt of last spawned entity
	set {_targLoc} to location of {_e2}
    
	loop 100 times:
		teleport {_el} to location 0 meter behind {_e1}'s head
		set target of {_el} to {_e2}
		add "{Motion:[0.0,0.0,0.0]}" to nbt of {_el}
		if "%{_e2}'s name%" is "BeamCow":
			teleport {_e2} to {_targLoc}
			add "{Motion:[0.0,0.0,0.0]}" to nbt of {_e2}
		wait 1 tick

	create a safe explosion with force 2 at {_e1}
	loop entities in radius 3 of {_e2}:
		make {_e1} damage loop-entity by (3 - (distance between loop-entity and {_e2}))
	teleport {_el} 300 blocks below {_el}
	teleport {_e2} 300 blocks below {_e2}
	kill {_el}
	kill {_e2}

function ClientBeam(e1: entity , e3: entity , e2: entity):
	spawn a cow at location of {_e2}
	set {_c} to last spawned entity
	add "{CustomName:""BeamCow"", NoGravity:1, Silent:1}" to nbt of last spawned entity
	spawn a guardian at location 1 meter behind {_e1}'s head
	set {_el} to last spawned entity
	set target of {_el} to {_e2}
	loop all players:
		protocol hide {_e1} from loop-player    
		protocol hide {_e2} from loop-player
	protocol show {_e1} to {_e3}
	protocol show {_e2} to {_e3}
	apply invisibility to {_c}
	apply invisibility to the last spawned entity
	add "{CustomName:""BeamGuar"", NoGravity:1, Silent:1}" to nbt of last spawned entity
	set {_targLoc} to location of {_e2}
    
	loop 100 times:
		teleport {_el} to location 1 meter behind {_e1}'s head
		add "{Motion:[0.0,0.0,0.0]}" to nbt of {_el}
		if "%{_e2}'s name%" is "BeamCow":
			teleport {_e2} to {_targLoc}
			add "{Motion:[0.0,0.0,0.0]}" to nbt of {_e2}
		wait 1 tick

	create a safe explosion with force 2 at {_e2}
	loop entities in radius 3 of {_c}:
		make {_e1} damage loop-entity by (3 - (distance between loop-entity and {_c}))
	teleport {_el} 300 blocks below {_el}
	teleport {_e2} 300 blocks below {_e2}
	kill {_el}
	kill {_c}

function configRefresh(n: number) :: number:
	set {mineplex.config.config} to value "config" get of "plugins/Mineplex-Core-Remake/config.yml"
	set {mineplex.config.servername} to value "servername" get of "plugins/Mineplex-Core-Remake/config.yml"
	set {mineplex.config.website} to value "website" get of "plugins/Mineplex-Core-Remake/config.yml"
	set {mineplex.config.appealwebsite} to value "appealwebsite" get of "plugins/Mineplex-Core-Remake/config.yml"
	set {mineplex.config.ruleswebsite} to value "ruleswebsite" get of "plugins/Mineplex-Core-Remake/config.yml"
	set {mineplex.config.youtube} to value "youtube" get of "plugins/Mineplex-Core-Remake/config.yml"
	set {mineplex.config.twitter} to value "twitter" get of "plugins/Mineplex-Core-Remake/config.yml"
	set {mineplex.config.shoplink} to value "shoplink" get of "plugins/Mineplex-Core-Remake/config.yml"
	set {mineplex.config.world} to value "worldname" get of "plugins/Mineplex-Core-Remake/config.yml"
	set {mineplex.config.doublejump} to value "doublejump" get of "plugins/Mineplex-Core-Remake/config.yml"

function configPopulate(n: number) :: number:
	create file "plugins/Mineplex-Core-Remake/config.yml"
	set "config" to "{@configver}" in yaml file "plugins/Mineplex-Core-Remake/config.yml"
	set "servername" to "MINEPLEX" in yaml file "plugins/Mineplex-Core-Remake/config.yml"
	set "website" to "www.mineplex.com" in yaml file "plugins/Mineplex-Core-Remake/config.yml"
	set "appealwebsite" to "www.mineplex.com/appeals" in yaml file "plugins/Mineplex-Core-Remake/config.yml"
	set "ruleswebsite" to "www.mineplex.com/rules" in yaml file "plugins/Mineplex-Core-Remake/config.yml"
	set "youtube" to "http://youtube.com/mineplexgamesofficial" in yaml file "plugins/Mineplex-Core-Remake/config.yml"
	set "twitter" to "http://twitter.com/mineplex" in yaml file "plugins/Mineplex-Core-Remake/config.yml"
	set "shoplink" to "www.mineplex.com/shop" in yaml file "plugins/Mineplex-Core-Remake/config.yml"
	set "worldname" to "world" in yaml file "plugins/Mineplex-Core-Remake/config.yml"
	set "doublejump" to "true" in yaml file "plugins/Mineplex-Core-Remake/config.yml"

function updateRankAPI(p: player) :: player:
	wait 5 ticks
	if {mineplex.rank.%{_p}%} is not set:
		set {mineplex.rank.%{_p}%} to ""
	if {mineplex.disguise.%{_p}%} is set:
		set {_br} to uncolored {mineplex.rank.%{_p}%}
		set {_dr} to uncolored {mineplex.rank.%{mineplex.disguise.%{_p}%}%}
		if {mineplex.rank.%{mineplex.disguise.%{_p}%}%} is set:
			make all players see {_p}'s prefix as "%{mineplex.rank.%{mineplex.disguise.%{_p}%}%}%&e"
		else:
			make all players see {_p}'s prefix as "&e"
		set {_br} to convert string "%{_br}%" to lowercase
		set {_br} to 1st char in each word of "%{_br}%" to caps
		set {_dr} to convert string "%{_dr}%" to lowercase
		set {_dr} to 1st char in each word of "%{_dr}%" to caps
		replace all " " in {_br} with ""
		replace all " " in {_dr} with ""
		if {_dr} is "":
			set {_dr} to "No Rank"
		set {mineplex.api.displayrank.%{_p}%} to "%{_dr}% (%{_br}%)"
		set {mineplex.api.displayname.%{_p}%} to "%{mineplex.disguise.%{_p}%}%"
	else:
		set {_br} to uncolored {mineplex.rank.%{_p}%}
		if {mineplex.rank.%{_p}%} is set:
			make all players see {_p}'s prefix as "%{mineplex.rank.%{_p}%}%&e"
		else:
			make all players see {_p}'s prefix as "&e"
		set {_br} to convert string "%{_br}%" to lowercase
		set {_br} to 1st char in each word of "%{_br}%" to caps
		if {_br} is "":
			set {_br} to "No Rank"
		set {mineplex.api.displayrank.%{_p}%} to "%{_br}%"
		set {mineplex.api.displayname.%{_p}%} to "%{_p}%"

function mcs(p: player , m: text) :: number:
	if {mineplex.overidechat} is true:
		if {mineplex.disguise.%{_p}%} is set:
			set  {_player} to {mineplex.disguise.%{_p}%}
		else:
			set {_player} to {_p}
		if {mineplex.rank.%{_player}%} is not set:
			set {mineplex.rank.%{_player}%} to ""
		if {mineplex.level.%{_player}%} is not set:
			set {mineplex.level.%{_player}%} to "&70"
		replace all " fuck ", " bitch " and " ass " with "****" in {_m}
		if {_m} is {mineplex.lastsent.%{_p}%}:
			send "&9Chat> &7This message is too similar to your previous message." to {_p}
			return -1
			stop
		if {mineplex.authlock.%{_p}%} is true:
			return -1
			stop
		set {mineplex.lastsent.%{_p}%} to {_m}
		loop all players:
			if {mineplex.pref.pc.%loop-player%} is true:
				send "%{mineplex.level.%{_player}%}% %{mineplex.rank.%{_player}%}%&e%{_player}% &f%{_m}%" to loop-player
		return -1
	else:
		stop

function gwenAlert(p: player , r: text) :: number:
	if {mineplex.disguise.%{_p}%} is set:
		set  {_player} to {mineplex.disguise.%{_p}%}
	else:
		set {_player} to {_p}
	loop all players:
		if loop-player has permission "mineplex.trainee":
			if {mineplex.pref.gwen.%loop-player%} is true:
				send "&b&kK&r &c&lGWEN > &6%{_player}% &esuspected of &a%{_r}%&e in &b%loop-player's world%&e." to loop-player

#Config Loading

on script unload:
	broadcast "&9MCR> &7Mineplex Core is recompiling!"

on load:
	if file "plugins/Mineplex-Core-Remake/config.yml" doesn't exists:
		configPopulate(1)
#	set {mineplex.config.servername} to colored value "servername" get of "plugins/Mineplex-Core-Remake/config.yml"
	configRefresh(1)
	wait 1 second
	if {mineplex.config.config} is "{@configver}":
		broadcast "&9MCR> &7Config &e{@configver} &7is up to date!"
	else:
		broadcast "&9Mineplex Core> &7Your Config is not up to Date! Updating this shit for you!"
		configPopulate(1)
		broadcast "&9Mineplex Core> &7Config Re-Populated!"
		broadcast "&9Mineplex Core> &7Going to reload plugin now!"
		wait 1 second
		configRefresh(1)
		broadcast "&9Mineplex Core> &7Config Done!"
	if {mineplex.usescoreboard} is not set:
		set {mineplex.usescoreboard} to true
	broadcast "&9MCR> &7Mineplex Core &e{@MCRVER} &7has been loaded!"

#Main Command/Toggles
command /mineplex-core <string> [<string>] [<string>]:
	usage: &9Do /mineplex-core help
	permission: op
	permission message: &9Permissions> &7This requires Permission Rank [&9OP&7].
	trigger:
		if argument 1 is "help":
			send "&9Plugin> &7Mineplex Core"
			send "&9Plugin> &7Running MCR: &e{@MCRVER}"
			send "&9Plugin> &7by WheezyGold7931, LimeGlass, Citrin_, HappyLuigi, and Torksi"
			send ""
			send "&9Mineplex Core> &7Listing Mineplex Core Options:"
			send "&f/mineplex-core useChat (true/false): &eToggles this plugin to take overide the chat to mineplex's format."
			send "&f/mineplex-core setAdmin (Player): &eGives the selected player admin perms (For all mineplex commands)!"
			send "&f/mineplex-core titleOnJoin (true/false): &eToggles if players will see news on join!"
			send "&f/mineplex-core useScoreboard (true/false) &eToggles if you want to use Mineplex Core's Scoreboard!"
			send "&f/mineplex-core chestPoint (1/2/3/4): &eSets a chest point to your target block!"
			send "&f/mineplex-core chestPointSub (1/2/3/4) (1/2/3/4/5/6/7/8): &eSets a chest point to your target block!"
			send "&f/mineplex-core spawnCarl: &eSummons carl to your location"
			send "&f/mineplex-core throwableTnt: &eToggles Mineplex Style Throwable TnT!"
			send "&f/mineplex-core reload : &eReloads the config for Mineplex Core!"
		else if argument 1 is "useChat":
			if argument 2 is "true":
				set {mineplex.overidechat} to true
				send "&9Chat> &7Now using Mineplex Chat System (MCS)."
			else:
				set {mineplex.overidechat} to false
				send "&9Chat> &7Now using Default Chat System (DCS)."
		else if argument 1 is "titleOnJoin":
			if argument 2 is "true":
				set {mineplex.news.allow} to true
				send "&9News> &7Now broadcasting titles on join!"
			else:
				set {mineplex.news.allow} to false
				send "&9News> &7No longer broadcasting titles on join!"
		else if argument 1 is "setAdmin":
			if argument 2 is set:
				set {mineplex.rank.%arg-1%} to "&4&lADMIN "
				set {_mineplex.setadmin.temp} to "%arg-2%" parsed as player
				execute console command "/__mp__dp__ %arg-2%"
				add "mineplex.trainee" to {_mineplex.setadmin.temp}'s permissions
				add "mineplex.legend" to {_mineplex.setadmin.temp}'s permissions
				add "mineplex.mod" to {_mineplex.setadmin.temp}'s permissions
				add "mineplex.builder" to {_mineplex.setadmin.temp}'s permissions
				add "mineplex.srmod" to {_mineplex.setadmin.temp}'s permissions
				add "mineplex.admin" to {_mineplex.setadmin.temp}'s permissions
				updateRankAPI({_mineplex.setadmin.temp})
				send "&9Ranks> &7Set %arg-2%'s rank to Admin"
		else if argument 1 is "reload":
			configRefresh(1)
			send "&9Mineplex Core> &7Config Refreshed!"
		else if argument 1 is "useScoreboard":
			if argument 2 is set:
				if argument 2 is "true":
					set {mineplex.usescoreboard} to true
					send "&9Mineplex Core> &7Scoreboard Enabled!"
				else:
					set {mineplex.usescoreboard} to false
					send "&9Mineplex Core> &7Scoreboard Disabled!"
					loop all players:
						wipe loop-player's sidebar
		else if argument 1 is "chestPoint":
			if argument 2 is set:
				if arg 2 is "1":
					set {mineplex.chestpoint.1} to target block
					send "&9Treasure> &7Set chest point 1 to your target block!"
				else if arg 2 is "2":
					set {mineplex.chestpoint.2} to target block
					send "&9Treasure> &7Set chest point 2 to your target block!"
				else if arg 2 is "3":
					set {mineplex.chestpoint.3} to target block
					send "&9Treasure> &7Set chest point 3 to your target block!"
				else if arg 2 is "4":
					set {mineplex.chestpoint.4} to target block
					send "&9Treasure> &7Set chest point 4 to your target block!"
		else if argument 1 is "chestPointSub":
			if argument 2 is set:
				if arg 3 is not set:
					send "&9Treasure> &7Define a sub chest! (1/2/3/4/5/6/7/8)"
				else:
					if arg 2 is "1":
						if arg 3 is "1":
							set {mineplex.chestpoint.1.sub.1} to target block
							send "&9Treasure> &7Set chest point 1's sub 1 to your target block!"
						else if arg 3 is "2":
							set {mineplex.chestpoint.1.sub.2} to target block
							send "&9Treasure> &7Set chest point 1's sub 2 to your target block!"
						else if arg 3 is "3":
							set {mineplex.chestpoint.1.sub.3} to target block
							send "&9Treasure> &7Set chest point 1's sub 3 to your target block!"
						else if arg 3 is "4":
							set {mineplex.chestpoint.1.sub.4} to target block
							send "&9Treasure> &7Set chest point 1's sub 4 to your target block!"
						else if arg 3 is "5":
							set {mineplex.chestpoint.1.sub.5} to target block
							send "&9Treasure> &7Set chest point 1's sub 5 to your target block!"
						else if arg 3 is "6":
							set {mineplex.chestpoint.1.sub.6} to target block
							send "&9Treasure> &7Set chest point 1's sub 6 to your target block!"
						else if arg 3 is "7":
							set {mineplex.chestpoint.1.sub.7} to target block
							send "&9Treasure> &7Set chest point 1's sub 7 to your target block!"
						else if arg 3 is "8":
							set {mineplex.chestpoint.1.sub.8} to target block
							send "&9Treasure> &7Set chest point 1's sub 8 to your target block!"
					else if arg 2 is "2":
						if arg 3 is "1":
							set {mineplex.chestpoint.2.sub.1} to target block
							send "&9Treasure> &7Set chest point 2's sub 1 to your target block!"
						else if arg 3 is "2":
							set {mineplex.chestpoint.2.sub.2} to target block
							send "&9Treasure> &7Set chest point 2's sub 2 to your target block!"
						else if arg 3 is "3":
							set {mineplex.chestpoint.2.sub.3} to target block
							send "&9Treasure> &7Set chest point 2's sub 3 to your target block!"
						else if arg 3 is "4":
							set {mineplex.chestpoint.2.sub.4} to target block
							send "&9Treasure> &7Set chest point 2's sub 4 to your target block!"
						else if arg 3 is "5":
							set {mineplex.chestpoint.2.sub.5} to target block
							send "&9Treasure> &7Set chest point 2's sub 5 to your target block!"
						else if arg 3 is "6":
							set {mineplex.chestpoint.2.sub.6} to target block
							send "&9Treasure> &7Set chest point 2's sub 6 to your target block!"
						else if arg 3 is "7":
							set {mineplex.chestpoint.2.sub.7} to target block
							send "&9Treasure> &7Set chest point 2's sub 7 to your target block!"
						else if arg 3 is "8":
							set {mineplex.chestpoint.2.sub.8} to target block
							send "&9Treasure> &7Set chest point 2's sub 8 to your target block!"
					else if arg 2 is "3":
						if arg 3 is "1":
							set {mineplex.chestpoint.3.sub.1} to target block
							send "&9Treasure> &7Set chest point 3's sub 1 to your target block!"
						else if arg 3 is "2":
							set {mineplex.chestpoint.3.sub.2} to target block
							send "&9Treasure> &7Set chest point 3's sub 2 to your target block!"
						else if arg 3 is "3":
							set {mineplex.chestpoint.3.sub.3} to target block
							send "&9Treasure> &7Set chest point 3's sub 3 to your target block!"
						else if arg 3 is "4":
							set {mineplex.chestpoint.3.sub.4} to target block
							send "&9Treasure> &7Set chest point 3's sub 4 to your target block!"
						else if arg 3 is "5":
							set {mineplex.chestpoint.3.sub.5} to target block
							send "&9Treasure> &7Set chest point 3's sub 5 to your target block!"
						else if arg 3 is "6":
							set {mineplex.chestpoint.3.sub.6} to target block
							send "&9Treasure> &7Set chest point 3's sub 6 to your target block!"
						else if arg 3 is "7":
							set {mineplex.chestpoint.3.sub.7} to target block
							send "&9Treasure> &7Set chest point 3's sub 7 to your target block!"
						else if arg 3 is "8":
							set {mineplex.chestpoint.3.sub.8} to target block
							send "&9Treasure> &7Set chest point 3's sub 8 to your target block!"
					else if arg 2 is "4":
						if arg 3 is "1":
							set {mineplex.chestpoint.4.sub.1} to target block
							send "&9Treasure> &7Set chest point 4's sub 1 to your target block!"
						else if arg 3 is "2":
							set {mineplex.chestpoint.4.sub.2} to target block
							send "&9Treasure> &7Set chest point 4's sub 2 to your target block!"
						else if arg 3 is "3":
							set {mineplex.chestpoint.4.sub.3} to target block
							send "&9Treasure> &7Set chest point 4's sub 3 to your target block!"
						else if arg 3 is "4":
							set {mineplex.chestpoint.4.sub.4} to target block
							send "&9Treasure> &7Set chest point 4's sub 4 to your target block!"
						else if arg 3 is "5":
							set {mineplex.chestpoint.4.sub.5} to target block
							send "&9Treasure> &7Set chest point 4's sub 5 to your target block!"
						else if arg 3 is "6":
							set {mineplex.chestpoint.4.sub.6} to target block
							send "&9Treasure> &7Set chest point 4's sub 6 to your target block!"
						else if arg 3 is "7":
							set {mineplex.chestpoint.4.sub.7} to target block
							send "&9Treasure> &7Set chest point 4's sub 7 to your target block!"
						else if arg 3 is "8":
							set {mineplex.chestpoint.4.sub.8} to target block
							send "&9Treasure> &7Set chest point 4's sub 8 to your target block!"
		else if arg 1 is "spawnCarl":
			spawn 1 creeper at location of player
			set {_carl} to spawned creeper
			set name of last spawned entity to "&a&lCarl the Creeper"
			add "{NoAI:1b}" to nbt of {_carl}
			add "{powered:1}" to nbt of {_carl}
			apply slowness 255 to last spawned entity for 999 days
			set {kitnpc} to location of player
			send "&9Carl> &7Carl is now apon you!"
		else if arg 1 is "throwableTnt":
			if {mineplex.tntlauncher} is true:
				send "&9Mineplex Core> &7Throwable TNT Disabled!"
				set {mineplex.tntlauncher} to false
			else:
				send "&9Mineplex Core> &7Throwable TNT Enabled!"
				set {mineplex.tntlauncher} to true

command /recompile [<string>]:
	permission: op
	permission message: &9Permissions> &7This requires Permission Rank [&9OP&7].
	trigger:
		if arg 1 is not set:
			broadcast "&9MCR> &7Mineplex Core &e{@MCRVER} &7will be recompiling in two seconds."
			wait 2 second
			player command "/sk reload Mineplex"
		else:
			if arg 1 is "-s":
				broadcast "&9MCR> &7Mineplex Core will be recompiling in two seconds. (Silent)"
				execute console command "/sk reload Mineplex"

command /rules:
	trigger:
		send "&9Rules> &7The rules can be found here: &a%{mineplex.config.ruleswebsite}%"

#CarlBae

on join:
	set {_player} to "%player%"
	replace all "s" in {_player} with "sssss"
	message "&2&lCarl the Creeper> &aHello, %{_player}%, Come and ssssseee me, I have sssome amazing rewardsss for you!"

command /carlgui:
	trigger:
		open chest with 5 rows named "%player%'s Bonuses" to player
		wait 2 ticks
		format slot 11 of player with redstone block named "&cRank Monthly Bonus" with lore "||&7Players with a Rank get a Monthly Bonus!||&bUltra recieves absolutely nothing||&dHero recieves absolutely nothing||&aLegend recieves absolutely nothing||&cTitan recieves absolutely nothing||&fPurchase a Rank at;||&f%{mineplex.config.shoplink}%" to close then run [do [execute player command "/carlgui"]->[message "claim" to console]]
		format slot 13 of player with chest named "&cDaily Reward" with lore "||&fNext reward is soon||&7||&eRewards||  &f100 Treasure Shards||  &f100 Gems||&f250 Experience||&7||&eCurrent Streak: 0||&eStreak Bonus: 5||&7||&eHighest Streak: &f1||&eStreak Reset: &f1.3 Days" to close then run [do [execute player command "/dailyr"]->[message "claim" to console]]
		format slot 15 of player with redstone block named "&cVote on Poll" with lore "||&fYou voted on all of the polls!" to close then run [do [execute player command "/carlgui"]->[message "claim" to console]]
		format slot 19 of player with water bucket named "&e&lVisit us on Facebook" with lore "||&fWe don't have a facebook!" to close then run [do [execute player command "/carlgui"]->[message "claim" to console]]
		format slot 21 of player with redstone block named "&c&lPower Play Club" with lore "&eFebruary's Cosmetic||  &fTrue Love Pet||&b &f||&eOther Rewards||  &f2 Game Amplifier||  &f1 Omega Chest||&b||&cGet Power Play Club months at||&b%{mineplex.config.shoplink}%" to close then run [do [execute player command "/carlgui"]->[message "claim" to console]]
		format slot 23 of player with creeper head named "&c&lCarl's Spinner" with lore "||&fYou need a Carl Spin Ticket to Spin||&b||&eYour Tickets: coded in the next version" to close then run [do [execute player command "/carlgui"]->[message "claim" to console]]
		format slot 25 of player with redstone block named "&c&lThank Rewards" with lore "||&7Earn Thank Rewards from players using /thank||&7on you, or by enabling Game Amplifiers.||&b||&fGet Amplifiers at &a%{mineplex.config.shoplink}%" to close then run [do [execute player command "/carlgui"]->[message "claim" to console]]
		format slot 29 of player with apple named "&a&lVisit us on YouTube" with lore "&eClaim your Daily 250 Shard Reward||&fby checking out the latest Video ||&fon the %{mineplex.config.servername}% Channel!||&b||&fBe sure and Subscribe so you ||&fdon't miss a video!||&b||&aClick to visit us on YouTube!" to close then run [do [execute player command "/ytlink"]->[message "claim" to console]]
		format slot 33 of player with apple named "&a&lVisit us on Twitter" with lore "&fCheck out and follow Mineplex on||&fTwitter for Giveaways, Announcements,||&fTeasers, and Tips!||&b||&aClick to visit us on Twitter" to close then run [do [execute player command "/tlink"]->[message "claim" to console]]

every second:
	loop all entities:
		name of loop-entity contains "&a&lCarl the Creeper"
		teleport loop-entity to {kitnpc}

on damage:
	name of victim contains "&a&lCarl the Creeper"
	cancel event

on right click on entity:
	name of clicked entity contains "&a&lCarl the Creeper"
	if {nospam.%player%} is true:
		send "&6Please dont spam the npc" to player
	else:
		set {nospam.%player%} to true
		make player execute command "/carlgui"
		wait 1 second
		set {nospam.%player%} to false

on death:
	set {nospam.%victim%} to false

on join:
	set {nospam.%player%} to false

command /dailyr:
	trigger:
		set {_t} to difference between {carl.dr.%player%} and now
		set {_tc} to "1 day" parsed as a timespan
		if {_t} is less than {_tc}:
			message "&9Carl> &7Come back in another 24 hours."
			stop
		else:
			message "&9Carl> &7Rewarded &a100 Treasure Shards&7."
			message "&9Carl> &7Rewarded &a100 Gems&7."
			message "&9Carl> &7Rewarded &a250 Experience&7."
			set {carl.dr.%player%} to now
			add 100 to {mineplex.shards.%player%}
			add 100 to {mineplex.gems.%player%}

command /ytlink:
	trigger:
		message "&6&m====================================="
		message "&b &f"
		message "          &f&lClick to Open in Web Browser"
		message "          &a%{mineplex.config.youtube}%"
		message "&b &f"
		message "&6&m====================================="

command /tlink:
	trigger:
		message "&6&m====================================="
		message "&b &f"
		message "          &f&lClick to Open in Web Browser"
		message "          &a%{mineplex.config.twitter}%"
		message "&b &f"
		message "&6&m====================================="

#Broadcast System

every 10 seconds:
	set {_check} to line 1 from url "https://pastebin.com/raw/8YXXWuiA"
	if {mineplex.globalannounce.%{_check}%} is not set:
		set {mineplex.globalannounce.%{_check}%} to true
		set {_message} to line 1 from url "https://pastebin.com/raw/fGAUXi37"
		send all players title "&eMCR Announcement" with subtitle "&f%{_message}%" for 10 seconds
		broadcast "&9MCR Announcement> &b%{_message}%"

#Treasure System

on quit:
	if {mineplex.inchest.%player%} is set:
		execute console command "/resetpoints %{mineplex.inchest.%player%}%"
		delete {mineplex.inchest.%player%}

function rewardTreasure(p: player , c: number , l: number, s: number) :: number:
	set {_mineplex.chestpoint.%{_l}%.sub.%{_s}%} to {mineplex.chestpoint.%{_l}%.sub.%{_s}%}
	add 0 to y-coordinate of {_mineplex.chestpoint.%{_l}%.sub.%{_s}%} 
	if {_c} is 1:
		set {_r} to a random integer between 1 and 4
		if {_r} is 1:
			set {_ra} to a random integer between 100 and 1000
			delete {mineplex.inchest.%{_p}%}
			send "&9Treasure> &e%{_p}% &7found Common %{_ra}% Shards." to {_p}
			add {_ra} to {mineplex.shards.%{_p}%}
			wait 1 second
			execute console command "/resetpoints %{_l}%"
			delete {mineplex.inchest.%{_p}%}
		if {_r} is 2:
			set {_ra} to a random integer between 1001 and 3456
			delete {mineplex.inchest.%{_p}%}
			send "&9Treasure> &e%{_p}% &7found &bUltra %{_ra}% Shards&7." to {_p}
			add {_ra} to {mineplex.shards.%{_p}%}
			wait 1 second
			execute console command "/resetpoints %{_l}%"
			delete {mineplex.inchest.%{_p}%}
		if {_r} is 3:
			set {_ra} to a random integer between 3457 and 5230
			delete {mineplex.inchest.%{_p}%}
			broadcast "&9Treasure> &e%{_p}% &7found &dRare %{_ra}% Shards&7."
			add {_ra} to {mineplex.shards.%{_p}%}
			delete {mineplex.inchest.%{_p}%}
			wait 1 second
			execute console command "/resetpoints %{_l}%"
			delete {mineplex.inchest.%{_p}%}
		if {_r} is 4:
			set {_ra} to a random integer between 5231 and 5456
			delete {mineplex.inchest.%{_p}%}
			broadcast "&9Treasure> &e%{_p}% &7found &aLegendary %{_ra}% Shards&7."
			play raw sound "mob.enderdragon.end" at {_p} with pitch 2 volume 100
			add {_ra} to {mineplex.shards.%{_p}%}
			delete {mineplex.inchest.%{_p}%}
			wait 1 second
			execute console command "/resetpoints %{_l}%"
	if {_c} is 2:
		set {_r} to a random integer between 1 and 4
		if {_r} is 1:
			delete {mineplex.inchest.%{_p}%}
			set {_ra} to a random integer between 3457 and 5230
			send "&9Treasure> &e%{_p}% &7found Common %{_ra}% Shards." to {_p}
			add {_ra} to {mineplex.shards.%{_p}%}
			wait 1 second
			execute console command "/resetpoints %{_l}%"
			delete {mineplex.inchest.%{_p}%}
		if {_r} is 2:
			set {_ra} to a random integer between 5231 and 5456
			delete {mineplex.inchest.%{_p}%}
			send "&9Treasure> &e%{_p}% &7found &bUltra %{_ra}% Shards&7." to {_p}
			add {_ra} to {mineplex.shards.%{_p}%}
			wait 1 second
			execute console command "/resetpoints %{_l}%"
			delete {mineplex.inchest.%{_p}%}
		if {_r} is 3:
			set {_ra} to a random integer between 5457 and 9456
			delete {mineplex.inchest.%{_p}%}
			broadcast "&9Treasure> &e%{_p}% &7found &dRare %{_ra}% Shards&7."
			add {_ra} to {mineplex.shards.%{_p}%}
			wait 1 second
			execute console command "/resetpoints %{_l}%"
			delete {mineplex.inchest.%{_p}%}
		if {_r} is 4:
			set {_ra} to a random integer between 9457 and 11231
			delete {mineplex.inchest.%{_p}%}
			broadcast "&9Treasure> &e%{_p}% &7found &aLegendary %{_ra}% Shards&7."
			play raw sound "mob.enderdragon.end" at {_p} with pitch 2 volume 100
			add {_ra} to {mineplex.shards.%{_p}%}
			wait 1 second
			execute console command "/resetpoints %{_l}%"
			delete {mineplex.inchest.%{_p}%}
	if {_c} is 3:
		set {_r} to a random integer between 1 and 4
		if {_r} is 1:
			delete {mineplex.inchest.%{_p}%}
			set {_ra} to a random integer between 11231 and 15755
			broadcast "&9Treasure> &e%{_p}% &7found &bUltra %{_ra}% Shards."
			add {_ra} to {mineplex.shards.%{_p}%}
			wait 1 second
			execute console command "/resetpoints %{_l}%"
			delete {mineplex.inchest.%{_p}%}
		if {_r} is 2:
			set {_ra} to a random integer between 15755 and 19174
			delete {mineplex.inchest.%{_p}%}
			broadcast "&9Treasure> &e%{_p}% &7found &dRare %{_ra}% Shards&7."
			add {_ra} to {mineplex.shards.%{_p}%}
			wait 1 second
			execute console command "/resetpoints %{_l}%"
			delete {mineplex.inchest.%{_p}%}
		if {_r} is 3:
			if {mineplex.rank.%{_p}%} is "":
				set {_ra} to "Ultra"
			else if {mineplex.rank.%{_p}%} is "&b&lULTRA ":
				set {_ra} to "Hero"
			else if {mineplex.rank.%{_p}%} is "&d&lHERO ":
				set {_ra} to "Legend"
			else if {mineplex.rank.%{_p}%} is "&a&lLEGEND ":
				set {_ra} to "Titan"
			else if {mineplex.rank.%{_p}%} is "&c&lTITAN ":
				set {_ra} to "Eternal"
			else if {mineplex.rank.%{_p}%} is "&3&lETERNAL ":
				set {_ra} to "Eternal"
			else:
				execute console command "/resetpoints %{_l}%"
				delete {mineplex.inchest.%{_p}%}
				set {_ra} to a random integer between 19174 and 20448
				send "&9Treasure> &7You would have gotton a rank upgrade but like your staff :P" to {_p}
				broadcast "&9Treasure> &e%{_p}% &7found &aLegendary %{_ra}% Shards&7."
				play raw sound "mob.enderdragon.end" at {_p} with pitch 2 volume 100
				add {_ra} to {mineplex.shards.%{_p}%}
				stop
			execute console command "/updaterank %{_p}% %{_ra}%"
			delete {mineplex.inchest.%{_p}%}
			broadcast "&9Treasure> &e%{_p}% &7found &cMythical %{_ra}% Rank&7."
			play raw sound "mob.wither.death" at {_p} with pitch 2 volume 100
			wait 1 second
			execute console command "/resetpoints %{_l}%"
			delete {mineplex.inchest.%{_p}%}
		if {_r} is 4:
			set {_ra} to a random integer between 19174 and 20448
			delete {mineplex.inchest.%{_p}%}
			broadcast "&9Treasure> &e%{_p}% &7found &aLegendary %{_ra}% Shards&7."
			play raw sound "mob.enderdragon.end" at {_p} with pitch 2 volume 100
			add {_ra} to {mineplex.shards.%{_p}%}
			wait 1 second
			execute console command "/resetpoints %{_l}%"
			delete {mineplex.inchest.%{_p}%}

function openTreasure(p: player , c: number , l: number) :: number:
	if  {_c} is 1:
		if {mineplex.shards.%{_p}%} < 1000:
			wait 0.3 seconds
			open chest with 6 rows named "            Confirmation" to {_p}
			wait 1 tick
			set {_slot} to 0
			loop 54 times:
				set slot {_slot} of {_p}'s current inventory to redstone block named "&c&nERROR" with lore "&cYour account has insufficient funds."
				add 1 to {_slot}
			wait 2 seconds
			if inventory name of {_p}'s current inventory is "            Confirmation":
				close {_p}'s inventory
			stop
		remove 1000 from {mineplex.shards.%{_p}%}
		set {mineplex.chestbusy.%{_l}%} to {_p}
		send {_p} title "&eOld Treasure" with subtitle "&fChoose 4 Chests To Open" for 8 seconds
		broadcast "&9Treasure> &e%{_p}% &7is opening a &aOld Treasure"
		set {mineplex.inchest.%{_p}%} to {_c}
		set block at {mineplex.chestpoint.%{_l}%} to air
		teleport {_p} to {mineplex.chestpoint.%{_l}%}
		send "&9Treasure> &7Choose 4 Chests to Open" to {_p}
		set block at {mineplex.chestpoint.%{_l}%.sub.1} to chest
		wait 1 second
		set block at {mineplex.chestpoint.%{_l}%.sub.2} to chest
		wait 1 second
		set block at {mineplex.chestpoint.%{_l}%.sub.3} to chest
		wait 1 second
		set block at {mineplex.chestpoint.%{_l}%.sub.4} to chest
		wait 1 second
		set block at {mineplex.chestpoint.%{_l}%.sub.5} to chest
		wait 1 second
		set block at {mineplex.chestpoint.%{_l}%.sub.6} to chest
		wait 1 second
		set block at {mineplex.chestpoint.%{_l}%.sub.7} to chest
		wait 1 second
		set block at {mineplex.chestpoint.%{_l}%.sub.8} to chest
	if  {_c} is 2:
		if {mineplex.shards.%{_p}%} < 5000:
			wait 0.3 seconds
			open chest with 6 rows named "            Confirmation" to {_p}
			wait 1 tick
			set {_slot} to 0
			loop 54 times:
				set slot {_slot} of {_p}'s current inventory to redstone block named "&c&nERROR" with lore "&cYour account has insufficient funds."
				add 1 to {_slot}
			wait 2 seconds
			if inventory name of {_p}'s current inventory is "            Confirmation":
				close {_p}'s inventory
			stop
		remove 5000 from {mineplex.shards.%{_p}%}
		set {mineplex.chestbusy.%{_l}%} to {_p}
		send {_p} title "&6Ancient Treasure" with subtitle "&fChoose 4 Chests To Open" for 8 seconds
		broadcast "&9Treasure> &e%{_p}% &7is opening a &6Ancient Treasure"
		set {mineplex.inchest.%{_p}%} to {_c}
		set block at {mineplex.chestpoint.%{_l}%} to air
		teleport {_p} to {mineplex.chestpoint.%{_l}%}
		send "&9Treasure> &7Choose 4 Chests to Open" to {_p}
		set block at {mineplex.chestpoint.%{_l}%.sub.1} to chest
		wait 1 second
		set block at {mineplex.chestpoint.%{_l}%.sub.2} to chest
		wait 1 second
		set block at {mineplex.chestpoint.%{_l}%.sub.3} to chest
		wait 1 second
		set block at {mineplex.chestpoint.%{_l}%.sub.4} to chest
		wait 1 second
		set block at {mineplex.chestpoint.%{_l}%.sub.5} to chest
		wait 1 second
		set block at {mineplex.chestpoint.%{_l}%.sub.6} to chest
		wait 1 second
		set block at {mineplex.chestpoint.%{_l}%.sub.7} to chest
		wait 1 second
		set block at {mineplex.chestpoint.%{_l}%.sub.8} to chest
	if  {_c} is 3:
		if {mineplex.shards.%{_p}%} < 10000:
			wait 0.3 seconds
			open chest with 6 rows named "            Confirmation" to {_p}
			wait 1 tick
			set {_slot} to 0
			loop 54 times:
				set slot {_slot} of {_p}'s current inventory to redstone block named "&c&nERROR" with lore "&cYour account has insufficient funds."
				add 1 to {_slot}
			wait 2 seconds
			if inventory name of {_p}'s current inventory is "            Confirmation":
				close {_p}'s inventory
			stop
		remove 10000 from {mineplex.shards.%{_p}%}
		set {mineplex.chestbusy.%{_l}%} to {_p}
		send {_p} title "&cMythical Treasure" with subtitle "&fChoose 4 Chests To Open" for 8 seconds
		broadcast "&9Treasure> &e%{_p}% &7is opening a &cMythical Treasure"
		set {mineplex.inchest.%{_p}%} to {_c}
		set block at {mineplex.chestpoint.%{_l}%} to air
		teleport {_p} to {mineplex.chestpoint.%{_l}%}
		send "&9Treasure> &7Choose 4 Chests to Open" to {_p}
		set block at {mineplex.chestpoint.%{_l}%.sub.1} to ender chest
		wait 1 second
		set block at {mineplex.chestpoint.%{_l}%.sub.2} to ender chest
		wait 1 second
		set block at {mineplex.chestpoint.%{_l}%.sub.3} to ender chest
		wait 1 second
		set block at {mineplex.chestpoint.%{_l}%.sub.4} to ender chest
		wait 1 second
		set block at {mineplex.chestpoint.%{_l}%.sub.5} to ender chest
		wait 1 second
		set block at {mineplex.chestpoint.%{_l}%.sub.6} to ender chest
		wait 1 second
		set block at {mineplex.chestpoint.%{_l}%.sub.7} to ender chest
		wait 1 second
		set block at {mineplex.chestpoint.%{_l}%.sub.8} to ender chest

on inventory click:
	if inventory name of player's current inventory is "            Confirmation":
		cancel event
		close player's inventory

on right click on chest:
	if event-block is {mineplex.chestpoint.1}:
		cancel event
		open chest with 1 row named "Open Treasure" to player
		wait 2 ticks
		format slot 2 of player with chest named "&a&lOld Chest" with lore " ||&fOld Chests Owned: &e0 ||&7We've scoured the lands of Minecraft||&7and found these abandoned chests.||&7The contents are unknown, but||&7according to the inscriptions on the||&7straps they appear to contain||&7many kinds of loot.|| ||&fClick to Purchase for &b1000 Treasure Shards|| ||&for Purchase at: &e%{mineplex.config.website}%" to close then run [openTreasure(player, 1, 1)]
		format slot 4 of player with trapped chest named "&6&lAncient Chest" with lore " ||&fAncient Chests Owned: &e0 ||&7Some of our bravest adventurers||&7have discovered these chests within||&7temples hidden in Minecrafts worlds.|| ||&fClick to Purchase for &b5000 Treasure Shards|| ||&for Purchase at: &e%{mineplex.config.website}%" to close then run [openTreasure(player, 2, 1)]
		format slot 6 of player with ender chest named "&c&lMythical Chest" with lore " ||&fMythical Chests Owned: &e0 ||&7All our previous adventurers have||&7perished in search of these chests.||&7However, legends of thier existence||&7convinced Sterling, Chiss, and Defek7||&7to venture out and discover the||&7location of these chests on thier own.|| ||&fClick to Purchase for &b10000 Treasure Shards|| ||&for Purchase at: &e%{mineplex.config.website}%" to close then run [openTreasure(player, 3, 1)]
	else if event-block is {mineplex.chestpoint.2}:
		cancel event
		open chest with 1 row named "Open Treasure" to player
		wait 2 ticks
		format slot 2 of player with chest named "&a&lOld Chest" with lore " ||&fOld Chests Owned: &e0 ||&7We've scoured the lands of Minecraft||&7and found these abandoned chests.||&7The contents are unknown, but||&7according to the inscriptions on the||&7straps they appear to contain||&7many kinds of loot.|| ||&fClick to Purchase for &b1000 Treasure Shards|| ||&for Purchase at: &e%{mineplex.config.website}%" to close then run [openTreasure(player, 1, 2)]
		format slot 4 of player with trapped chest named "&6&lAncient Chest" with lore " ||&fAncient Chests Owned: &e0 ||&7Some of our bravest adventurers||&7have discovered these chests within||&7temples hidden in Minecrafts worlds.|| ||&fClick to Purchase for &b5000 Treasure Shards|| ||&for Purchase at: &e%{mineplex.config.website}%" to close then run [openTreasure(player, 2, 2)]
		format slot 6 of player with ender chest named "&c&lMythical Chest" with lore " ||&fMythical Chests Owned: &e0 ||&7All our previous adventurers have||&7perished in search of these chests.||&7However, legends of thier existence||&7convinced Sterling, Chiss, and Defek7||&7to venture out and discover the||&7location of these chests on thier own.|| ||&fClick to Purchase for &b10000 Treasure Shards|| ||&for Purchase at: &e%{mineplex.config.website}%" to close then run [openTreasure(player, 3, 2)]
	else if event-block is {mineplex.chestpoint.3}:
		cancel event
		open chest with 1 row named "Open Treasure" to player
		wait 2 ticks
		format slot 2 of player with chest named "&a&lOld Chest" with lore " ||&fOld Chests Owned: &e0 ||&7We've scoured the lands of Minecraft||&7and found these abandoned chests.||&7The contents are unknown, but||&7according to the inscriptions on the||&7straps they appear to contain||&7many kinds of loot.|| ||&fClick to Purchase for &b1000 Treasure Shards|| ||&for Purchase at: &e%{mineplex.config.website}%" to close then run [openTreasure(player, 1, 3)]
		format slot 4 of player with trapped chest named "&6&lAncient Chest" with lore " ||&fAncient Chests Owned: &e0 ||&7Some of our bravest adventurers||&7have discovered these chests within||&7temples hidden in Minecrafts worlds.|| ||&fClick to Purchase for &b5000 Treasure Shards|| ||&for Purchase at: &e%{mineplex.config.website}%" to close then run [openTreasure(player, 2, 3)]
		format slot 6 of player with ender chest named "&c&lMythical Chest" with lore " ||&fMythical Chests Owned: &e0 ||&7All our previous adventurers have||&7perished in search of these chests.||&7However, legends of thier existence||&7convinced Sterling, Chiss, and Defek7||&7to venture out and discover the||&7location of these chests on thier own.|| ||&fClick to Purchase for &b10000 Treasure Shards|| ||&for Purchase at: &e%{mineplex.config.website}%" to close then run [openTreasure(player, 3, 3)]
	else if event-block is {mineplex.chestpoint.4}:
		cancel event
		open chest with 1 row named "Open Treasure" to player
		wait 2 ticks
		format slot 2 of player with chest named "&a&lOld Chest" with lore " ||&fOld Chests Owned: &e0 ||&7We've scoured the lands of Minecraft||&7and found these abandoned chests.||&7The contents are unknown, but||&7according to the inscriptions on the||&7straps they appear to contain||&7many kinds of loot.|| ||&fClick to Purchase for &b1000 Treasure Shards|| ||&for Purchase at: &e%{mineplex.config.website}%" to close then run [openTreasure(player, 1, 4)]
		format slot 4 of player with trapped chest named "&6&lAncient Chest" with lore " ||&fAncient Chests Owned: &e0 ||&7Some of our bravest adventurers||&7have discovered these chests within||&7temples hidden in Minecrafts worlds.|| ||&fClick to Purchase for &b5000 Treasure Shards|| ||&for Purchase at: &e%{mineplex.config.website}%" to close then run [openTreasure(player, 2, 4)]
		format slot 6 of player with ender chest named "&c&lMythical Chest" with lore " ||&fMythical Chests Owned: &e0 ||&7All our previous adventurers have||&7perished in search of these chests.||&7However, legends of thier existence||&7convinced Sterling, Chiss, and Defek7||&7to venture out and discover the||&7location of these chests on thier own.|| ||&fClick to Purchase for &b10000 Treasure Shards|| ||&for Purchase at: &e%{mineplex.config.website}%" to close then run [openTreasure(player, 3, 4)]

command /resetpoints <number>:
	trigger:
		set {_l} to arg 1
		delete {mineplex.chestbusy.%{_l}%}
		set block at {mineplex.chestpoint.%{_l}%.sub.1} to air
		wait 1 second
		set block at {mineplex.chestpoint.%{_l}%.sub.2} to air
		wait 1 second
		set block at {mineplex.chestpoint.%{_l}%.sub.3} to air
		wait 1 second
		set block at {mineplex.chestpoint.%{_l}%.sub.4} to air
		wait 1 second
		set block at {mineplex.chestpoint.%{_l}%.sub.5} to air
		wait 1 second
		set block at {mineplex.chestpoint.%{_l}%.sub.6} to air
		wait 1 second
		set block at {mineplex.chestpoint.%{_l}%.sub.7} to air
		wait 1 second
		set block at {mineplex.chestpoint.%{_l}%.sub.8} to air
		set block at {mineplex.chestpoint.%{_l}%} to chest

on right click on chest or ender chest:
	if event-block is {mineplex.chestpoint.1.sub.1}:
		if {mineplex.inchest.%player%} is set:
			cancel event
			make the event-block appear open 
			rewardTreasure(player, {mineplex.inchest.%player%}, 1, 1)
		else:
			cancel event
	else if event-block is {mineplex.chestpoint.1.sub.2}:
		if {mineplex.inchest.%player%} is set:
			cancel event
			make the event-block appear open 
			rewardTreasure(player, {mineplex.inchest.%player%}, 1, 2)
		else:
			cancel event
	else if event-block is {mineplex.chestpoint.1.sub.3}:
		if {mineplex.inchest.%player%} is set:
			cancel event
			make the event-block appear open 
			rewardTreasure(player, {mineplex.inchest.%player%}, 1, 3)
		else:
			cancel event
	else if event-block is {mineplex.chestpoint.1.sub.4}:
		if {mineplex.inchest.%player%} is set:
			cancel event
			make the event-block appear open 
			rewardTreasure(player, {mineplex.inchest.%player%}, 1, 4)
		else:
			cancel event
	else if event-block is {mineplex.chestpoint.1.sub.5}:
		if {mineplex.inchest.%player%} is set:
			cancel event
			make the event-block appear open 
			rewardTreasure(player, {mineplex.inchest.%player%}, 1, 5)
		else:
			cancel event
	else if event-block is {mineplex.chestpoint.1.sub.6}:
		if {mineplex.inchest.%player%} is set:
			cancel event
			make the event-block appear open 
			rewardTreasure(player, {mineplex.inchest.%player%}, 1, 6)
		else:
			cancel event
	else if event-block is {mineplex.chestpoint.1.sub.7}:
		if {mineplex.inchest.%player%} is set:
			cancel event
			make the event-block appear open 
			rewardTreasure(player, {mineplex.inchest.%player%}, 1, 7)
		else:
			cancel event
	else if event-block is {mineplex.chestpoint.1.sub.8}:
		if {mineplex.inchest.%player%} is set:
			cancel event
			make the event-block appear open 
			rewardTreasure(player, {mineplex.inchest.%player%}, 1, 8)
		else:
			cancel event
	else if event-block is {mineplex.chestpoint.2.sub.1}:
		if {mineplex.inchest.%player%} is set:
			cancel event
			make the event-block appear open 
			rewardTreasure(player, {mineplex.inchest.%player%}, 2, 1)
		else:
			cancel event
	else if event-block is {mineplex.chestpoint.2.sub.2}:
		if {mineplex.inchest.%player%} is set:
			cancel event
			make the event-block appear open 
			rewardTreasure(player, {mineplex.inchest.%player%}, 2, 2)
		else:
			cancel event
	else if event-block is {mineplex.chestpoint.2.sub.3}:
		if {mineplex.inchest.%player%} is set:
			cancel event
			make the event-block appear open 
			rewardTreasure(player, {mineplex.inchest.%player%}, 2, 3)
		else:
			cancel event
	else if event-block is {mineplex.chestpoint.2.sub.4}:
		if {mineplex.inchest.%player%} is set:
			cancel event
			make the event-block appear open 
			rewardTreasure(player, {mineplex.inchest.%player%}, 2, 4)
		else:
			cancel event
	else if event-block is {mineplex.chestpoint.2.sub.5}:
		if {mineplex.inchest.%player%} is set:
			cancel event
			make the event-block appear open 
			rewardTreasure(player, {mineplex.inchest.%player%}, 2, 5)
		else:
			cancel event
	else if event-block is {mineplex.chestpoint.2.sub.6}:
		if {mineplex.inchest.%player%} is set:
			cancel event
			make the event-block appear open 
			rewardTreasure(player, {mineplex.inchest.%player%}, 2, 6)
		else:
			cancel event
	else if event-block is {mineplex.chestpoint.2.sub.7}:
		if {mineplex.inchest.%player%} is set:
			cancel event
			make the event-block appear open 
			rewardTreasure(player, {mineplex.inchest.%player%}, 2, 7)
		else:
			cancel event
	else if event-block is {mineplex.chestpoint.2.sub.8}:
		if {mineplex.inchest.%player%} is set:
			cancel event
			make the event-block appear open 
			rewardTreasure(player, {mineplex.inchest.%player%}, 2, 8)
		else:
			cancel event
	else if event-block is {mineplex.chestpoint.3.sub.1}:
		if {mineplex.inchest.%player%} is set:
			cancel event
			make the event-block appear open 
			rewardTreasure(player, {mineplex.inchest.%player%}, 3, 1)
		else:
			cancel event
	else if event-block is {mineplex.chestpoint.3.sub.2}:
		if {mineplex.inchest.%player%} is set:
			cancel event
			make the event-block appear open 
			rewardTreasure(player, {mineplex.inchest.%player%}, 3, 2)
		else:
			cancel event
	else if event-block is {mineplex.chestpoint.3.sub.3}:
		if {mineplex.inchest.%player%} is set:
			cancel event
			make the event-block appear open
			rewardTreasure(player, {mineplex.inchest.%player%}, 3, 3)
		else:
			cancel event
	else if event-block is {mineplex.chestpoint.3.sub.4}:
		if {mineplex.inchest.%player%} is set:
			cancel event
			make the event-block appear open
			rewardTreasure(player, {mineplex.inchest.%player%}, 3, 4)
		else:
			cancel event
	else if event-block is {mineplex.chestpoint.3.sub.5}:
		if {mineplex.inchest.%player%} is set:
			cancel event
			make the event-block appear open 
			rewardTreasure(player, {mineplex.inchest.%player%}, 3, 5)
		else:
			cancel event
	else if event-block is {mineplex.chestpoint.3.sub.6}:
		if {mineplex.inchest.%player%} is set:
			cancel event
			make the event-block appear open 
			rewardTreasure(player, {mineplex.inchest.%player%}, 3, 6)
		else:
			cancel event
	else if event-block is {mineplex.chestpoint.3.sub.7}:
		if {mineplex.inchest.%player%} is set:
			cancel event
			make the event-block appear open 
			rewardTreasure(player, {mineplex.inchest.%player%}, 3, 7)
		else:
			cancel event
	else if event-block is {mineplex.chestpoint.3.sub.8}:
		if {mineplex.inchest.%player%} is set:
			cancel event
			make the event-block appear open 
			rewardTreasure(player, {mineplex.inchest.%player%}, 3, 8)
		else:
			cancel event
	else if event-block is {mineplex.chestpoint.4.sub.1}:
		if {mineplex.inchest.%player%} is set:
			cancel event
			make the event-block appear open 
			rewardTreasure(player, {mineplex.inchest.%player%}, 4, 1)
		else:
			cancel event
	else if event-block is {mineplex.chestpoint.4.sub.2}:
		if {mineplex.inchest.%player%} is set:
			cancel event
			make the event-block appear open 
			rewardTreasure(player, {mineplex.inchest.%player%}, 4, 2)
		else:
			cancel event
	else if event-block is {mineplex.chestpoint.4.sub.3}:
		if {mineplex.inchest.%player%} is set:
			cancel event
			make the event-block appear open 
			rewardTreasure(player, {mineplex.inchest.%player%}, 4, 3)
		else:
			cancel event
	else if event-block is {mineplex.chestpoint.4.sub.4}:
		if {mineplex.inchest.%player%} is set:
			cancel event
			make the event-block appear open 
			rewardTreasure(player, {mineplex.inchest.%player%}, 4, 4)
		else:
			cancel event
	else if event-block is {mineplex.chestpoint.4.sub.5}:
		if {mineplex.inchest.%player%} is set:
			cancel event
			make the event-block appear open 
			rewardTreasure(player, {mineplex.inchest.%player%}, 4, 5)
		else:
			cancel event
	else if event-block is {mineplex.chestpoint.4.sub.6}:
		if {mineplex.inchest.%player%} is set:
			cancel event
			make the event-block appear open 
			rewardTreasure(player, {mineplex.inchest.%player%}, 4, 6)
		else:
			cancel event
	else if event-block is {mineplex.chestpoint.4.sub.7}:
		if {mineplex.inchest.%player%} is set:
			cancel event
			make the event-block appear open 
			rewardTreasure(player, {mineplex.inchest.%player%}, 4, 7)
		else:
			cancel event
	else if event-block is {mineplex.chestpoint.4.sub.8}:
		if {mineplex.inchest.%player%} is set:
			cancel event
			make the event-block appear open 
			rewardTreasure(player, {mineplex.inchest.%player%}, 4, 8)
		else:
			cancel event
	

#Scoreboard

every 2 seconds:
	if {mineplex.usescoreboard} is false:
		stop
	else:
		loop all players:
			wipe loop-player's sidebar
			set name of sidebar of loop-player to "&6&l%{mineplex.config.servername}%"
			set score "&b&lServer" in sidebar of loop-player to 15
			set score "&f%{mineplex.config.world}%" in sidebar of loop-player to 14
			set score "&1 " in sidebar of loop-player to 13
			set score "&a&lGems" in sidebar of loop-player to 12
			set score "&r%{mineplex.gems.%loop-player%}%" in sidebar of loop-player to 11
			set score "&2 " in sidebar of loop-player to 10
			set score "&e&lShards" in sidebar of loop-player to 9
			set score "&f%{mineplex.shards.%loop-player%}%" in sidebar of loop-player to 8
			set score "&3 " in sidebar of loop-player to 7
			set score "&6&lRank" in sidebar of loop-player to 6
			set score "&f%{mineplex.api.displayrank.%loop-player%}%" in sidebar of loop-player to 5
			set score "&4 " in sidebar of loop-player to 4
			set score "&c&lWebsite" in sidebar of loop-player to 3
			set score "&f%{mineplex.config.website}%" in sidebar of loop-player to 2
			set score "&f----------------" in sidebar of loop-player to 1

#Rank Loader

function rankLoad(p: player) :: string:
	if {mineplex.testrank.%{_p}%} is set:
		set {mineplex.rank.%{_p}%} to {mineplex.testrank.%{_p}%}
		delete {mineplex.testrank.%{_p}%}
	if {mineplex.rank.%{_p}%} is "&b&lULTRA ":
		execute console command "/updaterank %{_p}% ultra"
		set {_p} tab name to "&b&lULTRA &e%{_p}%"
		set {mineplex.displaya.%{_p}%} to "&bUltra"
		set {mineplex.colora.%{_p}%} to "§b"
		return "&bUltra"
	if {mineplex.rank,%{_p}%} is "&d&lHERO ":
		execute console command "/updaterank %{_p}% hero"
		set {_p} tab name to "&d&lHERO &e%{_p}%"
		set {mineplex.displaya.%{_p}%} to "&dHero"
		set {mineplex.colora.%{_p}%} to "§d"
		return "&dHero"
	if {mineplex.rank.%{_p}%} is "&a&lLEGEND ":
		execute console command "/updaterank %{_p}% legend"
		set {_p} tab name to "&a&lLEGEND &e%{_p}%"
		set {mineplex.displaya.%{_p}%} to "&aLegend"
		set {mineplex.colora.%{_p}%} to "§a"
		return "&aLegend"
	if {mineplex.rank.%{_p}%} is "&c&lTITAN ":
		execute console command "/updaterank %{_p}% titan"
		set {_p} tab name to "&c&lTITAN &e%{_p}%"
		set {mineplex.displaya.%{_p}%} to "&cTitan"
		set {mineplex.colora.%{_p}%} to "§c"
		return "&cTitan"
	if {mineplex.rank.%{_p}%} is "&6&lTRAINEE ":
		execute console command "/updaterank %{_p}% trainee"
		set {_p} tab name to "&6&lTRAINEE &e%{_p}%"
		set {mineplex.displaya.%{_p}%} to "&6Trainee"
		set {mineplex.colora.%{_p}%} to "§6"
		return "&6Trainee"
	if {mineplex.rank.%{_p}%} is "&6&lMOD ":
		execute console command "/updaterank %{_p}% mod"
		set {_p} tab name to "&6&lMOD &e%{_p}%"
		set {mineplex.displaya.%{_p}%} to "&6Mod"
		set {mineplex.colora.%{_p}%} to "§6"
		return "&6Mod"
	if {mineplex.rank.%{_p}%} is "&6&lSR.MOD ":
		execute console command "/updaterank %{_p}% srmod"
		set {_p} tab name to "&6&lSR.MOD &e%{_p}%"
		set {mineplex.displaya.%{_p}%} to "&6Sr.Mod"
		set {mineplex.colora.%{_p}%} to "§6"
		return "&6Sr.Mod"
	if {mineplex.rank.%{_p}%} is "&6&lC.MOD ":
		execute console command "/updaterank %{_p}% cmod"
		set {_p} tab name to "&6&lC.MOD &e%{_p}%"
		set {mineplex.displaya.%{_p}%} to "&6C.Mod"
		set {mineplex.colora.%{_p}%} to "§6"
		return "&6C.Mod"
	if {mineplex.rank.%{_p}%} is "&4&lADMIN ":
		execute console command "/updaterank %{_p}% admin"
		set {_p} tab name to "&4&lADMIN &e%{_p}%"
		set {mineplex.displaya.%{_p}%} to "&4Admin"
		set {mineplex.colora.%{_p}%} to "§4"
		return "&4Admin"
	if {mineplex.rank.%{_p}%} is "&4&lLEADER ":
		execute console command "/updaterank %{_p}% leader"
		set {_p} tab name to "&4&lLEADER &e%{_p}%"
		set {mineplex.displaya.%{_p}%} to "&4Leader"
		set {mineplex.colora.%{_p}%} to "§4"
		return "&4Leader"
	if {mineplex.rank.%{_p}%} is "&4&lOWNER ":
		execute console command "/updaterank %{_p}% owner"
		set {_p} tab name to "&4&lOWNER &e%{_p}%"
		set {mineplex.displaya.%{_p}%} to "&4Owner"
		set {mineplex.colora.%{_p}%} to "§4"
		return "&4Owner"
	if {mineplex.rank.%{_p}%} is "&9&lBUILDER ":
		execute console command "/updaterank %{_p}% builder"
		set {_p} tab name to "&9&lBUIDLER &e%{_p}%"
		set {mineplex.displaya.%{_p}%} to "&8Builder"
		set {mineplex.colora.%{_p}%} to "§9"
		return "&9Builder"
	if {mineplex.rank.%{_p}%} is "&9&lMAPLEAD ":
		execute console command "/updaterank %{_p}% maplead"
		set {_p} tab name to "&9&lMAPLEAD &e%{_p}%"
		set {mineplex.displaya.%{_p}%} to "&9Maplead"
		set {mineplex.colora.%{_p}%} to "§9"
		return "&9Maplead"
	if {mineplex.rank.%{_p}%} is "&c&lJR.DEV ":
		execute console command "/updaterank %{_p}% jrdev"
		set {mineplex.displaya.%{_p}%} to "&cJr.Dev"
		set {mineplex.colora.%{_p}%} to "§c"
		return "&cJr.Dev"
	if {mineplex.rank.%{_p}%} is "&4&lDEV ":
		execute console command "/updaterank %{_p}% dev"
		set {_p} tab name to "&4&lDEV &e%{_p}%"
		set {mineplex.displaya.%{_p}%} to "&4Dev"
		set {mineplex.colora.%{_p}%} to "§4"
		return "&4Dev"
	if {mineplex.rank.%{_p}%} is "&5&lTWITCH ":
		execute console command "/updaterank %{_p}% twitch"
		set {_p} tab name to "&5&lTWITCH &e%{_p}%"
		set {mineplex.displaya.%{_p}%} to "&5Twitch"
		set {mineplex.colora.%{_p}%} to "§5"
		return "&5Twitch"
	if {mineplex.rank.%{_p}%} is "&c&lYOUTUBE ":
		execute console command "/updaterank %{_p}% youtube"
		set {_p} tab name to "&c&lYOUTUBE &e%{_p}%"
		set {mineplex.displaya.%{_p}%} to "&cYouTube"
		set {mineplex.colora.%{_p}%} to "§c"
		return "&cYouTube"
	if {mineplex.rank.%{_p}%} is "&5&lYT ":
		execute console command "/updaterank %{_p}% yt"
		set {_p} tab name to "&5&lYT &e%{_p}%"
		set {mineplex.displaya.%{_p}%} to "&5YT"
		set {mineplex.colora.%{_p}%} to "§5"
		return "&5YT"
	if {mineplex.rank.%{_p}%} is "&3&lETERNAL ":
		execute console command "/updaterank %{_p}% eternal"
		set {_p} tab name to "&3&lETERNAL &e%{_p}%"
		set {mineplex.displaya.%{_p}%} to "&3Eternal"
		set {mineplex.colora.%{_p}%} to "§3"
		return "&3Eternal"
	if {mineplex.rank.%{_p}%} is "&9&lSUPPORT ":
		execute console command "/updaterank %{_p}% support"
		set {mineplex.displaya.%{_p}%} to "&9Support"
		set {mineplex.colora.%{_p}%} to "§9"
		return "&9Support"
	if {mineplex.rank.%{_p}%} is "&9&lMEDIA ":
		execute console command "/updaterank %{_p}% media"
		set {mineplex.displaya.%{_p}%} to "&9Media"
		set {mineplex.colora.%{_p}%} to "§9"
		return "&9Media"

on join:
	if {mineplex.rank.uuid.%uuid of player%} is set:
		set {mineplex.rank.%player%} to {mineplex.rank.uuid.%uuid of player%}
	wait 2 ticks
	rankLoad(player)
	loop all players:
		updateRankAPI(loop-player)

on flight toggle:
	if {mineplex.config.doublejump} is "true":
		player's gamemode is not creative:
			cancel event
			wait a tick
			set player's flight state to false
			push player upwards at speed 0.3
			push player forwards at speed 0.9
			play raw sound "mob.ghast.fireball" at player with pitch 2 volume 0.99
	else:
		stop

on jump:
	player's gamemode is not creative:
		{DoubleJump%player's uuid%} is not set:
			block below player is not air or water:
				set player's flight state to true

on quit:
	set {mineplex.rank.uuid.%uuid of player%} to {mineplex.rank.%player%}

#Chat System

on chat:
	if {muted::%player%} is true:
		if {muted::%player%::type} is "perm":
			send "&9Punish> &7Shh, you're muted because %{muted::%player%::reason}% by %{muted::%player%::by}% for Permanent."
			cancel event
			stop
		if {muted::%player%::type} is "temp":		
			set {_waited} to difference between {muted::%player%::when} and now
			if {_waited} is less than {muted::%player%::time}:
				send "&9Punish> &7Shh, you're muted because %{muted::%player%::reason}% by %{muted::%player%::by}% for &a%{muted::%player%::time}%."
				cancel event
				stop
	if {mineplex.vanish.%player%} is false:
		if {mineplex.chatslow} is set:
			if player has permission "mineplex.mod":
				set {_check} to mcs((player), (message))
				if {_check} is less than 0:
					cancel event
					delete {_check}
			else:
				if difference between {lastChat::%player%} and now < {mineplex.chatslow}:
					cancel event
					send "&9Chat> &7Chat slow enabled. Please wait."
				else:	
					set {lastChat::%player%} to now
					set {_check} to mcs((player), (message))
					if {_check} is less than 0:
						cancel event
						delete {_check}
		else if {mineplex.chatsilence} is set:
			if player has permission "mineplex.trainee":
				set {_check} to mcs((player), (message))
				if {_check} is less than 0:
					cancel event
					delete {_check}
			else:
				cancel event
				send "&9Chat> &7The chat is silenced."
		else:
			if {party.%player%.chat} is true:
				if length of message is greater than 1:
					if first character of message is "@":
						cancel event
						set message to "%subtext of message from characters 2 to (length of message)%"
						loop {party.%{party.%player%}%::*}:
							message "&5&lParty &f&l%player% &d%message%" to loop-value
					else:
						set {_check} to mcs((player), (message))
						if {_check} is less than 0:
							cancel event
							delete {_check}
				else:
					set {_check} to mcs((player), (message))
					if {_check} is less than 0:
						cancel event
						delete {_check}
			else:
				set {_check} to mcs((player), (message))
				if {_check} is less than 0:
					cancel event
					delete {_check}
	else if {mineplex.vanish.%player%} is true:
		send "&eYou can not chat while incognito."
		cancel event
	else:
		set {mineplex.vanish.%player%} to false
		set {_check} to mcs((player), (message))
		if {_check} is less than 0:
			cancel event
			delete {_check}

#Join, Quit, and Load Handlers

on join:
	if player has permission "mineplex.admin":
		wait 5 seconds
		#set {_var::*} to contents from url "https://raw.githubusercontent.com/WheezyGold7931/Mineplex-Core/master/version.txt" Raw in GitHub does not update fast enough rip lel
		set {_var::*} to contents from url "http://pastebin.com/raw/LG11nc8b"
		loop {_var::*}:
			set {_u} to "%loop-value%" parsed as a number
			set {_c} to "{@MCRVER}" parsed as a number
			if {_c} is greater than {_u}:
				send "&9Mineplex Core> &7You must be using some fancy indev version!" to player
				send "&9Mineplex Core> &7or you're retarded and changed the version in the config!" to player
				stop
			if loop-value is not "{@MCRVER}":
				send "&9Mineplex Core> &7Version &e%loop-value% &7is ready for download" to player
			else:
				stop
		send "&9Mineplex Core> &7Changelog:" to player
		set {_var1::*} to contents from url "http://pastebin.com/raw/YDB8kU1v"
		loop {_var1::*}:
			send "%loop-value%" to player
		
		loop {_var::*}:
			send "&9Mineplex Core> &7Version &e%loop-value% &7is ready for download" to player
			send "&9Mineplex Core> &7End of Changelog!"

on load:
	#set {_var::*} to contents from url "https://raw.githubusercontent.com/WheezyGold7931/Mineplex-Core/master/version.txt" Raw in GitHub does not update fast enough rip lel
	set {_var::*} to contents from url "http://pastebin.com/raw/LG11nc8b"
	loop {_var::*}:
		set {_u} to "%loop-value%" parsed as a number
		set {_c} to "{@MCRVER}" parsed as a number
		if {_c} is greater than {_u}:
			broadcast "&9Mineplex Core> &7You must be using some fancy indev version!"
			broadcast "&9Mineplex Core> &7or you're retarded and changed the version in the config!"
			stop
		if loop-value is not "{@MCRVER}":
			broadcast "&9Mineplex Core> &7Version &e%loop-value% &7is ready for download"
		else:
			stop
	broadcast "&9Mineplex Core> &7Changelog:"
	set {_var1::*} to contents from url "http://pastebin.com/raw/YDB8kU1v"
	loop {_var1::*}:
		broadcast "%loop-value%"
	
	loop {_var::*}:
		broadcast "&9Mineplex Core> &7Version &e%loop-value% &7is ready for download"
		broadcast "&9Mineplex Core> &7End of Changelog!"
	if {mineplex.gadget.enabled} is not set:
		set {mineplex.gadget.enabled} to true
	if {mineplex.report.id} is not set:
		set {mineplex.report.id} to 1
	if {mineplex.dj} is not set:
		set {mineplex.dj} to true
	if {mineplex.tntlauncher} is not set:
		set {mineplex.tntlauncher} to true

on join:
	if {mineplex.punish.past.tempban.%player%} is not set:
		set {mineplex.punish.past.tempban.%player%} to 0
	if {mineplex.punish.past.permban.%player%} is not set:
		set {mineplex.punish.past.permban.%player%} to 0
	if {mineplex.punish.past.tempmute.%player%} is not set:
		set {mineplex.punish.past.tempmute.%player%} to 0
	if {mineplex.punish.past.permmute.%player%} is not set:
		set {mineplex.punish.past.permmute.%player%} to 0
	if {mineplex.punish.past.warn.%player%} is not set:
		set {mineplex.punish.past.warn.%player%} to 0
	if {mineplex.punish.past.reportban.%player%} is not set:
		set {mineplex.punish.past.reportban.%player%} to 0
	set join message to "&8Join> &7%player%"
	updateRankAPI(player)
	delete {mineplex.disguise.%player%}
	execute console command "/ud %player%"
	if {mineplex.level.%player%} is not set:
		set {mineplex.level.%player%} to "&70"
	delete {mineplex.lastm.%player%}
	delete {mineplex.lasta.%player%} 
	wait 1.5 seconds
	if {mineplex.rank.%player%} is not set:
		set {mineplex.rank.%player%} to ""
		execute console command "/__mp__dp__ %player%"
	if {mineplex.vanish.%player%} is not set:
		set {mineplex.vanish.%player%} to false
	if {mineplex.overidechat} is not set:
		set {mineplex.overidechat} to true
	if {indev} is not set:
		set {indev} to true
	if {mineplex.vanish.%player%} is true:
		send ""
		send ""
		send "&6&lYou are currently incognito"
		send "&eThis means you are invisible to all except for those who are"
		send "&4&lAdmin&f+"
		send ""
		send ""
	execute player command "/__mp__st__"
	set tab header to "&f&l%{mineplex.config.servername}% Network  &a%{mineplex.config.world}%" and footer to "&fVisit &a%{mineplex.config.website}% &ffor News, Forums, and Shop" for player
	if {mineplex.pref.hpv.%player%} is false:
		hide all players from player
	if {mineplex.pref.hpv.%player%} is not set:
		set {mineplex.pref.hpv.%player%} to true
	if {mineplex.pref.ff.%player%} is not set:
		set {mineplex.pref.ff.%player%} to false
	if {mineplex.ff.%player%} is not set:
		set {mineplex.ff.%player%} to false
	if {mineplex.pref.pm.%player%} is not set:
		set {mineplex.pref.pm.%player%} to true
	if {mineplex.pref.pc.%player%} is not set:
		set {mineplex.pref.pc.%player%} to true
	if {mineplex.pref.gwen.%player%} is not set:
		set {mineplex.pref.gwen.%player%} to true
	if {mineplex.pref.report.%player%} is not set:
		set {mineplex.pref.report.%player%} to true
	if {mineplex.shards.%player%} is not set:
		set {mineplex.shards.%player%} to 0
	if {mineplex.gems.%player%} is not set:
		set {mineplex.gems.%player%} to 0
	if {mineplex.particle.active.%player%} is not set:
		set {mineplex.particle.active.%player%} to false
	if {mineplex.arrorw.active} is not set:
		set {mineplex.arrow.active} to false
	if {mineplex.adminmode.%player%} is true:
		set {mineplex.adminmode.%player%} to false
	loop all players:
		if {mineplex.vanish.%loop-player%} is true:
			add loop-player to {%player%.vanishlist::*}
	loop all players:
		if loop-player does not have permission "mineplex.admin":
			hide {%player%.vanishlist::*} from all players
	delete {%player%.vanishlist::*}

on load:
	if {mineplex.news.int} is not set:
		set {mineplex.news.line1} to "§b§lMineplex Core Remake"
		set {mineplex.news.line2} to "§a§lThe best remake for Mineplex Commands"
		set {mineplex.news.line3} to "§3§lRate this on Spigot!"
		set {mineplex.news.line4} to "§c§lCheck me out on SkUnity!"
		set {mineplex.news.allow} to true
		set {mineplex.news.int} to true
	wait 5 seconds

on quit:
	set quit message to "&8Quit> &7%player%"

every second:
	loop all players:
		add 1 to {mineplex.time.%loop-player%}

#Forcefield

every 2 ticks:
	loop all players:
		if {mineplex.ff.list::%loop-player%} is set:
			loop players in radius 4 of loop-player:
				if {mineplex.pref.ff.%loop-player-2%} is false:
					if loop-player-2 is not loop-player-1:
						play raw sound "mob.chicken.plop" at loop-player-2 with pitch 1 volume 10
						push the loop-player-2 upwards at speed 0.3
						push the loop-player-2 backwards at speed 0.45
						play raw sound "mob.chicken.plop" at loop-player-2 with pitch 1 volume 10

#2 Factor

on join:
	wait 5 ticks
	if player has permission "mineplex.2fa":
		if {mineplex.auth.%uuid of player%} is set:
			set {_t} to difference between {mineplex.authlast.%uuid of player%} and now
			set {_tc} to "1 day" parsed as a timespan
			if {_t} is less than {_tc}:
				send "&92FA> &7Authorized for 24 hours."
			else:
				set {mineplex.authlock.%player%} to true
				apply slowness 999 to player for 999 seconds
				apply blindness 999 to player for 999 seconds
				send "&92FA> &7Please enter your two-factor auth code"
				send "&92FA> &c/2fa (code)"
		else:
			stop

on command:
	if {mineplex.authlock.%player%} is true:
		if executor is player:
			if command is not "2fa":
				cancel event
				send "&92FA> &7Please enter your two-factor auth code"
				send "&92FA> &c/2fa (code)"

on chat:
	if {mineplex.authlock.%player%} is true:
		cancel event
		send "&92FA> &7Please enter your two-factor auth code"
		send "&92FA> &c/2fa (code)"

on quit:
	delete {autowarn.%player%}

#Mineplex Commands

command /2fa [<string>] [<string>]:
	permission: mineplex.2fa
	permission message: &9Permissions> &7This requires Permission Rank [&9BUILDER&7].
	trigger:
		if arg 1 is not set:
			send "&92FA> &7/2fa (code)"
		else:
			if {mineplex.auth.%uuid of player%} is not set:
				if {authwarn.%player%} is not set:
					send "&92FA> &7Hey There! This sets a code that you will have to remember for the rest of your life!"
					send "&92FA> &7Do &e/2fa (code) &7if you are 100%% sure!"
					set {authwarn.%player%} to true
					stop
				else:
					set {_t} to arg 1 parsed as an integer
					if {_t} is a number:
						send "&92FA> &7Authorized for 24 hours."
						send "&92FA> &7Saving secret..."
						wait 5 ticks
						set {mineplex.auth.%uuid of player%} to hashed arg 1
						set {mineplex.authlock.%player%} to false
						send "&92FA> &7Secret key saved."
					else:
						send "&92FA> &7Invalid authentication code (not a number)."
			else:
				set {_t} to difference between {mineplex.authlast.%uuid of player%} and now
				set {_tc} to "1 day" parsed as a timespan
				if {_t} is less than {_tc}:
					send "&92FA> &7Authorized for 24 hours."
				else:
					set {_t} to arg 1 parsed as an integer
					if {_t} is a number:
						{mineplex.auth.%uuid of player%} is hashed arg-1:
							send "&92FA> &7Authorized for 24 hours."
							send "&92FA> &7Saving secret..."
							wait 5 ticks
							set {mineplex.auth.%uuid of player%} to hashed arg 1
							remove slowness from the player
							remove blindness from the player
							set {mineplex.authlast.%uuid of player%} to now
							set {mineplex.authlock.%player%} to false
							send "&92FA> &7Secret key saved."
						else:
							send "&92FA> &7Invalid authentication code"
					else:
						send "&92FA> &7Invalid authentication code (not a number)."

command /tp [<text>] [<text>] [<text>]:
	permission: mineplex.mod
	permission message: &9Permissions> &7This requires Permission Rank [&9MOD&7].
	trigger:
		if arg-1 is not set:
			send "&9Teleport> &7Commands List:"
			send "&6/tp <target> &7Teleport to Player &6Mod"
			send "&4/tp here <player> &7Teleports Player to Self &4Admin"
			send "&4/tp <player> <target> &7Teleports Player to Player &4Admin"
			send "&4/tp all &7Teleports All to Self &4Owner"
		else:
			if arg-2 is not set:
				if arg-1 is set:
					if arg-1 is not "all":
						if arg-1 is not "here":
							if arg-1 parsed as player is online:
								teleport player to arg-1 parsed as player's location
								set {_t} to arg-1 parsed as player
								send "&9Teleport> &7Teleported to &e%{_t}%&7."
								stop
							else:
								send "&9Teleport> &7Locating &e%arg-1%&7..."
								wait 5 seconds
								send "&9Teleport> &7Could not locate &e%arg-1%&7."
								stop
					if arg-1 is "all":
						if player has permission "mineplex.owner":
							teleport all players to player
							send "&9Teleport> &7You teleported &e%amount of players% Players &7to yourself."
							broadcast "&9Teleport> &7You teleported to &e%player%&7."
							stop
						else:
							send "&9Permissions> &7This requires Permission Rank [&9OWNER&7]."
							stop
			if arg-1 is "here":
				if player has permission "mineplex.admin":
					if arg-3 is not set:
						if arg-2 is set:
							if arg-2 parsed as player is online:
								teleport arg-2 parsed as player to player's location
								send "&9Teleport> &7%player% teleported you to self." to arg-2 parsed as player
								set {_t} to arg-2 parsed as player
								send "&9Teleport> &7Teleported &e%arg-2% &7to self."
								stop
							else:
								send "&9Teleport> &7Locating &e%arg-2%&7..."
								wait 5 seconds
								send "&9Teleport> &7Could not locate &e%arg-2%&7."
								stop
				else:
					send "&9Permissions> &7This requires Permission Rank [&9ADMIN&7]."
					stop
				if arg-2 is not set:
					send "&9Teleport> &7Commands List:"
					send "&6/tp <target> &7Teleport to Player &6Mod"
					send "&4/tp here <player> &7Teleports Player to Self &4Admin"
					send "&4/tp <player> <target> &7Teleports Player to Player &4Admin"
					send "&4/tp all &7Teleports All to Self &4Owner"
			if arg-3 is not set:
				if arg-2 is set:
					if player has permission "mineplex.admin":
						if arg-2 parsed as player is online:
							if arg-1 parsed as player is online:
								teleport arg-1 parsed as player to arg-2 parsed as player
								set {_t1} to arg-1 parsed as player
								set {_t} to arg-2 parsed as player
								send "&9Teleport> &e%{_t1}% &7was teleported to you." to arg-2 parsed as player
								send "&9Teleport> &7You were teleported to &e%{_t}%&7." to arg-1 parsed as player
								stop
							else:
								send "&9Teleport> &7Locating &e%arg-1%&7..."
								wait 5 seconds
								send "&9Teleport> &7Could not locate &e%arg-1%&7."
								stop
						else:
							send "&9Teleport> &7Locating &e%arg-2%&7..."
							wait 5 seconds
							send "&9Teleport> &7Could not locate &e%arg-2%&7."
							stop
					else:
						send "&9Permissions> &7This requires Permission Rank [&9ADMIN&7]."
						stop

command /time [<offline player>] [<string>]:
	permission: mineplex.mod
	permission message: &9Permissions> &7This requires Permission Rank [&9MOD&7].
	trigger:
		if arg 1 is not set:
			send "&9Time> &7Usage: /time <playerName>"
		else:
			if {mineplex.time.%arg-1%} is not set:
				set {mineplex.time.%arg-1%} to 0
			send "&9Time> &e%arg-1% &7has spent &e%{mineplex.time.%arg-1%}%.0 Seconds &7in game"

command /disguise [<string>] [<string>]:
	permission: mineplex.youtube
	permission message: &9Permissions> &7This requires Permission Rank [&9ADMIN&7].
	trigger:
		if arg 1 is not set:
			if {mineplex.disguise.%player%} is set:
				send "&9Disguise> &7You are no longer disguised!"
				execute console command "/ud %player%"
				delete {mineplex.disguise.%player%}
				set player tab name to "%{mineplex.rank.%player%}%&e%player%"
				updateRankAPI(player)
			else:
				send "&9Disguise> &7Command List:%nl%&4/disguise <player> &7Makes you appear as target player in chat and tab &4Admin"
		else:
			if {mineplex.disguise.%player%} is set:
				send "&9Disguise> &7You are already disguised. Please undisguise by using /disguise"
			else:
				set {_n} to the length of arg 1
				if {_n} is greater than 16:
					send "&9Disguise> &7That disguise name is not permitted!"
					stop
				set {_p1} to "%arg-1%" parsed as offline player
				if {_p1} is online:
					send "&9Disguise> &7this name already in use!"
					stop
				if {_p1} has permission "mineplex.trainee" or "mineplex.youtube" or "mineplex.twitch":
					send "&9Disguise> &7You may not disguise as people who are staff members, youtubers, and streamers."
					stop
				if {banned::%{_p1}%} or {muted::%{_p1}%} is set:
					send "&9Disguise> &7You may not disguise as people who are muted or banned."
					stop
				send "&9Disguise> &7Disguise Active: &f%arg-1%"
				if {mineplex.level.%arg-1%} is not set:
					set {mineplex.level.%arg-1%} to "&70"
				if {mineplex.rank.%arg-1%} is not set:
					set {mineplex.rank.%arg-1%} to ""
				execute console command "/odisguise %player% player %arg-1%"
				set {mineplex.disguise.%player%} to "%arg-1%" parsed as offline player
				set {_player} to arg 1
				if {mineplex.rank.%{_player}%} is not set:
					set {mineplex.rank.%{_player}%} to ""
				set player tab name to "%{mineplex.rank.%{_player}%}%&e%arg-1%"
				updateRankAPI(player)

command /debugapi [<string>] [<string>] [<string>]:
	trigger:
		if arg 1 is not set:
			send "&9API> &7Mineplex Core API"
			send "&9API> &7/debugapi (api name)"
			send "&9API> &7Current API's; &adisplayrank&7, &adisplayname"
			send "&9API> &7Use /debugapi (api name) (player) to view a diffrent players's api output"
		else:
			if arg 2 is set:
				set {_p} to "%arg-2%"
			else:
				set {_p} to "%player%"
			if arg 1 is "displayrank":
				send "&9API> &7Raw API Output; &f%{mineplex.api.displayrank.%{_p}%}%"
			else if arg 1 is "displayname":
				send "&9API> &7Raw API Output; &f%{mineplex.api.displayname.%{_p}%}%"
			else:
				send "&9API> &7Invalid API!"

command /give [<string>] [<string>] [<string>] [<string>]:
	aliases: /g, /item, /i
	permission: mineplex.admin
	permission message: &9Permissions> &7This requires Permission Rank [&9ADMIN&7].
	trigger:
		if arg 1 is not set:
			send "&9Give: &7Listing Commands:"
			send "&4/give (item) Admin"
			send "&4/give (player) (item) (amount) Admin"
			send "&4/give all (item) (amount) Admin"
		else:
			if arg 2 is not set:
				set {_i1} to "%arg-2%"
				replace all "_" with " " in {_i1}
				set {_i} to "%{_i1}%" parsed as an item
				if {_i} is an item:
					send "&9Give> &7You gave &e1 %{_i}% &7to &e%player%&7."
					give player {_i}
				else:
					send "&9Item Search> &e0 &7matches for [&e%{_i}%&7]."
					send "&9Item(s) Search> &7Invalid [&e%{_i}%&7]."
		if arg 2 is set:
			if arg 3 is set:
				if arg 1 is "all":
					set {_i1} to "%arg-2%"
					replace all "_" with " " in {_i1}
					set {_i} to "%{_i1}%" parsed as an item
					set {_a} to "%arg-3%" parsed as a number
					if {_i} is an item:
						if {_a} is a number:
							send "&9Give> &7You gave &e%{_a}% %{_i}% &7to &eALL&7."
							send "&9Give> &7You received &e%{_a}% %{_i}% &7from &e%player%&7." to all players
							loop all players:
								loop {_a} times:
									give loop-player {_i}
						else:
							send "&9Give> &7Invalid Amount [%arg-3%]. Defaulting to [1]."
							send "&9Give> &7You gave &e1 %{_i}% &7to &eALL&7."
							send "&9Give> &7You received &e1 %{_i}% &7from &e%player%&7." to all players
							loop all players:
								give loop-player {_i}
					else:
						send "&9Item Search> &e0 &7matches for [&e%{_i1}%&7]."
						send "&9Item(s) Search> &7Invalid [&e%{_i}%&7]."
				else:
					set {_i1} to "%arg-2%"
					replace all "_" with " " in {_i1}
					set {_i} to "%{_i1}%" parsed as an item
					set {_a} to "%arg-3%" parsed as a number
					set {_p} to "%arg-1%" parsed as a player
					if {_i} is an item:
						if {_p} is online:
							if {_a} is a number:
								send "&9Give> &7You gave &e%{_a}% %{_i}% &7to &e%{_p}%&7."
								send "&9Give> &7You received &e%{_a}% %{_i}% &7from &e%player%&7." to {_p}
								loop {_a} times:
									give {_p} {_i}
							else:
								send "&9Give> &7Invalid Amount [%arg-3%]. Defaulting to [1]."
								send "&9Give> &7You gave &e1 %{_i}% &7to &e%{_p}%&7."
								send "&9Give> &7You received &e1 %{_i}% &7from &e%player%&7." to {_p}
								give {_p} {_i}
						else:
							send "&9Online Player Search> &e0 &7matches for [&e%arg-1%&7]."
							send "&9Online Player(s) Search> &7Invalid [&e%arg-1%&7]."
							stop
					else:
						send "&9Item Search> &e0 &7matches for [&e%arg-2%&7]."
						send "&9Item(s) Search> &7Invalid [&e%arg-2%&7]."
			else:
				if arg 1 is "all":
					set {_i1} to "%arg-2%"
					replace all "_" with " " in {_i1}
					set {_i} to "%{_i1}%" parsed as an item
					if {_i} is an item:
						send "&9Give> &7You gave &e1 %{_i}% &7to &eALL&7."
						send "&9Give> &7You received &e1 %{_i}% &7from &e%player%&7." to all players
						loop all players:
							give loop-player {_i}
					else:
						send "&9Item Search> &e0 &7matches for [&e%arg-2%&7]."
						send "&9Item(s) Search> &7Invalid [&e%arg-2%&7]."
				else:
					set {_i1} to "%arg-2%"
					replace all "_" with " " in {_i1}
					set {_i} to "%{_i1}%" parsed as an item
					set {_p} to "%arg-1%" parsed as a player
					if {_i} is an item:
						if {_p} is online:
							send "&9Give> &7You gave &e1 %{_i}% &7to &e%{_p}%&7."
							send "&9Give> &7You received &e1 %{_i}% &7from &e%player%&7." to {_p}
							give {_p} {_i}
						else:
							send "&9Online Player Search> &e0 &7matches for [&e%arg-1%&7]."
							send "&9Online Player(s) Search> &7Invalid [&e%arg-1%&7]."
							stop
					else:
						send "&9Item Search> &e0 &7matches for [&e%arg-2%&7]."
						send "&9Item(s) Search> &7Invalid [&e%arg-2%&7]."	

command /__mp__st__:
	trigger:
		if {mineplex.news.allow} is true:
			send player title "&6&l%{mineplex.config.servername}%" with subtitle "%{mineplex.news.line1}%" for 3.5 seconds
			wait 3 seconds
			send player title "&6&l%{mineplex.config.servername}%" with subtitle "%{mineplex.news.line2}%" for 3.5 seconds
			wait 3 seconds
			send player title "&6&l%{mineplex.config.servername}%" with subtitle "%{mineplex.news.line3}%" for 3.5 seconds
			wait 3 seconds
			send player title "&6&l%{mineplex.config.servername}%" with subtitle "%{mineplex.news.line4}%" for 3.5 seconds

command /updatelevel [<string>] [<integer>]:
	permission: mineplex.admin
	permission message: &9Permissions> &7This requires Permission Rank [&9ADMIN&7].
	trigger:
		if arg 1 is set:
			if arg 2 is set:
				if arg 2 is less than 0:
					set {_temp} to "&d%arg-2%"
					set {mineplex.level.%arg-1%} to "%{_temp}%"
					send "&9Stats> &7Applied &e%arg-2% Global.ExpEarned &7to &e%arg-1%&7."
					stop
				else if arg 2 is less than 20:
					set {_temp} to "&7%arg-2%"
					set {mineplex.level.%arg-1%} to "%{_temp}%"
					send "&9Stats> &7Applied &e%arg-2% Global.ExpEarned &7to &e%arg-1%&7."
					stop
				else if arg 2 is less than 40:
					set {_temp} to "&9%arg-2%"
					set {mineplex.level.%arg-1%} to "%{_temp}%"
					send "&9Stats> &7Applied &e%arg-2% Global.ExpEarned &7to &e%arg-1%&7."
					stop
				else if arg 2 is less than 60:
					set {_temp} to "&2%arg-2%"
					set {mineplex.level.%arg-1%} to "%{_temp}%"
					send "&9Stats> &7Applied &e%arg-2% Global.ExpEarned &7to &e%arg-1%&7."
					stop
				else if arg 2 is less than 80:
					set {_temp} to "&6%arg-2%"
					set {mineplex.level.%arg-1%} to "%{_temp}%"
					send "&9Stats> &7Applied &e%arg-2% Global.ExpEarned &7to &e%arg-1%&7."
					stop
				else if arg 2 is less than or equal to 100:
					set {_temp} to "&c%arg-2%"
					set {mineplex.level.%arg-1%} to "%{_temp}%"
					send "&9Stats> &7Applied &e%arg-2% Global.ExpEarned &7to &e%arg-1%&7."
					stop
				else:
					send "&9Level> &7There was a problem parsing your request...please try again."
			else:
				send "&9Level> &7/updatelevel (player) (level)"
		else:
			send "&9Level> &7/updatelevel (player) (level)"
		
command /mcr:
	trigger:
		send "&9Plugin> &7Mineplex Core"
		send "&9Plugin> &7Running MCR: &e{@MCRVER}"
		send "&9Plugin> &7Hotfix/Release Cycle: &e{@MCRHOTFIX}"
		send "&9Plugin> &7by WheezyGold7931, Torksi, and Ottelino"
		send "&9Plugin> &7Special thanks to LimeGlass, Citrin_, Boobah, and HappyLuigi"
		send ""
		send "&9Patreon> &7Huge Thanks to my Patreons:"
		send "&9Patreon> &eCitrin_"
		send "&9Patreon> &eRealTME01"
		send "&9Patreon> &eVirizin"
		send "&9Patreon> &7If you want to be listed there than support me on Patreon!:"
		send "&9Patreon> &bhttps://www.patreon.com/WheezyGold7931"

command /a [<text>]:
	aliases: /admin
	trigger:
		if arg 1 is not set:
			send "&9Admin> &7Corect Usage: /a (message)"
			stop
		if {mineplex.disguise.%player%} is set:
			send "&9Admin> &7Disguised users cannot use /a while disguised!"
			stop
		else:
			set {_p} to player
		if {mineplex.rank.%{_p}%} is "":
			set {_display} to "Player %{_p}%"
		else:
			set {_display} to "%{mineplex.displaya.%{_p}%}% %{_p}%"
		if player has permission "mineplex.trainee":
			loop all players:
				if loop-player has permission "mineplex.trainee":
					send "%{_display}% &d%arg-1%" to loop-player
		else:
			send "%{_display}% &d%arg-1%"
			loop all players:
				if loop-player has permission "mineplex.trainee":
					send "%{_display}% &d%{_p}%" to loop-player

command /ma [<player>] [<text>]:
	trigger:
		if {mineplex.disguise.%player%} is set:
			send "&9Admin> &7Disguised users cannot use /a while disguised!"
			stop
		else:
			set {_p} to player
		if {mineplex.rank.%{_p}%} is "":
			set {_display} to "&fPlayer %{_p}%"
		else:
			set {_display} to "%{mineplex.displaya.%{_p}%}% %{_p}%"
		if {mineplex.rank.%arg-1%} is "":
			set {_display2} to "&fPlayer %arg-1%"
		else:
			set {_display2} to "%{mineplex.displaya.%arg-1%}% %arg-1%"
		if player has permission "mineplex.trainee":
			if argument 1 and argument 2 is set:
				if arg-1 does not have permission "mineplex.trainee":
					send "&d<- %{_display}% &d%arg-2%" to arg-1
				set {mineplex.lasta.%player%} to arg-1
				loop all players:
					if loop-player has permission "mineplex.trainee":
						send "%{_display}% &d-> %{_display2}% &d%arg-2%" to loop-player
			else:
				send "&9Message> &cErr...something went wrong?"
		else:
			send "&9Permissions> &7This requires Permission Rank [&9TRAINEE&7]."

command /ra [<text>]:
	permission: mineplex.trainee
	permission message: &9Permissions> &7This requires Permission Rank [&9TRAINEE&7].
	trigger:
		if {mineplex.disguise.%player%} is set:
			set {_p} to {mineplex.disguise.%player%}
		else:
			set {_p} to player
		if {mineplex.rank.%{_p}%} is "":
			set {_display} to "&fPlayer %{_p}%"
		else:
			set {_display} to "%{mineplex.displaya.%{_p}%}% %{_p}%"
		if {mineplex.rank.%{mineplex.lasta.%player%}%} is "":
			set {_display2} to "&fPlayer %{mineplex.lasta.%player%}%"
		else:
			set {_display2} to "%{mineplex.displaya.%{mineplex.lasta.%player%}%}% %{mineplex.lasta.%player%}%"
		if {mineplex.lasta.%player%} is not set:
			send "&9Message> &7You have not messaged anyone recently."
			stop
		else:
			if argument 1 is set:
				if {mineplex.lasta.%player%} does not have permission "mineplex.trainee":
					send "&d<- %{_display}% &d%arg-1%" to {mineplex.lasta.%player%}
				loop all players:
					if loop-player has permission "mineplex.trainee":
						send "%{_display}% &d-> %{_display2}% &d%arg-1%" to loop-player
			else:
				send "&9Message> &cErr...something went wrong?"

command /vanish:
	aliases: /incognito
	permission: mineplex.trainee
	permission message: &9Permissions> &7This requires Permission Rank [&9TRAINEE&7]. 
	trigger:
		if {mineplex.vanish.%player%} is true:
			loop all players:
				loop-value doesn't have permission "mineplex.admin"
				add loop-value to {_vanishto::*}
			
			reveal player from all players
			set {mineplex.vanish.%player%} to false
			send "&9Incognito> &7You are no longer incognito. Your status will only change when you run &e/vanish &7again."
		else:
			loop all players:
				loop-value doesn't have permission "mineplex.admin"
				add loop-value to {_vanishto::*}
			
			hide player from {_vanishto::*}
			set {mineplex.vanish.%player%} to true
			send "&9Incognito> &7You are now incognito. Your status will only change when you run &e/vanish &7again."
			send ""
			send ""
			send "&6&lYou are currently incognito"
			send "&eThis means you are invisible to all excepet for those who are"
			send "&4&lAdmin&f+"
			send ""
			send ""

function friendButtons(p: player) :: number:
	set {_t} to "Steve" parsed as an offline player
	set slot 0 of {_p}'s current inventory to {_t}'s skull named "&fFriends" with lore ""
	set slot 2 of {_p}'s current inventory to rose named "&fFriend Requests" with lore ""
	set slot 4 of {_p}'s current inventory to tnt named "&fDelete Friends" with lore ""
	set slot 6 of {_p}'s current inventory to book and quill named "&fSend Friend Request" with lore ""
	set slot 8 of {_p}'s current inventory to sign item named "&7Toggle friends to display in chat" with lore ""

function friendClean(p: player) :: number:
	set {_s} to 18
	loop 27 times:
		set slot {_s} of {_p}'s current inventory to air
		add 1 to {_s}
		if {_s} = 44:
			exit loop
	friendButtons({_p})

function friendMain(p: player) :: number:
	open chest with 6 rows named "Friends" to {_p}
	friendClean({_p})
	set {_s} to 18
	loop {friends.list.%{_p}%::*}:
		set {_t} to "%loop-value%" parsed as offline player
		if {_t} is online:
			set {_a} to "&2Online"
			set {_w} to "&e%{_t}'s world%"
			set slot {_s} of {_p}'s current inventory to {_t}'s skull named "&f&l%{_t}%" with lore "&7&lStatus: %{_a}%||&7&lServer: %{_w}%|| ||&7Left click to teleport to their server"
		else:
			set {_a} to "&cOffline"
			set slot {_s} of {_p}'s current inventory to {_t}'s skull named "&f&l%{_t}%" with lore "&7&lStatus: %{_a}%||&7Last seen N/A Days ago"
		add 1 to {_s}
		if {_s} = 44:
			exit loop

function friendDel(p: player) :: number:
	open chest with 6 rows named "Delete Friends" to {_p}
	friendClean({_p})
	set {_s} to 18
	loop {friends.list.%{_p}%::*}:
		set {_t} to "%loop-value%" parsed as offline player
		if {_t} is online:
			set {_a} to "&2Online"
			set {_w} to "&e%{_t}'s world%"
			set slot {_s} of {_p}'s current inventory to {_t}'s skull named "&f&l%{_t}%" with lore "&7&lStatus: %{_a}%||&7&lServer: %{_w}%|| ||&7Left click to teleport to their server"
		else:
			set {_a} to "&cOffline"
			set slot {_s} of {_p}'s current inventory to {_t}'s skull named "&f&l%{_t}%" with lore "&7&lStatus: %{_a}%||&7Last seen N/A Days ago"
		add 1 to {_s}
		if {_s} = 44:
			exit loop

function friendReq(p: player) :: number:
	open chest with 6 rows named "Friend Requests" to {_p}
	friendClean({_p})
	set {_s} to 18
	loop {friends.request.%{_p}%::*}:
		set {_t} to "%loop-value%" parsed as offline player
		set slot {_s} of {_p}'s current inventory to paper named "&7Friend request from &f&l%{_t}%" with lore "||&7Left click to accept friend request"
		add 1 to {_s}
		if {_s} = 44:
			exit loop

command /friend [<string>] [<string>]:
	aliases: /f
	trigger:
		if arg 1 is not set:
			friendMain(player)
		else:
			if arg 1 is "%player%":
				send "&9Friends> &7You cannot friend yourself!"
				stop
				stop
			loop {friends.list.%arg-1%::*}:
				if loop-value is "%player%":
					set {_f} to true
			loop {friends.request.%arg-1%::*}:
				if loop-value is "%player%":
					set {_a} to true
			if {_a} is true:
				send "&9Friends> &a%arg-1% &7has yet to respond to your friend request."
			else if {_f} is true:
				send "&9Friends> &7You are already friends with &a%arg-1%"
			else:
				add "%player%" to {friends.request.%arg-1%::*}
				send "&9Friends> &7Added &a%arg-1% &7to your friends list!"
		 
on inventory click:
	if inventory name of player's current inventory is "Friends":
		if clicked slot is 2:
			friendReq(player)
		if clicked slot is 4:
			friendDel(player)
		cancel event
	if inventory name of player's current inventory is "Friend Requests":
		if clicked slot is 0:
			friendMain(player)
		if clicked slot is 4:
			friendDel(player)
		else:
			set {_n} to name of clicked item
			if {_n} contains "&7Friend request from ":
				replace all "&7Friend request from " with "" in {_n}
				set {_f} to uncolored {_n}
				remove {_f} from {friends.request.%player%::*}
				add {_f} to {friends.list.%player%::*}
				add "%player%" to {friends.list.%{_f}%::*}
				send "&9Friends> &aYou &7and &a%{_f}% &7are now friends!"
				friendReq(player)
		cancel event
	if inventory name of player's current inventory is "Delete Friends":
		if clicked slot is 0:
			friendMain(player)
		if clicked slot is 2:
			friendReq(player)
		else:
			if "%clicked item%" is "player head":
				if clicked slot is not 0:
					set {_n} to name of clicked item
					set {_f} to uncolored {_n}
					replace all " " with "" in {_f}
					remove {_f} from {friends.list.%player%::*}
					remove {_f} from {friends.list.%{_l}%::*}
					send "&9Friends> &7Deleted &a%{_f}% &7from your friends list!"
					friendDel(player)
		cancel event

command /chatslow [<integer>]:
	aliases: /cs
	permission: mineplex.srmod
	permission message: &9Permissions> &7This requires Permission Rank [&9SR.MOD&7]. 
	trigger:
		if {mineplex.disguise.%player%} is set:
			set {_p} to {mineplex.disguise.%player%}
		else:
			set {_p} to player
		if argument 1 is set:
			if {mineplex.chatsilence} is set:
				send "&9Chat> &7Chat is in silence mode. Disable silence mode to activate slow chat."
				stop
			else:
				if {mineplex.chatslow} is not set:
					set {mineplex.chatslow} to "%arg-2% seconds" parsed as timespan
					send "&9Chat> &6%{_p}% &7has set the chat delay to &6%arg-1%&7 seconds." to all players
				else:
					set {mineplex.chatslow} to "%arg-2% seconds" parsed as timespan
					send "&9Chat> &6%{_p}% &7has enabled chat slow." to all players
					send "&9Chat> &6%{_p}% &7has set the chat delay to &6%arg-1%&7 seconds." to all players
		else:
			if {mineplex.chatsilence} is set:
				send "&9Chat> &7Chat is in silence mode. Disable silence mode to activate slow chat."
				stop
			else:
				if {mineplex.chatslow} is set:
					delete {mineplex.chatslow}
					send "&9Chat> &6%{_p}% &7has disabled chat slow." to all players
				else:
					send "&9Message> &cYou didn't enter a time limit! Defaulting to 10 seconds."
					set {mineplex.chatslow} to "10 seconds" parsed as timespan
					send "&9Chat> &6%{_p}% &7has enabled chat slow." to all players
					send "&9Chat> &6%{_p}% &7has set the chat delay to &610 &7seconds." to all players
command /silence:
	permission: mineplex.admin
	permission message: &9Permissions> &7This requires Permission Rank [&9ADMIN&7].
	trigger:
		if {mineplex.chatslow} is set:
			delete {mineplex.chatslow}
			send "&9Chat> &6%player% &7has disabled chat slow." to all players
			set {mineplex.chatsilence} to true
			send "&9Chat> &7The chat has been silenced for &aPermanent&7." to all players
			stop
		if {mineplex.chatsilence} is set:
			delete {mineplex.chatsilence}
			send "&9Chat> &7The chat is no longer silenced." to all players
		else:
			set {mineplex.chatsilence} to true
			send "&9Chat> &7The chat has been silenced for &aPermanent&7." to all players

command /locate [<string>]:
	aliases: /find, /where
	permission: mineplex.trainee
	permission message: &9Permissions> &7This requires Permission Rank [&9TRAINEE&7].
	trigger:
		if argument 1 is set:
			set {_tmp} to arg 1 parsed as an offline player
			if {_tmp} is online:
				set {_mineplex.locate.temp} to "%{_tmp}'s world%"
				send "&9Locate> &7Located [&e%arg-1%&7] at &9%{_mineplex.locate.temp}%"
			else:
				send "&9Locate> &7Failed to locate [&e%arg-1%&7]."
		else:
			send "&9Locate> &7Player argument missing."

command /updaterank [<offline player>] [<string>]:
	permission: mineplex.admin
	permission message: &9Permissions> &7This requires Permission Rank [&9ADMIN&7].
	trigger:
		if argument 1 or argument 2 is not set:
			send "&9Client Manager> &7Listing Rank Update Commands:"
			send "&f/updaterank (player) (rank): &eupdates chosen player's rank to the chosen rank"
			send ""
			send "&9Rank Update> &7Listing Rank List:"
			send "&9Ranks> &7MEMBER"
			send "&9Ranks> &7ULTRA"
			send "&9Ranks> &7HERO"
			send "&9Ranks> &7LEGEND"
			send "&9Ranks> &7TITAN"
			send "&9Ranks> &7ETERNAL"
			send "&9Ranks> &7TRAINEE"
			send "&9Ranks> &7MOD"
			send "&9Ranks> &7SRMOD"
			send "&9Ranks> &7CMOD"
			send "&9Ranks> &7ADMIN"
			send "&9Ranks> &7LEADER"
			send "&9Ranks> &7OWNER"
			send "&9Ranks> &7BUILDER"
			send "&9Ranks> &7SUPPORT"
			send "&9Ranks> &7MEDIA"
			send "&9Ranks> &7MAPLEAD"
			send "&9Ranks> &7JRDEV"
			send "&9Ranks> &7DEV"
			send "&9Ranks> &7TWITCH"
			send "&9Ranks> &7YOUTUBE"
			send "&9Ranks> &7YT"
		if argument 2 is "MEMBER":
			if argument 2 is set:   #These should now no longer mater so lel.
				set {mineplex.rank.%arg-1%} to ""
				execute console command "/__mp__dp__ %arg-1%"
				send "&9Client Manager> &7%arg-1%'s rank has been updated to None!"
				send "&9Client Manager> &7Your rank has been updated to None!" to arg 1
				set arg-1 tab name to "&e%arg-1%"
				updateRankAPI(arg-1)
			else:
				send "&9Message> &cErr...something went wrong?"
		else if argument 2 is "ULTRA":
			if argument 2 is set:
				set {mineplex.rank.%arg-1%} to "&b&lULTRA "
				execute console command "/__mp__dp__ %arg-1%"
				send "&9Client Manager> &7%arg-1%'s rank has been updated to Ultra!"
				send "&9Client Manager> &7Your rank has been updated to Ultra!" to arg 1
				set arg-1 tab name to "&b&lULTRA &e%arg-1%"
				updateRankAPI(arg-1)
			else:
				send "&9Message> &cErr...something went wrong?"
		else if argument 2 is "HERO":
			if argument 2 is set:
				set {mineplex.rank.%arg-1%} to "&d&lHERO "
				execute console command "/__mp__dp__ %arg-1%"
				send "&9Client Manager> &7%arg-1%'s rank has been updated to Hero!"
				send "&9Client Manager> &7Your rank has been updated to Hero!" to arg 1
				set arg-1 tab name to "&d&lHERO &e%arg-1%"
				updateRankAPI(arg-1)
			else:
				send "&9Message> &cErr...something went wrong?"
		else if argument 2 is "LEGEND":
			if argument 2 is set:
				set {mineplex.rank.%arg-1%} to "&a&lLEGEND "
				execute console command "/__mp__dp__ %arg-1%"
				add "mineplex.legend" to arg-1's permissions
				send "&9Client Manager> &7%arg-1%'s rank has been updated to Legend!"
				send "&9Client Manager> &7Your rank has been updated to Legend!" to arg 1
				set arg-1 tab name to "&a&lLEGEND &e%arg-1%"
				updateRankAPI(arg-1)
			else:
				send "&9Message> &cErr...something went wrong?"
		else if argument 2 is "TITAN":
			if argument 2 is set:
				set {mineplex.rank.%arg-1%} to "&c&lTITAN "
				execute console command "/__mp__dp__ %arg-1%"
				add "mineplex.legend" to arg-1's permissions
				add "mineplex.titan" to arg-1's permissions
				send "&9Client Manager> &7%arg-1%'s rank has been updated to Titan!"
				send "&9Client Manager> &7Your rank has been updated to Titan!" to arg 1
				set arg-1 tab name to "&c&lTITAN &e%arg-1%"
				updateRankAPI(arg-1)
			else:
				send "&9Message> &cErr...something went wrong?"
		else if argument 2 is "ETERNAL":
			if argument 2 is set:
				set {mineplex.rank.%arg-1%} to "&3&lETERNAL "
				execute console command "/__mp__dp__ %arg-1%"
				add "mineplex.legend" to arg-1's permissions
				add "mineplex.titan" to arg-1's permissions
				send "&9Client Manager> &7%arg-1%'s rank has been updated to Eternal!"
				send "&9Client Manager> &7Your rank has been updated to Eternal!" to arg 1
				set arg-1 tab name to "&3&lETERNAL &e%arg-1%"
				updateRankAPI(arg-1)
			else:
				send "&9Message> &cErr...something went wrong?"
		else if argument 2 is "TRAINEE":
			if argument 2 is set:
				set {mineplex.rank.%arg-1%} to "&6&lTRAINEE "
				execute console command "/__mp__dp__ %arg-1%"
				add "mineplex.trainee" to arg-1's permissions
				add "mineplex.legend" to arg-1's permissions
				add "mineplex.titan" to arg-1's permissions
				add "mineplex.2fa" to arg-1's permissions
				send "&9Client Manager> &7%arg-1%'s rank has been updated to Trainee!"
				send "&9Client Manager> &7Your rank has been updated to Trainee!" to arg 1
				set arg-1 tab name to "&6&lTRAINEE &e%arg-1%"
				updateRankAPI(arg-1)
			else:
				send "&9Message> &cErr...something went wrong?"
		else if argument 2 is "MOD":
			if argument 2 is set:
				set {mineplex.rank.%arg-1%} to "&6&lMOD "
				execute console command "/__mp__dp__ %arg-1%"
				add "mineplex.trainee" to arg-1's permissions
				add "mineplex.mod" to arg-1's permissions
				add "mineplex.legend" to arg-1's permissions
				add "mineplex.2fa" to arg-1's permissions
				add "mineplex.titan" to arg-1's permissions
				send "&9Client Manager> &7%arg-1%'s rank has been updated to Mod!"
				send "&9Client Manager> &7Your rank has been updated to Mod!" to arg 1
				set arg-1 tab name to "&6&lMOD &e%arg-1%"
				updateRankAPI(arg-1)
			else:
				send "&9Message> &cErr...something went wrong?"
		else if argument 2 is "SRMOD":
			if argument 2 is set:
				set {mineplex.rank.%arg-1%} to "&6&lSR.MOD "
				execute console command "/__mp__dp__ %arg-1%"
				add "mineplex.trainee" to arg-1's permissions
				add "mineplex.mod" to arg-1's permissions
				add "mineplex.srmod" to arg-1's permissions
				add "mineplex.legend" to arg-1's permissions
				add "mineplex.2fa" to arg-1's permissions
				add "mineplex.titan" to arg-1's permissions
				send "&9Client Manager> &7%arg-1%'s rank has been updated to Sr.Mod!"
				send "&9Client Manager> &7Your rank has been updated to Sr.Mod!" to arg 1
				set arg-1 tab name to "&6&lSR.MOD &e%arg-1%"
				updateRankAPI(arg-1)
			else:
				send "&9Message> &cErr...something went wrong?"
		else if argument 2 is "CMOD":
			if argument 2 is set:
				set {mineplex.rank.%arg-1%} to "&6&lC.MOD "
				execute console command "/__mp__dp__ %arg-1%"
				add "mineplex.trainee" to arg-1's permissions
				add "mineplex.mod" to arg-1's permissions
				add "mineplex.srmod" to arg-1's permissions
				add "mineplex.legend" to arg-1's permissions
				add "mineplex.2fa" to arg-1's permissions
				add "mineplex.titan" to arg-1's permissions
				send "&9Client Manager> &7%arg-1%'s rank has been updated to C.Mod!"
				send "&9Client Manager> &7Your rank has been updated to C.Mod!" to arg 1
				set arg-1 tab name to "&6&lC.MOD &e%arg-1%"
				updateRankAPI(arg-1)
			else:
				send "&9Message> &cErr...something went wrong?"
		else if argument 2 is "ADMIN":
			if argument 2 is set:
				set {mineplex.rank.%arg-1%} to "&4&lADMIN "
				execute console command "/__mp__dp__ %arg-1%"
				add "mineplex.trainee" to arg-1's permissions
				add "mineplex.legend" to arg-1's permissions
				add "mineplex.mod" to arg-1's permissions
				add "mineplex.jrdev" to arg-1's permissions
				add "mineplex.youtube" to arg-1's permissions
				add "mineplex.builder" to arg-1's permissions
				add "mineplex.srmod" to arg-1's permissions
				add "mineplex.admin" to arg-1's permissions
				add "mineplex.titan" to arg-1's permissions
				add "mineplex.2fa" to arg-1's permissions
				send "&9Client Manager> &7%arg-1%'s rank has been updated to Admin!"
				send "&9Client Manager> &7Your rank has been updated to Admin!" to arg 1
				set arg-1 tab name to "&4&lADMIN &e%arg-1%"
				updateRankAPI(arg-1)
			else:
				send "&9Message> &cErr...something went wrong?"
		else if argument 2 is "LEADER":
			if argument 2 is set:
				set {mineplex.rank.%arg-1%} to "&4&lLEADER "
				execute console command "/__mp__dp__ %arg-1%"
				add "mineplex.trainee" to arg-1's permissions
				add "mineplex.mod" to arg-1's permissions
				add "mineplex.jrdev" to arg-1's permissions
				add "mineplex.builder" to arg-1's permissions
				add "mineplex.srmod" to arg-1's permissions
				add "mineplex.admin" to arg-1's permissions
				add "mineplex.youtube" to arg-1's permissions
				add "mineplex.legend" to arg-1's permissions
				add "mineplex.2fa" to arg-1's permissions
				add "mineplex.leader" to arg-1's permissions
				add "mineplex.titan" to arg-1's permissions
				send "&9Client Manager> &7%arg-1%'s rank has been updated to Leader!"
				send "&9Client Manager> &7Your rank has been updated to Leader!" to arg 1
				set arg-1 tab name to "&4&lLEADER &e%arg-1%"
			else:
				send "&9Message> &cErr...something went wrong?"
		else if argument 2 is "OWNER":
			if argument 2 is set:
				set {mineplex.rank.%arg-1%} to "&4&lOWNER "
				execute console command "/__mp__dp__ %arg-1%"
				add "mineplex.trainee" to arg-1's permissions
				add "mineplex.mod" to arg-1's permissions
				add "mineplex.srmod" to arg-1's permissions
				add "mineplex.admin" to arg-1's permissions
				add "mineplex.jrdev" to arg-1's permissions
				add "mineplex.dev" to arg-1's permissions
				add "mineplex.youtube" to arg-1's permissions
				add "mineplex.builder" to arg-1's permissions
				add "mineplex.leader" to arg-1's permissions
				add "mineplex.jrdev" to arg-1's permissions
				add "mineplex.2fa" to arg-1's permissions
				add "mineplex.owner" to arg-1's permissions
				add "mineplex.legend" to arg-1's permissions
				add "mineplex.titan" to arg-1's permissions
				send "&9Client Manager> &7%arg-1%'s rank has been updated to Owner!"
				send "&9Client Manager> &7Your rank has been updated to Owner!" to arg 1
				set arg-1 tab name to "&4&lOWNER &e%arg-1%"
				updateRankAPI(arg-1)
			else:
				send "&9Message> &cErr...something went wrong?"
		else if argument 2 is "BUILDER":
			if argument 2 is set:
				set {mineplex.rank.%arg-1%} to "&9&lBUILDER "
				execute console command "/__mp__dp__ %arg-1%"
				add "mineplex.builder" to arg-1's permissions
				add "mineplex.titan" to arg-1's permissions
				add "mineplex.legend" to arg-1's permissions
				add "mineplex.2fa" to arg-1's permissions
				send "&9Client Manager> &7%arg-1%'s rank has been updated to Builder!"
				send "&9Client Manager> &7Your rank has been updated to Builder!" to arg 1
				set arg-1 tab name to "&9&lBUIDLER &e%arg-1%"
				updateRankAPI(arg-1)
			else:
				send "&9Message> &cErr...something went wrong?"
		else if argument 2 is "SUPPORT":
			if argument 2 is set:
				set {mineplex.rank.%arg-1%} to "&9&lSUPPORT "
				execute console command "/__mp__dp__ %arg-1%"
				add "mineplex.trainee" to arg-1's permissions
				add "mineplex.legend" to arg-1's permissions
				add "mineplex.jrdev" to arg-1's permissions
				add "mineplex.2fa" to arg-1's permissions
				add "mineplex.mod" to arg-1's permissions
				add "mineplex.youtube" to arg-1's permissions
				add "mineplex.builder" to arg-1's permissions
				add "mineplex.srmod" to arg-1's permissions
				add "mineplex.admin" to arg-1's permissions
				add "mineplex.titan" to arg-1's permissions
				send "&9Client Manager> &7%arg-1%'s rank has been updated to Support!"
				send "&9Client Manager> &7Your rank has been updated to Support!" to arg 1
				set arg-1 tab name to "&9&lSUPPORT &e%arg-1%"
				updateRankAPI(arg-1)
			else:
				send "&9Message> &cErr...something went wrong?"
		else if argument 2 is "MEDIA":
			if argument 2 is set:
				set {mineplex.rank.%arg-1%} to "&9&lMEDIA "
				execute console command "/__mp__dp__ %arg-1%"
				add "mineplex.builder" to arg-1's permissions
				add "mineplex.trainee" to arg-1's permissions
				add "mineplex.mod" to arg-1's permissions
				add "mineplex.2fa" to arg-1's permissions
				add "mineplex.srmod" to arg-1's permissions
				add "mineplex.legend" to arg-1's permissions
				add "mineplex.titan" to arg-1's permissions
				send "&9Client Manager> &7%arg-1%'s rank has been updated to Media!"
				send "&9Client Manager> &7Your rank has been updated to Media!" to arg 1
				set arg-1 tab name to "&9&lMEDIA &e%arg-1%"
				updateRankAPI(arg-1)
			else:
				send "&9Message> &cErr...something went wrong?"
		else if argument 2 is "MAPLEAD":
			if argument 2 is set:
				set {mineplex.rank.%arg-1%} to "&9&lMAPLEAD "
				execute console command "/__mp__dp__ %arg-1%"
				add "mineplex.builder" to arg-1's permissions
				add "mineplex.2fa" to arg-1's permissions
				add "mineplex.titan" to arg-1's permissions
				add "mineplex.legend" to arg-1's permissions
				send "&9Client Manager> &7%arg-1%'s rank has been updated to Maplead!"
				send "&9Client Manager> &7Your rank has been updated to Maplead!" to arg 1
				set arg-1 tab name to "&9&lMAPLEAD &e%arg-1%"
				updateRankAPI(arg-1)
			else:
				send "&9Message> &cErr...something went wrong?"
		else if argument 2 is "JRDEV":
			if argument 2 is set:
				set {mineplex.rank.%arg-1%} to "&c&lJR.DEV "
				execute console command "/__mp__dp__ %arg-1%"
				add "mineplex.trainee" to arg-1's permissions
				add "mineplex.mod" to arg-1's permissions
				add "mineplex.srmod" to arg-1's permissions
				add "mineplex.2fa" to arg-1's permissions
				add "mineplex.builder" to arg-1's permissions
				add "mineplex.jrdev" to arg-1's permissions
				add "mineplex.legend" to arg-1's permissions
				add "mineplex.titan" to arg-1's permissions
				send "&9Client Manager> &7%arg-1%'s rank has been updated to Jr.Dev!"
				send "&9Client Manager> &7Your rank has been updated to Jr.Dev!" to arg 1
				set arg-1 tab name to "&c&lJR.DEV &e%arg-1%"
				updateRankAPI(arg-1)
			else:
				send "&9Message> &cErr...something went wrong?"
		else if argument 2 is "DEV":
			if argument 2 is set:
				set {mineplex.rank.%arg-1%} to "&4&lDEV "
				execute console command "/__mp__dp__ %arg-1%"
				add "mineplex.trainee" to arg-1's permissions
				add "mineplex.mod" to arg-1's permissions
				add "mineplex.srmod" to arg-1's permissions
				add "mineplex.jrdev" to arg-1's permissions
				add "mineplex.2fa" to arg-1's permissions
				add "mineplex.admin" to arg-1's permissions
				add "mineplex.leader" to arg-1's permissions
				add "mineplex.owner" to arg-1's permissions
				add "mineplex.builder" to arg-1's permissions
				add "mineplex.dev" to arg-1's permissions
				add "mineplex.youtube" to arg-1's permissions
				add "mineplex.admin" to arg-1's permissions
				add "mineplex.legend" to arg-1's permissions
				add "mineplex.titan" to arg-1's permissions
				send "&9Client Manager> &7%arg-1%'s rank has been updated to Dev!"
				send "&9Client Manager> &7Your rank has been updated to Dev!" to arg 1
				set arg-1 tab name to "&4&lDEV &e%arg-1%"
				updateRankAPI(arg-1)
			else:
				send "&9Message> &cErr...something went wrong?"
		else if argument 2 is "TWITCH":
			if argument 2 is set:
				set {mineplex.rank.%arg-1%} to "&5&lTWITCH "
				execute console command "/__mp__dp__ %arg-1%"
				add "mineplex.twitch" to arg-1's permissions
				add "mineplex.legend" to arg-1's permissions
				add "mineplex.titan" to arg-1's permissions
				add "mineplex.youtube" to arg-1's permissions
				send "&9Client Manager> &7%arg-1%'s rank has been updated to Twitch!"
				send "&9Client Manager> &7Your rank has been updated to Twitch!" to arg 1
				set arg-1 tab name to "&5&lTWITCH &e%arg-1%"
				updateRankAPI(arg-1)
			else:
				send "&9Message> &cErr...something went wrong?"
		else if argument 2 is "YOUTUBE":
			if argument 2 is set:
				set {mineplex.rank.%arg-1%} to "&c&lYOUTUBE "
				execute console command "/__mp__dp__ %arg-1%"
				add "mineplex.youtube" to arg-1's permissions
				add "mineplex.legend" to arg-1's permissions
				add "mineplex.titan" to arg-1's permissions
				send "&9Client Manager> &7%arg-1%'s rank has been updated to Youtube!"
				send "&9Client Manager> &7Your rank has been updated to Youtube!" to arg 1
				set arg-1 tab name to "&c&lYOUTUBE &e%arg-1%"
				updateRankAPI(arg-1)
			else:
				send "&9Message> &cErr...something went wrong?"
		else if argument 2 is "YT":
			if argument 2 is set:
				set {mineplex.rank.%arg-1%} to "&5&lYT "
				execute console command "/__mp__dp__ %arg-1%"
				add "mineplex.youtube" to arg-1's permissions
				add "mineplex.legend" to arg-1's permissions
				add "mineplex.titan" to arg-1's permissions
				send "&9Client Manager> &7%arg-1%'s rank has been updated to YT!"
				send "&9Client Manager> &7Your rank has been updated to YT!" to arg 1
				set arg-1 tab name to "&5&lYT &e%arg-1%"
				updateRankAPI(arg-1)
			else:
				send "&9Client Manager> tf?"
		else:
			send "&9Client Manager> &c&lInvalid rank!"

command /testrank [<offline player>] [<string>]:
	permission: mineplex.srmod
	permission message: &9Permissions> &7This requires Permission Rank [&6SR.MOD&7].
	trigger:
		if arg 1 is not set:
			send "&9Client Manager> &7/testrank joeschmo ETERNAL"
			send "&9Client Manager> &7TestRanks expire on login/logout!"
		else:
			if arg 2 is not set:	
				send "&9Client Manager> &7/testrank joeschmo ETERNAL"
			else:
				if arg 1 is online:
					if {mineplex.testrank.%arg-1%} is not set:
						if arg 2 is "ULTRA":
							set {mineplex.testrank.%arg-1%} to {mineplex.rank.%arg-1%}
							set {mineplex.rank.%arg-1%} to "&b&lULTRA "
							execute console command "/__mp__dp__ %arg-1%"
							set {_or} to uncolored {mineplex.testrank.%arg-1%}
							send "&9Client Manager> &7%arg-1%'s rank has been updated to %arg-2%!"
							send "&9Client Manager> &7%arg-1%'s rank will be reset to %{_or}%on your login!"
							send "&9Client Manager> &7Your rank has been updated to %arg-2%!" to arg 1
							send "&9Client Manager> &7Your rank will be reset to %{_or}%on your login!" to arg 1
							set arg-1 tab name to "&b&lULTRA &e%arg-1%"
							updateRankAPI(arg-1)
						else if arg 2 is "HERO":
							set {mineplex.testrank.%arg-1%} to {mineplex.rank.%arg-1%}
							set {mineplex.rank.%arg-1%} to "&d&lHERO "
							execute console command "/__mp__dp__ %arg-1%"
							set {_or} to uncolored {mineplex.testrank.%arg-1%}
							send "&9Client Manager> &7%arg-1%'s rank has been updated to %arg-2%!"
							send "&9Client Manager> &7%arg-1%'s rank will be reset to %{_or}%on your login!"
							send "&9Client Manager> &7Your rank has been updated to %arg-2%!" to arg 1
							send "&9Client Manager> &7Your rank will be reset to %{_or}%on your login!" to arg 1
							set arg-1 tab name to "&d&lHERO &e%arg-1%"
							updateRankAPI(arg-1)
						else if arg 2 is "LEGEND":
							set {mineplex.testrank.%arg-1%} to {mineplex.rank.%arg-1%}
							set {mineplex.rank.%arg-1%} to "&a&lLEGEND "
							execute console command "/__mp__dp__ %arg-1%"
							set {_or} to uncolored {mineplex.testrank.%arg-1%}
							send "&9Client Manager> &7%arg-1%'s rank has been updated to %arg-2%!"
							send "&9Client Manager> &7%arg-1%'s rank will be reset to %{_or}%on your login!"
							send "&9Client Manager> &7Your rank has been updated to %arg-2%!" to arg 1
							send "&9Client Manager> &7Your rank will be reset to %{_or}%on your login!" to arg 1
							set arg-1 tab name to "&a&lLEGEND &e%arg-1%"
							updateRankAPI(arg-1)
						else if arg 2 is "TITAN":
							set {mineplex.testrank.%arg-1%} to {mineplex.rank.%arg-1%}
							set {mineplex.rank.%arg-1%} to "&c&lTITAN "
							execute console command "/__mp__dp__ %arg-1%"
							set {_or} to uncolored {mineplex.testrank.%arg-1%}
							send "&9Client Manager> &7%arg-1%'s rank has been updated to %arg-2%!"
							send "&9Client Manager> &7%arg-1%'s rank will be reset to %{_or}%on your login!"
							send "&9Client Manager> &7Your rank has been updated to %arg-2%!" to arg 1
							send "&9Client Manager> &7Your rank will be reset to %{_or}%on your login!" to arg 1
							set arg-1 tab name to "&c&lTITAN &e%arg-1%"
							updateRankAPI(arg-1)
						else if arg 2 is "ETERNAL":
							set {mineplex.testrank.%arg-1%} to {mineplex.rank.%arg-1%}
							set {mineplex.rank.%arg-1%} to "&3&lETERNAL "
							execute console command "/__mp__dp__ %arg-1%"
							set {_or} to uncolored {mineplex.testrank.%arg-1%}
							send "&9Client Manager> &7%arg-1%'s rank has been updated to %arg-2%!"
							send "&9Client Manager> &7%arg-1%'s rank will be reset to %{_or}%on your login!"
							send "&9Client Manager> &7Your rank has been updated to %arg-2%!" to arg 1
							send "&9Client Manager> &7Your rank will be reset to %{_or}%on your login!" to arg 1
							set arg-1 tab name to "&3&lETERNAL &e%arg-1%"
							updateRankAPI(arg-1)
						else:
							send "&9Client Manager> &c&lThis player already has a test rank!"
					else:
						send "&9Client Manager> &c&lInvalid rank!"

command /getadmin:
	permission: mineplex.jrdev
	permission message: &9Permissions> &7This requires Permission Rank [&9JR.DEV&7].
	trigger:
		if {mineplex.rank.%player%} is "&c&lJR.DEV ":
			if {mineplex.disguise.%player%} is set:
				set {_p} to {mineplex.disguise.%player%}
			else:
				set {_p} to player
			if {mineplex.adminmode.%player%} is true:
				remove "mineplex.admin" from player's permissions
				remove "mineplex.builder" from player's permissions
				remove "mineplex.youtube" from player's permissions
				set {mineplex.adminmode.%player%} to false
				send "&9Admin Mode> &7%{_p}% Admin Mode: &cFalse"
			else:
				set {mineplex.adminmode.%player%} to true
				add "mineplex.admin" to player's permissions
				add "mineplex.builder" to player's permissions
				add "mineplex.youtube" to player's permissions
				send "&9Admin Mode> &7%{_p}% Admin Mode: &aTrue"
		else:
			send "&9Admin Mode> &7/getadmin is only for JR.DEV!"

command /__mp__dp__ <player>:
	executable by: console
	trigger:
		remove "mineplex.trainee" from arg-1's permissions
		remove "mineplex.legend" from arg-1's permissions
		remove "mineplex.titan" from arg-1's permissions
		remove "mineplex.mod" from arg-1's permissions
		remove "mineplex.srmod" from arg-1's permissions
		remove "mineplex.admin" from arg-1's permissions
		remove "mineplex.leader" from arg-1's permissions
		remove "mineplex.owner" from arg-1's permissions
		remove "mineplex.jrdev" from arg-1's permissions
		remove "mineplex.dev" from arg-1's permissions
		remove "mineplex.twitch" from arg-1's permissions
		remove "mineplex.youtube" from arg-1's permissions
		remove "mineplex.builder" from arg-1's permissions

command /__mp__rawreport__ <player> <player> <text> <text> <text>:
	executable by: console
	trigger:
		if arg 3 is "Hacking":
			set {mineplex.report.player.%{mineplex.report.id}%} to arg-1
			set {mineplex.report.reporter.%{mineplex.report.id}%} to arg-2
			set {mineplex.report.type.%{mineplex.report.id}%} to arg-3
			set {mineplex.report.server.%{mineplex.report.id}%} to arg-4
			set {mineplex.report.reason.%{mineplex.report.id}%} to arg-5
			set {mineplex.report.open.%{mineplex.report.id}%} to true
			send "&9Report> ##%{mineplex.report.id}%> &aSuccessfully created report." to arg-2 
		else if arg 3 is "Chat-Abuse":
			set {mineplex.report.player.%{mineplex.report.id}%} to arg-1
			set {mineplex.report.reporter.%{mineplex.report.id}%} to arg-2
			set {mineplex.report.type.%{mineplex.report.id}%} to arg-3
			set {mineplex.report.server.%{mineplex.report.id}%} to arg-4
			set {mineplex.report.reason.%{mineplex.report.id}%} to arg-5
			set {mineplex.report.open.%{mineplex.report.id}%} to true
			send "&9Report> ##%{mineplex.report.id}%> &aSuccessfully created report." to arg-2 
		else if arg 3 is "Gameplay":
			set {mineplex.report.player.%{mineplex.report.id}%} to arg-1
			set {mineplex.report.reporter.%{mineplex.report.id}%} to arg-2
			set {mineplex.report.type.%{mineplex.report.id}%} to arg-3
			set {mineplex.report.server.%{mineplex.report.id}%} to arg-4
			set {mineplex.report.reason.%{mineplex.report.id}%} to arg-5
			set {mineplex.report.open.%{mineplex.report.id}%} to true
			send "&9Report> ##%{mineplex.report.id}%> &aSuccessfully created report." to arg-2 
		else:
			stop
		loop all players:
			if loop-player has permission "mineplex.trainee":
				if {mineplex.pref.report.%loop-player%} is true:
					send "&9[Report ##%{mineplex.report.id}%] &7%arg-2% has reported %arg-1% for a &e%arg-3% &7offence with reason &e%arg-5%&7!" to loop-player
		add 1 to {mineplex.report.id}

command /report [<offline player>] [<text>]:
	permission: mineplex.titan
	permission message: &9Report> &cThe report feature is currently in a trial phase for Titan players
	trigger:
		if arg-2 is set:
			open chest with 3 rows named "Report %arg-1%" to player
			format slot 11 of player with iron sword named "&c&lHacking" with lore "&7X-ray, Forcefield, Speed, Fly etc" to close then run [send "&9Report ##%{mineplex.report.id}%> &aSuccessfully created report." to player]->[execute console command "/__mp__rawreport__ %arg-1% %player% Hacking %player's world% %arg-2%"]
			format slot 13 of player with book and quill named "&3&lChat Abuse" with lore "&7Verbal Abuse, Spam, Harassment, Trolling, etc" to close then run [send "&9Report ##%{mineplex.report.id}%> &aSuccessfully created report." to player]->[execute console command "/__mp__rawreport__ %arg-1% %player% Chat-Abuse %player's world% %arg-2%"]
			format slot 15 of player with ender pearl named "&fGameplay" with lore "&7Map and Bug Exploits" to close then run [send "&9Report ##%{mineplex.report.id}%> &aSuccessfully created report." to player]->[execute console command "/__mp__rawreport__ %arg-1% %player% Gameplay %player's world% %arg-2%"]
		else:
			send "&9Report> &cInvalid Usage: &e/report <player> <reason>"

command /reporthandle [<string>] [<string>]:
	aliases: /rh
	permission: mineplex.mod
	permission message: &9Permissions> &7This requires Permission Rank [&9MOD&7].
	trigger:
		if arg 1 is not set:
			send "&9Report> &7Corect Usage: &e/reporthandle <report id>"
		else:
			set {_id} to arg-1 parsed as a number
			if {_id} is a number:
				if {mineplex.report.open.%{_id}%} is true:
					if {mineplex.report.hand.%{_id}%} is not set:
						set {mineplex.report.hand.%{_id}%} to player
						loop all players:
							if loop-player has permission "mineplex.trainee":
								if {mineplex.pref.report.%loop-player%} is true:
									send "&9[Report %{_id}%] &e%player% &7is handling this report." to loop-player
					else:
						send "&9Report> &7This report is already being handling!"
				else:
					send "&9Report> &7This report has already been closed or does not exsit!"
			else:
				send "&9Report> &cYour  arguments are inappropriate for this command!"
				send "&9Report> &e/reporthandle (id)"

command /reportclose [<string>] [<string>] [<string>]:
	aliases: /rc
	permission: mineplex.mod
	permission message: &9Permissions> &7This requires Permission Rank [&9MOD&7].
	trigger:
		if arg 1 is not set:
			send "&9Report> &7Corect Usage: &e/reportclose (report id)"
			send "&9Report> &7Reasons: &eUNDETERMINED MUTED BANNED ABUSE"
			stop
		if arg 2 is not set:
			send "&9Report> &7Corect Usage: &e/reportclose (report id)"
			send "&9Report> &7Reasons: &eUNDETERMINED MUTED BANNED ABUSE"
			stop
		else:
			set {_id} to arg-1 parsed as a number
			if {_id} is a number:
				if {mineplex.report.open.%{_id}%} is true:
					if arg 2 is "UNDETERMINED":
						set {_r} to "&f&lCould not determine"
						set {mineplex.report.open.%{_id}%} to false
						loop all players:
							if loop-player has permission "mineplex.trainee":
								if {mineplex.pref.report.%loop-player%} is true:
									send "&9[Report %{_id}%] &e%player% &7closed this report. (%{_r}%&7)." to loop-player
					else if arg 2 is "MUTED":
						set {_r} to "&e&lMuted"
						set {mineplex.report.open.%{_id}%} to false
						loop all players:
							if loop-player has permission "mineplex.trainee":
								if {mineplex.pref.report.%loop-player%} is true:
									send "&9[Report %{_id}%] &e%player% &7closed this report. (%{_r}%&7)." to loop-player
					else if arg 2 is "BANNED":
						set {_r} to "&c&lBanned"
						set {mineplex.report.open.%{_id}%} to false
						loop all players:
							if loop-player has permission "mineplex.trainee":
								if {mineplex.pref.report.%loop-player%} is true:
									send "&9[Report %{_id}%] &e%player% &7closed this report. (%{_r}%&7)." to loop-player
					else if arg 2 is "ABUSE":
						set {_r} to "&4&lAbuse of report system"
						set {mineplex.report.open.%{_id}%} to false
						loop all players:
							if loop-player has permission "mineplex.trainee":
								if {mineplex.pref.report.%loop-player%} is true:
									send "&9[Report %{_id}%] &e%player% &7closed this report. (%{_r}%&7)." to loop-player
					else:
						send "&9Report> &cInvalid report reason!"
				else:
					send "&9Report> &7This report has already been closed or does not exsit!"
			else:
				send "&9Report> &cYour  arguments are inappropriate for this command!"
				send "&9Report> &e/reportclose (report id) (reason)"
				send "&9Report> &7Reasons: &eUNDETERMINED MUTED BANNED ABUSE"

#To Lazy to Move This
on right click:
	if player is holding chest:
		if name of player's tool is "&aCosmetic Menu":
			cancel event
			open chest with 6 rows named "Inventory" to player
			wait 2 ticks
			format slot 4 of player with 409 named "&b&l%{mineplex.shards.%player%}% Treasure Shards" with lore " ||&7This seems like it might come in||&7handy. Maybe I can collect more!" to be unstealable
			format slot 10 of player with nether star named "&a&lParticle Effect" with lore " ||&7Show everyone how cool you||&7are with swirly particles that||&7follow you when you walk!||&8Visible Everywhere|| ||&fYou own 1/1|| ||&fActive: &e%{mineplex.particle.active.%player%}%||&aLeft-Click to Toggle" to close then run [execute player command "/say hi"]
			format slot 12 of player with arrow named "&a&lArrow Effect" with lore " ||&7Your arrows will now leave||&7particle trails as they soar through the air.||&8Visible in Games|| ||&fYou own 1/1|| ||&fActive: &e%{mineplex.arrow.active.%player%}%||&aLeft-Click to Toggle" to close then run [execute player command "/say hi "]
			format slot 14 of player with golden boots named " " with lore " " to close
			format slot 16 of player with bone named " " with lore " " to close

command /cosmetic-system <integer>:
	trigger:
		if arg 1 is 1:
			stop

command /shard [<offline player>] [<string>] [<string>]:
	permission: mineplex.admin
	permission message: &9Permissions> &7This requires Permission Rank [&9ADMIN&7].
	trigger:
		if arg 1 is not set:
			send "&9Shard> &7Missing Args: &e/shard <player> <amount>"
		else:
			if arg 2 is not set:
				send "&9Shard> &7Missing Args: &e/shard <player> <amount>"
			else:
				if arg 1 is not online:
					send "&9Shard> &7Could not find player &e%arg-1%"
				else:
					set {_num} to arg 2 parsed as an integer
					if {_num} is an integer:
						add {_num} to {mineplex.shards.%arg-1%}
						send "&9Shard> &7You gave &e%arg-2% Shards &7to &e%arg-1%&7."
						send "&9Shard> &e%player% &7gave you &e%arg-2% Shards&7." to arg-1
					else:
						send "&9Shard> &7Invalid Shards Amount"

command /gem [<offline player>] [<string>] [<string>]:
	permission: mineplex.admin
	permission message: &9Permissions> &7This requires Permission Rank [&9ADMIN&7].
	trigger:
		if arg 1 is not set:
			send "&9Gem> &7Missing Args: &e/gem <player> <amount>"
		else:
			if arg 2 is not set:
				send "&9Gem> &7Missing Args: &e/gem <player> <amount>"
			else:
				if arg 1 is not online:
					send "&9Gem> &7Could not find player &e%arg-1%"
				else:
					set {_num} to arg 2 parsed as an integer
					if {_num} is an integer:
						add {_num} to {mineplex.gems.%arg-1%}
						send "&9Gem> &7You gave &e%arg-2% Gems &7to &e%arg-1%&7."
						send "&9Gem> &e%player% &7gave you &e%arg-2% Gems&7." to arg-1
					else:
						send "&9Gem> &7Invalid Gems Amount"

command /gadget:
	permission: mineplex.admin
	permission message: &9Permissions> &7This requires Permission Rank [&9ADMIN&7].
	trigger:
		if {mineplex.gadget.enabled} is true:
			set {mineplex.gadget.enabled} to false
			broadcast "&f&lGadgets/Mounts are now &c&lDisabled"
		else:
			set {mineplex.gadget.enabled} to true
			broadcast "&f&lGadgets/Mounts are now &a&lEnabled"

#command /chestmeup:
#	trigger:
#		give player chest named "&aCosmetic Menu"

command /s [<text>]:
	permission: mineplex.mod
	permission message: &9Permissions> &7This requires Permission Rank [&9MOD&7].
	trigger:
		if {mineplex.disguise.%player%} is set:
			set {_p} to {mineplex.disguise.%player%}
		else:
			set {_p} to player
		if argument 1 is set:
			broadcast "&f&l%{_p}% &b%arg-1%"
		else:
			send "&9Broadcast> &7Corect Usage: /s <message>."

command /gm [<player>]:
	permission: mineplex.builder
	permission message: &9Permissions> &7This requires Permission Rank [&9ADMIN&7].
	trigger:
		if {mineplex.disguise.%player%} is set:
			set {_p} to {mineplex.disguise.%player%}
		else:
			set {_p} to player
		if argument 1 is not set:
			if player's gamemode is survival:
				set the player's gamemode to creative
				send "&9Game Mode> &7%{_p}% Creative Mode: &aTrue"
			else:
				set the player's gamemode to survival
				send "&9Game Mode> &7%{_p}% Creative Mode: &cFalse"
		else:
			if arg-1's gamemode is survival:
				set the arg-1's gamemode to creative
				send "&9Game Mode> &7%arg-1% Creative Mode: &aTrue"
			else:
				set the arg-1's gamemode to survival
				send "&9Game Mode> &7%arg-1% Creative Mode: &cFalse"

command /message [<player>] [<text>]:
	aliases: /tell, /m, /w, /msg, /whisper
	trigger:
		if {mineplex.disguise.%player%} is set:
			set {_p} to {mineplex.disguise.%player%}
		else:
			set {_p} to player
		if argument 1 is set:
			if argument 2 is set:
				if {mineplex.pref.pm.%arg-1%} is false:
					send "&d%arg-1% has private messaging disabled."
					stop
				send "&6&l%{_p}% > %arg-1% &e&l%arg-2%"
				send "&6&l%{_p}% > %arg-1% &e&l%arg-2%" to arg-1
				set {mineplex.lastm.%player%} to "%arg-1%" parsed as player
				if {mineplex.rank.%arg-1%} is "&4&lDEV ":
					send "&d%arg-1% is often AFK or minimized, due to plugin developement."
					send "&dPlease be patient if they do not reply instantly."
			else:
				send "&9Message> &cErr...something went wrong?"
		else:
			send "&9Message> &cErr...something went wrong?"


command /ping:
	trigger:
		send "&9Ping> &7PONG!"

on command:
	command is "minecraft:me":
		send "&9Chat> &7Nope, not allowed!"
		cancel event

command /me [<string>]:
	aliases: /minecraft:me
	trigger:
		if arg 1 is not set:
			send "&cUsage: /me <action...>"
		else:
			send "&9Chat> &7Nope, not allowed!"

command /news [<string>] [<string>] [<string>]:
	permission: mineplex.admin
	permission message: &9Permissions> &7This requires Permission Rank [&9ADMIN&7].
	trigger:
		if arg 1 is not set:
			send "&9News Manager> &7Available news arguments for this command:"
			send "&6/news list &7Lists (numbered) stored news messages from database. &cAdmin"
			send "&6/news add <newsEntry> &7Adds specified news entry string to database at end of table. &cAdmin"
			send "&6/news delete ## &7Removes specified (numbered) news entry string from database. &cAdmin"
			send "&6/news set ## <newsEntry> &7Updates specified (numbered) news entry string from database. &cAdmin"
			send "&c*Please Note: &7Updates to server news entries from the database are on a 4 minute cycle! &cAdmin"
		else:
			if arg 1 is "list":
				send "&9Hub Manager> &7Current server news messages:"
				send "&9Hub Manager> &6News 1 &7: &f%{mineplex.news.line1}%"
				send "&9Hub Manager> &6News 2 &7: &f%{mineplex.news.line2}%"
				send "&9Hub Manager> &6News 3 &7: &f%{mineplex.news.line3}%"
				send "&9Hub Manager> &6News 4 &7: &f%{mineplex.news.line4}%"
			else if arg 1 is "add":
				if arg 2 is set:
					set {_news} to "%arg-2%"
					if arg 3 is set:
						set {_news} to "%arg-2% %arg-3%"
					replace all "&" with "§" in {_news}
					if {mineplex.news.line1} is "":
						set {mineplex.news.line1} to {_news}
						send "&9Hub Manager> &7The news entry: &6%{_news}% &7has been added to the database!"
					else if {mineplex.news.line2} is "":
						set {mineplex.news.line2} to {_news}
						send "&9Hub Manager> &7The news entry: &6%{_news}% &7has been added to the database!"
					else if {mineplex.news.line3} is "":
						set {mineplex.news.line3} to {_news}
						send "&9Hub Manager> &7The news entry: &6%{_news}% &7has been added to the database!"
					else if {mineplex.news.line4} is "":
						set {mineplex.news.line4} to {_news}
						send "&9Hub Manager> &7The news entry: &6%{_news}% &7has been added to the database!"
					else:
						send "&9Hub Manager> &c&lNo free news slots!"
				else:
					send "&9Hub Manager> &cYour arguments are inappropriate for this command!"
			else if arg 1 is "delete":
				if arg 2 is set:
					if arg 2 is "1":
						set {mineplex.news.line1} to ""
						send "&9Hub Manager> &7The news entry at position &61 &7has been deleted!"
					else if arg 2 is "2":
						set {mineplex.news.line2} to ""
						send "&9Hub Manager> &7The news entry at position &62 &7has been deleted!"
					else if arg 2 is "3":
						set {mineplex.news.line3} to ""
						send "&9Hub Manager> &7The news entry at position &63 &7has been deleted!"
					else if arg 2 is "4":
						set {mineplex.news.line4} to ""
						send "&9Hub Manager> &7The news entry at position &64 &7has been deleted!"
					else:
						send "&9Hub Manager> &cThe specified new position is invalid!"
				else:
					send "&9Hub Manager> &cYour arguments are inappropriate for this command!"
			else if arg 1 is "set":
				if arg 2 is set:
					if arg 3 is set:
						set {_news} to arg 3
						replace all "&" with "§" in {_news}
						if arg 2 is "1":
							set {mineplex.news.line1} to {_news}
							send "&9Hub Manager> &7The news entry at position &61 &7has been updated to: %{_news}%"
						else if arg 2 is "2":
							set {mineplex.news.line2} to {_news}
							send "&9Hub Manager> &7The news entry at position &62 &7has been updated to: %{_news}%"
						else if arg 2 is "3":
							set {mineplex.news.line3} to {_news}
							send "&9Hub Manager> &7The news entry at position &63 &7has been updated to: %{_news}%"
						else if arg 2 is "4":
							set {mineplex.news.line4} to {_news}
							send "&9Hub Manager> &7The news entry at position &64 &7has been updated to: %{_news}%"
						else:
							send "&9Hub Manager> &cThe specified new position is invalid!"
					else:
						send "&9Hub Manager> &cYour arguments are inappropriate for this command!"
				else:
					send "&9Hub Manager> &cYour arguments are inappropriate for this command!"
			else:
				send "&9News Manager> &7Available news arguments for this command:"
				send "&6/news list &7Lists (numbered) stored news messages from database. &cAdmin"
				send "&6/news add <newsEntry> &7Adds specified news entry string to database at end of table. &cAdmin"
				send "&6/news delete ## &7Removes specified (numbered) news entry string from database. &cAdmin"
				send "&6/news set ## <newsEntry> &7Updates specified (numbered) news entry string from database. &cAdmin"
				send "&c*Please Note: &7Updates to server news entries from the database are on a 4 minute cycle! &cAdmin"

command /r [<text>]:
	aliases: /reply
	trigger:
		if {mineplex.disguise.%player%} is set:
			set {_p} to {mineplex.disguise.%player%}
		else:
			set {_p} to player
		if {mineplex.lastm.%player%} is set:
			if argument 1 is set:
				if {mineplex.lastm.%player%} is online:
					send "&6&l%{_p}% > %{mineplex.lastm.%player%}% &e&l%arg-1%"
					send "&6&l%{_p}% > %{mineplex.lastm.%player%}% &e&l%arg-1%" to {mineplex.lastm.%player%}
				else:
					send "&9Message> &e%{mineplex.lastm.%player%}% &7is no longer online!"
			else:
				send "&9Message> &cErr...something went wrong?"
		else:
			send "&9Message> &7You have not messaged anyone recently." 

command /party [<string>] [<player>]:
	aliases: /z
	trigger:
		if argument 1 is not set:
			send "&9Party> &7Listing Party Commands:"
			send "&f/party <Player>: &eJoin/Create/Invite Player"
			send "&f/party leave: &eLeave your current party"
			send "&f/party kick <Player>: &eKick player from your Party"
			send "&f/party info: &eDisplays info on the current Party."
		else:
			if argument 1 is "kick":
				if {party.%player%} is not set:
					message "&9Party> &7You don't have a party"
				else:
					if {party.%player%} is not player:
						message "&9Party> &7You have to be a party leader to do this"
						stop	
				if player arg is not set:
					message "&9Party> &7Player needed. /party kick <player>"	
				else:
					if {party.%player%::*} doesn't contain player arg:
						message "&9Party> &7The player needs to be in your party"
						stop	
					message "&9Party> &7You kicked %player arg% from the party"	
					message "&9Party> &7You've been kicked by %player% from his party" to player arg
					loop {party.%player%::*}:
						if loop-value = player arg:
							delete {party.%player%::%loop-index%}
					delete {party.%player arg%}
					delete {party.%player arg%.chat}
			else if arg 1 is "leave":
				if {party.%player%} is not set:
					message "&9Party> &7You don't have a party"
				else:
					if {party.%player%} is player:
						message "&9Party> &7You can't leave if you are the leader. Do /party disband"
						stop
					message "&9Party> &7You left your party"
					message "&9Party> &7%player% left your party" to {party.%player%}
					set {party.%player%.chat} to false
					loop {party.%{party.%player%}%::*}:
						if loop-value = player:
							delete {party.%{party.%player%}%::%loop-index%}
					delete {party.%player%}
					delete {party.%player%.chat}
			else if arg 1 is "disband":
				if {party.%player%} is not set:
					message "&9Party> &cYou don't have a party"
				else:
					if {party.%player%} is not player:
						message "&9Party> &7You have to be a party leader to do this"
						stop
					message "&9Party> &7You disband your party"
					loop {party.%player%::*}:
						loop-value is not player:
							message "&9Party> &7Your party has been disbanded" to loop-value
						delete {party.%loop-value%.chat}
						delete {party.%loop-value%}
					delete {party.%player%}
					delete {party.%player%.chat}
					delete {party.%player%::*}
			else if arg 1 is "info":
				if {party.%player%} is not set:
					message "&9Party> &7You don't have a party"
				else:
					message "&9Party> &7Party Details:"
					message "Party Leader: &7%{party.%player%}%"
					set {_partyMember} to ""
					loop {party.%{party.%player%}%::*}:
						set {_partyMember} to "%{_partyMember}% %loop-value%"
					message "Your Party: &7%{_partyMember}%"
			else:
				set {_mineplex.last.party} to "%arg-1%" parsed as player
				if {_mineplex.last.party} is online:
					if {party.%player%} is set:
						add {_mineplex.last.party} to {party.%player%::*}
						set {party.%player%.chat} to true
						set {party.%arg-1%.chat} to true
						set {party.%{_mineplex.last.party}%} to player
						message "&9Party> &7You invited %{_mineplex.last.party}% to the party."	
					else:
						set {party.%player%} to player
						message "&9Party> &7Created a party."
						add player to {party.%player%::*}
						make player execute command "/party %arg-1%"
				else:
					send "&9Party> &7That player is not online."

command /announce [<text>]:
	permission: mineplex.admin
	permission message: &9Permissions> &7This requires Permission Rank [&9ADMIN&7].
	trigger:
		if argument 1 is set:
			send all players title "&eAnnouncement" with subtitle "&f%arg-1%" for 10 seconds
			broadcast "&9Announcement> &b%arg-1%"
		else:
			send "&9Message> &cErr...something went wrong?"

command /global [<text>]:
	permission: mineplex.jrdev
	permission message: &9Permissions> &7This requires Permission Rank [&9JR.DEV&7].
	trigger:
		if arg 1 is not set:
			send "&9Message> &cErr...something went wrong?"
		else:
			broadcast "&9Announcement> &b%arg-1%"

command /lag:
	aliases: /monitor
	trigger:
		set {_tps} to tps
		set {_f} to free ram
		set {_m} to max ram
		send "&9LagMeter> &7Live-------&e%{_tps}%"
		send "&9LagMeter> &7Avg--------&eNaN"
		send "&9LagMeter> &eMEM (RAM)"
		send "&9LagMeter> &7Free-------&e%{_f}%MB"
		send "&9LagMeter> &7Max--------&e%{_m}%MB"

#Punish Systems/Commands

on connect:
	if {banned::%player%} is true:
		if {banned::%player%::type} is "perm":
			kick player due to "&c&lYou are banned for Permanent%nl%&f%{banned::%player%::reason}%%nl%&2Unfairly banned? Appeal at &a%{mineplex.config.appealwebsite}%"
			stop
		if {banned::%player%::type} is "report":
			kick player due to "&c&lYou are banned for Permanent%nl%&f%{banned::%player%::reason}%%nl%&2Unfairly banned? Appeal at &a%{mineplex.config.appealwebsite}%"
			stop
		if {banned::%player%::type} is "temp":		
			set {_waited} to difference between {banned::%player%::when} and now
			if {_waited} is less than {banned::%player%::time}:
				kick player due to "&c&lYou are banned for %{banned::%player%::time}%%nl%&f%{banned::%player%::reason}%%nl%&2Unfairly banned? Appeal at &a%{mineplex.config.appealwebsite}%"
			else:
				execute console command "/__mp__unban__ %player%"

command /p [<offline player>] [<text>]:
	aliases: /punish
	permission: mineplex.trainee
	permission message: &9Permissions> &7This requires Permission Rank [&9TRAINEE&7].
	trigger:
		if arg-2 is not set:
			send "&9Punish> &7Commands List:"
			send "&6/punish &7<player> <reason> &6Mod"
		if arg-2 is set:
			if {p.%arg-1%::Chat1} is not set:
				set {p.%arg-1%::Client3} to "__mp__tempban__ %arg-1% %player% 30"
				set {p.%arg-1%::ClientL3} to "&fBan Duration: &e30.0 Days"
				set {p.%arg-1%::Client2} to "__mp__tempban__ %arg-1% %player% 30"
				set {p.%arg-1%::ClientL2} to "&fBan Duration: &e30.0 Days"
				set {p.%arg-1%::ClientL1} to "&fBan Duration: &e1.0 Days"
				set {p.%arg-1%::Client1} to "__mp__tempban__ %arg-1% %player% 1"
				set {p.%arg-1%::General} to "__mp__htempban__ %arg-1% %player% 4"
				set {p.%arg-1%::GeneralL} to "&fBan Duration: &e4.0 Hours"
				set {p.%arg-1%::Chat1} to "__mp__htempmute__ %arg-1% 2 %player%"
				set {p.%arg-1%::ChatL1} to "&fMute Duration: &e2.0 Hours"
				set {p.%arg-1%::Chat2} to "__mp__tempmute__ %arg-1% 1 %player%"
				set {p.%arg-1%::ChatL2} to "&fMute Duration: &e1.0 Days"
				set {p.%arg-1%::Chat3} to "__mp__tempmute__ %arg-1% 30 %player%"
				set {p.%arg-1%::ChatL3} to "&fMute Duration: &e30.0 Days"
			if {p.%arg-1%::pOffences.Chat1} is 1:
				set {p.%arg-1%::Chat1} to "__mp__htempmute__ %arg-1% 4 %player%"
				set {p.%arg-1%::ChatL1} to "&fMute Duration: &e4.0 Hours"
			if {p.%arg-1%::pOffences.Chat1} is 2:
				set {p.%arg-1%::Chat1} to "__mp__htempmute__ %arg-1% 10 %player%"
				set {p.%arg-1%::ChatL1} to "&fMute Duration: &e10.0 Hours"
			if {p.%arg-1%::pOffences.Chat1} is 3:
				set {p.%arg-1%::Chat1} to "__mp__tempmute__ %arg-1% 1 %player%"
				set {p.%arg-1%::ChatL1} to "&fMute Duration: &e1.0 Days"
			if {p.%arg-1%::pOffences.Chat1} is 4:
				set {p.%arg-1%::Chat1} to "__mp__tempmute__ %arg-1% 1 %player%"
				set {p.%arg-1%::ChatL1} to "&fMute Duration: &e1.4 Days"
			if {p.%arg-1%::pOffences.Chat1} is 5:
				set {p.%arg-1%::Chat1} to "__mp__tempmute__ %arg-1% 3 %player%"
				set {p.%arg-1%::ChatL1} to "&fMute Duration: &e2.8 Days"
			if {p.%arg-1%::pOffences.Chat1} is 6:
				set {p.%arg-1%::Chat1} to "__mp__tempmute__ %arg-1% 7 %player%"
				set {p.%arg-1%::ChatL1} to "&fMute Duration: &e7.0 Days"
			if {p.%arg-1%::pOffences.Chat1} is 7:
				set {p.%arg-1%::Chat1} to "__mp__tempmute__ %arg-1% 14 %player%"
				set {p.%arg-1%::ChatL1} to "&fMute Duration: &e14.0 Days"
			if {p.%arg-1%::pOffences.Chat1} is 8:
				set {p.%arg-1%::Chat1} to "__mp__tempmute__ %arg-1% 30 %player%"
				set {p.%arg-1%::ChatL1} to "&fMute Duration: &e30.0 Days"
			if {p.%arg-1%::pOffences.Chat1} is 9:
				set {p.%arg-1%::Chat1} to "mute %arg-1%"
				set {p.%arg-1%::ChatL1} to "&fMute Duration: &ePermanent"
			if {p.%arg-1%::pOffences.Chat2} is 1:
				set {p.%arg-1%::Chat2} to "__mp__tempmute__ %arg-1% 2 %player%"
				set {p.%arg-1%::ChatL2} to "&fMute Duration: &e2.0 Days"
			if {p.%arg-1%::pOffences.Chat2} is 2:
				set {p.%arg-1%::Chat2} to "__mp__tempmute__ %arg-1% 4 %player%"
				set {p.%arg-1%::ChatL2} to "&fMute Duration: &e4.0 Days"
			if {p.%arg-1%::pOffences.Chat2} is 3:
				set {p.%arg-1%::Chat2} to "tempmute %arg-1% 7d"
				set {p.%arg-1%::ChatL2} to "__mp__tempmute__ %arg-1% 7 %player%"
			if {p.%arg-1%::pOffences.Chat2} is 4:
				set {p.%arg-1%::Chat2} to "__mp__tempmute__ %arg-1% 14 %player%"
				set {p.%arg-1%::ChatL2} to "&fMute Duration: &e14.0 Days"
			if {p.%arg-1%::pOffences.Chat2} is 5:
				set {p.%arg-1%::Chat2} to "__mp__tempmute__ %arg-1% 30 %player%"
				set {p.%arg-1%::ChatL2} to "&fMute Duration: &e30.0 Days"
			if {p.%arg-1%::pOffences.Chat2} is 6:
				set {p.%arg-1%::Chat2} to "__mp__mute__ %arg-1% %player%"
				set {p.%arg-1%::ChatL2} to "&fMute Duration: &ePermanent"
			if {p.%arg-1%::pOffences.Chat3} is 1:
				set {p.%arg-1%::Chat3} to "__mp__mute__ %arg-1% %player%"
				set {p.%arg-1%::ChatL3} to "&fMute Duration: &ePermanent"
			if {p.%arg-1%::pOffences.General} is 1:
				set {p.%arg-1%::General} to "__mp__htempban__ %arg-1% %player% 8"
				set {p.%arg-1%::GeneralL} to "&fBan Duration: &e8.0 Hours"
			if {p.%arg-1%::pOffences.General} is 2:
				set {p.%arg-1%::General} to "__mp__htempban__ %arg-1% %player% 16"
				set {p.%arg-1%::GeneralL} to "&fBan Duration: &e16.0 Hours"
			if {p.%arg-1%::pOffences.General} is 3:
				set {p.%arg-1%::General} to "__mp__tempban__ %arg-1% %player% 1"
				set {p.%arg-1%::GeneralL} to "&fBan Duration: &e1.4 Days"
			if {p.%arg-1%::pOffences.General} is 4:
				set {p.%arg-1%::General} to "__mp__tempban__ %arg-1% %player% 3"
				set {p.%arg-1%::GeneralL} to "&fBan Duration: &e3.0 Days"
			if {p.%arg-1%::pOffences.General} is 5:
				set {p.%arg-1%::General} to "__mp__tempban__ %arg-1% %player% 7"
				set {p.%arg-1%::GeneralL} to "&fBan Duration: &e7.0 Days"
			if {p.%arg-1%::pOffences.General} is 6:
				set {p.%arg-1%::General} to "__mp__tempban__ %arg-1% %player% 14"
				set {p.%arg-1%::GeneralL} to "&fBan Duration: &e14.0 Days"
			if {p.%arg-1%::pOffences.General} is 7:
				set {p.%arg-1%::General} to "__mp__tempban__ %arg-1% %player% 30"
				set {p.%arg-1%::GeneralL} to "&fBan Duration: &e30.0 Days"
			if {p.%arg-1%::pOffences.General} is 8:
				set {p.%arg-1%::General} to "__mp__ban__ %arg-1% %player%"
				set {p.%arg-1%::GeneralL} to "&fBan Duration: &ePermanent"
			   
			if {p.%arg-1%::pOffences.Client1} is 1:
				set {p.%arg-1%::Client1} to "__mp__tempban__ %arg-1% %player% 2"
				set {p.%arg-1%::ClientL1} to "&fBan Duration: &e2.0 Days"
			if {p.%arg-1%::pOffences.Client1} is 2:
				set {p.%arg-1%::Client1} to "__mp__tempban__ %arg-1% %player% 4"
				set {p.%arg-1%::ClientL1} to "&fBan Duration: &e4.0 Days"
			if {p.%arg-1%::pOffences.Client1} is 3:
				set {p.%arg-1%::Client1} to "__mp__tempban__ %arg-1% %player% 7"
				set {p.%arg-1%::ClientL1} to "&fBan Duration: &e7.0 Days"
			if {p.%arg-1%::pOffences.Client1} is 4:
				set {p.%arg-1%::Client1} to "__mp__tempban__ %arg-1% %player% 16"
				set {p.%arg-1%::ClientL1} to "&fBan Duration: &e16.0 Days"
			if {p.%arg-1%::pOffences.Client1} is 5:
				set {p.%arg-1%::Client1} to "__mp__tempban__ %arg-1% %player% 30"
				set {p.%arg-1%::ClientL1} to "&fBan Duration: &e30.0 Days"
			if {p.%arg-1%::pOffences.Client1} is 6:
				set {p.%arg-1%::Client1} to "__mp__ban__ %arg-1% %player%"
				set {p.%arg-1%::ClientL1} to "&fBan Duration: &ePermanent"
			if {p.%arg-1%::pOffences.Client2} is 1:
				set {p.%arg-1%::Client2} to "__mp__ban__ %arg-1% %player%"
				set {p.%arg-1%::ClientL2} to "&fBan Duration: &ePermanent"
			if {p.%arg-1%::pOffences.Client3} is 1:
				set {p.%arg-1%::Client3} to "__mp__ban__ %arg-1% %player%"
				set {p.%arg-1%::ClientL3} to "&fBan Duration: &ePermanent"
			if {p.%arg-1%::pOffences.Chat1} is not set:
				set {p.%arg-1%::pOffences.Chat1} to 0
				set {p.%arg-1%::pOffences.Chat2} to 0
				set {p.%arg-1%::pOffences.Chat3} to 0
				set {p.%arg-1%::pOffences.General} to 0
				set {p.%arg-1%::pOffences.Client1} to 0
				set {p.%arg-1%::pOffences.Client2} to 0
				set {p.%arg-1%::pOffences.Client3} to 0
			if player has permission "mineplex.trainee" or "mineplex.mod":
				delete {reversed.p.%arg-1%::history::*}
				set {_slot} to 0
				loop {p.%arg-1%::history::*}:
					add 1 to {_slot}
				set {_reversedslot} to 1
				loop {p.%arg-1%::history::*}:
					set {reversed.p.%arg-1%::history::%{_reversedslot}%} to "%{p.%arg-1%::history::%{_slot}%}%"
					remove 1 from {_slot}
					add 1 to {_reversedslot}
				open chest with 6 rows named "            Punish" to player
				wait 3 tick
				format slot 4 of player with arg-1's skull named "&a&l%arg-1%" with lore "&r%arg-2%" to be unstealable
	   
				format slot 10 of player with book and quill named "&a&lChat Offense" with lore "&7Verbal Abuse, Spam, Harrassment, Trolling, etc" to be unstealable
				format slot 19 of player with cactus green named "&a&lSeverity 1" with lore "&fPast Offences: &e%{p.%arg-1%::pOffences.Chat1}%||%{p.%arg-1%::ChatL1}%||||&7Light Spam||&f   Sending the same message 2-5 times||||&7Light Advertising||&f   'anyone want to play on minecade?'||||&7Light Abuse/Harassment||&f   'you suck at this game'||||&7Hackusations||&f   'you're such a hacker!'||||&7Trolling||||&2Give Warning if 0 Past Offences and 0 Warnings." to close then run [execute console command "%{p.%arg-1%::Chat1}% %arg-2%"]->[add "&ePunishment Type: &fChatOffense||&eSeverity: &f1||||&eReason: &f%arg-2%||||&eStaff: &f%player%||||&eDate: &f%now%" to {p.%arg-1%::history::*}]->[add 1 to {p.%arg-1%::pOffences.Chat1}]
	   
				format slot 12 of player with hopper named "&a&lGeneral Offense" with lore "&7Command/Map/Class/Skill exploits, etc" to be unstealable
				format slot 21 of player with cactus green named "&a&lSeverity 1" with lore "&fPast Offences: &e%{p.%arg-1%::pOffences.General}%||%{p.%arg-1%::GeneralL}%||||&7Team Killing||&f   Intentionally killing your team mates||||&7Trolling (Gameplay)||&f   Using abilities to trap players in spawn||||&7Map/Bug Exploiting||&f   Abusing an exploit to gain an advantage" to close then run [execute console command "%{p.%arg-1%::General}% %arg-2%"]->[add "&ePunishment Type: &fExploiting||&eSeverity: &f1||||&eReason: &f%arg-2%||||&eStaff: &f%player%||||&eDate: &f%now%" to {p.%arg-1%::history::*}]->[add 1 to {p.%arg-1%::pOffences.General}]
		  
				format slot 14 of player with iron sword named "&a&lClient Mod" with lore "&7X-ray, Forcefield, Speed, Fly, Inventory Hacks, etc" to be unstealable
				format slot 23 of player with cactus green named "&a&lSeverity 1" with lore "&fPast Offences: &e%{p.%arg-1%::pOffences.Client1}%||%{p.%arg-1%::ClientL1}%||||&7Examples;||&f   Damage Indicators||&f   Player Radar" to close then run [execute console command "%{p.%arg-1%::Client1}% %arg-2%"]->[add "&ePunishment Type: &fHacking||&eSeverity: &f1||||&eReason: &f%arg-2%||||&eStaff: &f%player%||||&eDate: &f%now%" to {p.%arg-1%::history::*}]->[add 1 to {p.%arg-1%::pOffences.Client1}]
			
				format slot 25 of player with paper named "&a&lWarning" with lore "||&7Example Warning Input;||&f   Spam - Repeatedly writing MEOW||&f   Swearing - Saying 'fuck' and 'shit'||&f   Hack Accusation - Accused Tomp13 of hacking||&f   Trolling - was trying to make bob angry in chat" to close then run [execute console command "__mp__warn__ %arg-1% %player% %arg-2%"]->[add "&ePunishment Type: &fWarning||||&eReason: &f%arg-2%||||&eStaff: &f%player%||||&eDate: &f%now%" to {p.%arg-1%::history::*}]
				if player has permission "mineplex.mod": #Access all punishments!
					format slot 28 of player with dandelion yellow named "&a&lSeverity 2" with lore "&fPast Offences: &e%{p.%arg-1%::pOffences.Chat2}%||%{p.%arg-1%::ChatL2}%||||&7Medium Spam||   &fSending the same message 6-20 times||||&7Medium Advertising;||   &f'join crap.server.net' - posted once||||&7Medium Abuse/Harassment||   &f'piss off you stupid newb'||   &f'SHIT ADMINS ARE SHIT!!!'||   &f'you're terrible, learn to play'||||&7Avoiding Chat Filter||   &f'F|_|<K YOU'" to close then run [execute console command "%{p.%arg-1%::Chat2}% %arg-2%"]->[add "&ePunishment Type: &fChatOffense||&eSeverity: &f2||||&eReason: &f%arg-2%||||&eStaff: &f%player%||||&eDate: &f%now%" to {p.%arg-1%::history::*}]->[add 1 to {p.%arg-1%::pOffences.Chat2}]
					format slot 37 of player with rose red named "&a&lSeverity 3" with lore "&fPast Offences: &e%{p.%arg-1%::pOffences.Chat3}%||%{p.%arg-1%::ChatL3}%||||&7Severe Spam||   &fSending the same message 20+ times||   &fOnly really used for a spam bot||||&7Severe Abuse/Harassment||   &f'go fucking die in a fire you fucking sack of shit'" to close then run [execute console command "%{p.%arg-1%::Chat3}% %arg-2%"]->[add "&ePunishment Type: &fChatOffense||&eSeverity: &f3||||&eReason: &f%arg-2%||||&eStaff: &f%player%||||&eDate: &f%now%" to {p.%arg-1%::history::*}]->[add 1 to {p.%arg-1%::pOffences.Chat3}]
 
					format slot 32 of player with dandelion yellow named "&a&lSeverity 2" with lore "&fPast Offences: &e%{p.%arg-1%::pOffences.Client2}%||%{p.%arg-1%::ClientL2}%||||&7Hacks;||   &fForcefield||   &fSpeed Hack||   &fReach Hack||   &fOther Hack||||&7Hack Reports (SR & FR);||   &fForcefield||   &fSpeed Hack||   &fReach Hack||   &fOther Hack||   &fFly Hack" to close then run [execute console command "%{p.%arg-1%::Client2}% %arg-2%"]->[add "&ePunishment Type: &fHacking||&eSeverity: &f2||||&eReason: &f%arg-2%||||&eStaff: &f%player%||||&eDate: &f%now%" to {p.%arg-1%::history::*}]->[add 1 to {p.%arg-1%::pOffences.Client2}]
					format slot 41 of player with rose red named "&a&lSeverity 3" with lore "&fPast Offences: &e%{p.%arg-1%::pOffences.Client3}%||%{p.%arg-1%::ClientL3}%||||&7Hacks:||   &fFly Hack||||&c&lWARNING;||&cUse Severity 2 for Forum/Staff Reports" to close then run [execute console command "%{p.%arg-1%::Client3}% %arg-2%"]->[add "&ePunishment Type: &fHacking||&eSeverity: &f3||||&eReason: &f%arg-2%||||&eStaff: &f%player%||||&eDate: &f%now%" to {p.%arg-1%::history::*}]->[add 1 to {p.%arg-1%::pOffences.Client3}]
					   
					format slot 43 of player with book and quill named "&a&lPermanent Mute" with lore "&fMute Duration: &ePermanent||||&7Severe Advertising;||&f   'JOIN MINECADE! THIS SUCKS!||&f   'join crap.server.net! FREE ADMIN!||||&2Must supply detailed reason for Mute." to close then run [execute console command "__mp__mute__ %arg-1% %player% %arg-2%"]->[add "&ePunishment Type: &fChatOffense||&eSeverity: &f4||||&eReason: &f%arg-2%||||&eStaff: &f%player%||||&eDate: &f%now%" to {p.%arg-1%::history::*}]
					format slot 34 of player with redstone block named "&a&lPermanent Ban" with lore "&fBan Duration: &ePermanent||||&2Must supply detailed reason for Ban." to close then run [execute console command "__mp__ban__ %arg-1% %player% %arg-2%"]->[add "&ePunishment Type: &fOther||||&eReason: &f%arg-2%||||&eStaff: &f%player%||||&eDate: &f%now%" to {p.%arg-1%::history::*}]
					format slot 26 of player with enchanted book named "&a&lPermanent Report Ban" with lore "&fReport Ban Duration: &ePermanent||||&7Abusing Report Feature||   &r/report SomeUser THE STAFF HERE SUCK||   &r/report SomeUser MINEPLEX IS A F****** PIECE OF S***" to close then run [execute console command "__mp__rban__ %arg-1% %player% %arg-2%"]->[add "&ePunishment Type: &rOther||||&eReason: &f%arg-2%||||&eStaff: &f%player%||||&eDate: &f%now%" to {p.%arg-1%::history::*}]
					set {_slot} to 45
					loop {reversed.p.%arg-1%::history::*}:
						set {punishgui.%player%::*} to "%arg 1%"
						add "%arg 2%" to {punishgui.%player%::*}
						if "%loop-value%" contains "&ePunishment Type: &fChatOffense":
							if {muted::%arg-1%} is true:
								set slot {_slot} of player's current inventory to shiny book and quill named "&a&lChat Offense" with lore "%loop-value%"
								add 1 to {_slot}
							else:
								set slot {_slot} of player's current inventory to book and quill named "&a&lChat Offense" with lore "%loop-value%"
								add 1 to {_slot}
						if "%loop-value%" contains "&ePunishment Type: &fHacking":
							if {banned::%arg-1%} is true:
								set slot {_slot} of player's current inventory to shiny iron sword named "&a&lClient Mod" with lore "%loop-value%"
								add 1 to {_slot}
							else:
								set slot {_slot} of player's current inventory to iron sword named "&a&lClient Mod" with lore "%loop-value%"
								add 1 to {_slot}
						if "%loop-value%" contains "&ePunishment Type: &fExploiting":
							if {banned::%arg-1%} is true:
								set slot {_slot} of player's current inventory to shiny hopper named "&a&lGeneral Offense" with lore "%loop-value%"
								add 1 to {_slot}
							else:
								set slot {_slot} of player's current inventory to hopper named "&a&lGeneral Offense" with lore "%loop-value%"
								add 1 to {_slot}
						if "%loop-value%" contains "&ePunishment Type: &fWarning":
							set slot {_slot} of player's current inventory to paper named "&a&lWarning" with lore "%loop-value%"
							add 1 to {_slot}
						if "%loop-value%" contains "&ePunishment Type: &fOther":
							if {banned::%arg-1%} is true:
								set slot {_slot} of player's current inventory to shiny redstone block named "&a&lPermanent Ban" with lore "%loop-value%"
								add 1 to {_slot}
							else:
								set slot {_slot} of player's current inventory to redstone block named "&a&lPermanent Ban" with lore "%loop-value%"
								add 1 to {_slot}
						if "%loop-value%" contains "&ePunishment Type: &rOther":
							set slot {_slot} of player's current inventory to enchanted book named "&a&lPermanent Report Ban" with lore "%loop-value%"
							add 1 to {_slot}
						if {_slot} = 54:
							exit loop
				if player has permission "mineplex.jrdev": #Developer Warning
					format slot 0 of player with shiny dandelion named "&a&lDEV WARNING" with lore "&rDevelopers are advised against using the punish system||&runless permitted by LT" to be unstealable

on inventory click:
	if inventory name of player's current inventory is "            Punish":
		cancel event
		clicked slot >= 45
		set {_clickedslot.%player%} to (clicked slot - 44)
		if {reversed.p.%{punishgui.%player%::1}%::history::%{_clickedslot.%player%}%} is set:
			if "%{reversed.p.%{punishgui.%player%::1}%::history::%{_clickedslot.%player%}%}%" contains "&eRemoved by: ":
				send "" to console
			else:
				set {_reasonchanger.%player%} to "%{reversed.p.%{punishgui.%player%::1}%::history::%{_clickedslot.%player%}%}% ||||&eRemoved by: &f%player%||&eRemove Reason: &f%{punishgui.%player%::2}%"
				set {reversed.p.%{punishgui.%player%::1}%::history::%{_clickedslot.%player%}%} to "%{_reasonchanger.%player%}%"
				close player's inventory
				delete {p.%{punishgui.%player%::1}%::history::*}
				set {_slot} to 0
				loop {reversed.p.%{punishgui.%player%::1}%::history::*}:
					add 1 to {_slot}
				set {_reversedslot} to 1
				loop {reversed.p.%{punishgui.%player%::1}%::history::*}:
					set {p.%{punishgui.%player%::1}%::history::%{_reversedslot}%} to "%{reversed.p.%{punishgui.%player%::1}%::history::%{_slot}%}%"
					remove 1 from {_slot}
					add 1 to {_reversedslot}
				if "%{_reasonchanger.%player%}%" contains "ChatOffense":
					execute console command "__mp__unmute__ %{punishgui.%player%::1}%"
				if "%{_reasonchanger.%player%}%" contains "Hacking" or "Exploiting" or "Other":
					execute console command "__mp__unban__ %{punishgui.%player%::1}%"
				if "%{_reasonchanger.%player%}%" contains "Warning":
					stop

#Punish
#----Internal Punishments

command /__mp__warn__ <offline player> <offline player> <text>:
	trigger:
		if executor is player:
			send "Unknown command. Type ""help"" for help."
			stop
		else:
			if {mineplex.disguise.%arg-2%} is set:
				set {_p} to {mineplex.disguise.%arg-2%}
			else:
				set {_p} to arg-2
			send "&9Punish> &7%{_p}% issued a friendly warning to %arg-1%." to arg-1
			send "&9Punish> &7&lReason: &7%arg-3%" to arg-1
			add 1 to {mineplex.punish.past.warn.%arg-1%}
			loop all players:
				if loop-player has permission "mineplex.trainee":
					send "&9Punish> &7%{_p}% issued a friendly warning to %arg-1%." to loop-player

command /__mp__rban__ [<text>] [<text>] [<text>]:
	trigger:
		if executor is player:
			send "Unknown command. Type ""help"" for help."
			stop
		if player does not have permission "ban.people":
			message "&4* &cYou do not have permission to ban people."
			stop
		if arg 1 is not set:
			message "&4* &cUnspecified player. &7Try &f/ban [player] [reason]&7."
			stop
		if arg 2 is not set:
			message "&4* &cUnspecified time. &7Try &f/ban %arg 1% [reason]&7."
			stop
			
		set {_player} to arg 1 parsed as offlineplayer

		set {banned::%{_player}%} to true
		set {banned::%{_player}%::type} to "report"
		set {banned::%{_player}%::reason} to arg 3
		set {banned::%{_player}%::staff} to arg 2
		set {banned::%{_player}%::when} to now
		add 1 to {mineplex.punish.past.reportban.%{_player}%}
		execute console command "__mp__irbm__ %arg-2% %{_p}% Permanent"
		
		kick {_player} due to "&c&lYou are banned for Permanent by %arg-2%%nl%&f%{banned::%{_player}%::reason}%%nl%&2Unfairly banned? Appeal at &a%{mineplex.config.appealwebsite}%"

command /__mp__ban__ [<text>] [<text>] [<text>]:
	trigger:
		if executor is player:
			send "Unknown command. Type ""help"" for help."
			stop
		if player does not have permission "ban.people":
			message "&4* &cYou do not have permission to ban people."
			stop
		if arg 1 is not set:
			message "&4* &cUnspecified player. &7Try &f/ban [player] [reason]&7."
			stop
		if arg 2 is not set:
			message "&4* &cUnspecified time. &7Try &f/ban %arg 1% [reason]&7."
			stop
			
		set {_player} to arg 1 parsed as offlineplayer

		set {banned::%{_player}%} to true
		set {banned::%{_player}%::type} to "perm"
		set {banned::%{_player}%::reason} to arg 3
		set {banned::%{_player}%::staff} to arg 2
		set {banned::%{_player}%::when} to now
		add 1 to {mineplex.punish.past.permban.%{_player}%}
		execute console command "__mp__ibm__ %arg-2% %{_player}% Permanent"
		
		kick {_player} due to "&c&lYou are banned for Permanent by %arg-2%%nl%&f%{banned::%{_player}%::reason}%%nl%&2Unfairly banned? Appeal at &a%{mineplex.config.appealwebsite}%"

command /__mp__tempban__ [<text>] [<text>] [<text>] [<text>]:
	trigger:
		if executor is player:
			send "Unknown command. Type ""help"" for help."
			stop
		if player does not have permission "ban.people":
			message "&4* &cYou do not have permission to ban people."
			stop
		if arg 1 is not set:
			message "&4* &cUnspecified player. &7Try &f/tempban [player] [time] [reason]&7."
			stop
		if arg 2 is not set:
			message "&4* &cUnspecified time. &7Try &f/tempban %arg 1% [time] [reason]&7."
			stop
		if arg 3 is not set:
			message "&4* &cUnspecified reason. &7Try &f/tempban %arg 1% %arg 2% [reason]&7."
			stop
			
		set {_player} to arg 1 parsed as offlineplayer
		set {_duration} to "%arg 3% days" parsed as timespan
		
		

		set {banned::%{_player}%} to true
		set {banned::%{_player}%::type} to "temp"
		set {banned::%{_player}%::reason} to arg 4
		set {banned::%{_player}%::time} to {_duration}
		set {banned::%{_player}%::staff} to arg 2
		set {banned::%{_player}%::when} to now
		add 1 to {mineplex.punish.past.tempban.%{_player}%}
		execute console command "__mp__ibm__ %arg-2% %{_player}% %{_duration}%"
		
		kick {_player} due to "&c&lYou are banned for %{banned::%{_player}%::time}% by %arg-2%%nl%&f%{banned::%{_player}%::reason}%%nl%&2Unfairly banned? Appeal at &a%{mineplex.config.appealwebsite}%"

command /__mp__htempban__ [<text>] [<text>] [<text>] [<text>]:
	trigger:
		if executor is player:
			send "Unknown command. Type ""help"" for help."
			stop
		if player does not have permission "ban.people":
			message "&4* &cYou do not have permission to ban people."
			stop
		if arg 1 is not set:
			message "&4* &cUnspecified player. &7Try &f/tempban [player] [time] [reason]&7."
			stop
		if arg 2 is not set:
			message "&4* &cUnspecified time. &7Try &f/tempban %arg 1% [time] [reason]&7."
			stop
		if arg 3 is not set:
			message "&4* &cUnspecified reason. &7Try &f/tempban %arg 1% %arg 2% [reason]&7."
			stop
			
		set {_player} to arg 1 parsed as offlineplayer
		set {_duration} to "%arg 3% hours" parsed as timespan
		
		

		set {banned::%{_player}%} to true
		set {banned::%{_player}%::type} to "temp"
		set {banned::%{_player}%::reason} to arg 4
		set {banned::%{_player}%::time} to {_duration}
		set {banned::%{_player}%::when} to now
		add 1 to {mineplex.punish.past.tempban.%{_player}%}
		execute console command "__mp__ibm__ %arg-2% %{_player}% %{_duration}%"
		
		kick {_player} due to "&c&lYou are banned for %{banned::%{_player}%::time}% by %arg-2%%nl%&f%{banned::%{_player}%::reason}%%nl%&2Unfairly banned? Appeal at &a%{mineplex.config.appealwebsite}%"

command /__mp__tempmute__ [<text>] [<text>] [<text>] [<text>]:
	trigger:
		if executor is player:
			send "Unknown command. Type ""help"" for help."
			stop
		if player does not have permission "mute.people":
			stop
		if arg 1 is not set:
			stop
		if arg 2 is not set:
			stop
		if arg 3 is not set:
			stop
			
		set {_player} to arg 1 parsed as offlineplayer
		set {_duration} to "%arg 2% days" parsed as timespan
		
		

		set {muted::%{_player}%} to true
		set {muted::%{_player}%::type} to "temp"
		set {muted::%{_player}%::reason} to arg 4
		set {muted::%{_player}%::time} to {_duration}
		set {muted::%{_player}%::when} to now
		set {muted::%{_player}%::by} to arg 3
		add 1 to {mineplex.punish.past.tempmute.%{_player}%}
		execute console command "__mp__imm__ %arg-2% %{_player}% %{_duration}%"

		send "&9Punish> &7&lReason: &r&7%arg-4%" to {_player}
		send "&9Punish> &7%{muted::%{_player}%::by}% muted %arg-1% for %{muted::%{_player}%::time}%." to {_player}

command /__mp__htempmute__ [<text>] [<text>] [<text>] [<text>]:
	trigger:
		if executor is player:
			send "Unknown command. Type ""help"" for help."
			stop
		if player does not have permission "mute.people":
			stop
		if arg 1 is not set:
			stop
		if arg 2 is not set:
			stop
		if arg 3 is not set:
			stop
			
		set {_player} to arg 1 parsed as offlineplayer
		set {_duration} to "%arg 2% hours" parsed as timespan
		
		

		set {muted::%{_player}%} to true
		set {muted::%{_player}%::type} to "temp"
		set {muted::%{_player}%::reason} to arg 4
		set {muted::%{_player}%::time} to {_duration}
		set {muted::%{_player}%::when} to now
		set {muted::%{_player}%::by} to arg 3
		add 1 to {mineplex.punish.past.tempmute.%{_player}%}
		execute console command "__mp__imm__ %arg-2% %{_player}% %{_duration}%"

		send "&9Punish> &7&lReason: &r&7%arg-4%" to {_player}
		send "&9Punish> &7%{muted::%{_player}%::by}% muted %arg-1% for %{muted::%{_player}%::time}%." to {_player}

command /__mp__mute__ [<text>] [<text>] [<text>]:
	trigger:
		if executor is player:
			send "Unknown command. Type ""help"" for help."
			stop
		if player does not have permission "mute.people":
			stop
		if arg 1 is not set:
			stop
		if arg 2 is not set:
			stop
			
		set {_player} to arg 1 parsed as offlineplayer

		set {muted::%{_player}%} to true
		set {muted::%{_player}%::type} to "perm"
		set {muted::%{_player}%::reason} to arg 3
		set {muted::%{_player}%::by} to arg 2
		add 1 to {mineplex.punish.past.permmute.%{_player}%}
		execute console command "__mp__imm__ %arg-2% %{_player}% Permanent"

		send "&9Punish> &7&lReason: &r&7%arg-3%" to {_player}
		send "&9Punish> &7%{muted::%{_player}%::by}% muted %arg-1% for Permanent." to {_player}

#Punish
#----Internal Reverse Punish Commands

command /__mp__unban__ [<text>]:
	trigger:
		if executor is player:
			send "Unknown command. Type ""help"" for help."
			stop
		if arg 1 is not set:
			stop
		set {_player} to arg 1 parsed as offlineplayer
		delete {banned::%{_player}%}
		delete {banned::%{_player}%::*}
		message "&4* &cYou have unbanned %{_player}%"

command /__mp__unmute__ [<text>]:
	trigger:
		if executor is player:
			send "Unknown command. Type ""help"" for help."
			stop
		if arg 1 is not set:
			stop
		set {_player} to arg 1 parsed as offlineplayer
		delete {muted::%{_player}%}
		delete {muted::%{_player}%::*}
		message "&4* &cYou have unbanned %{_player}%"

#Punish
#----Internal Message Commands

command /__mp__ibm__ <text> <text> <text>:
	trigger:
		if executor is player:
			send "Unknown command. Type ""help"" for help."
			stop
		if {mineplex.disguise.%arg-1%} is set:
			set {_p} to {mineplex.disguise.%arg-1%}
		else:
			set {_p} to arg-1
		loop all players:
			if loop-player has permission "mineplex.trainee":
				send "&9Punish> &7%{_p}% banned %arg-2% for %arg-3%." to loop-player

command /__mp__irbm__ <text> <text> <text>:
	trigger:
		if executor is player:
			send "Unknown command. Type ""help"" for help."
			stop
		if {mineplex.disguise.%arg-1%} is set:
			set {_p} to {mineplex.disguise.%arg-1%}
		else:
			set {_p} to arg-1
		loop all players:
			if loop-player has permission "mineplex.trainee":
				send "&9Punish> &7%{_p}% report banned %arg-2% for %arg-3%." to loop-player

command /__mp__imm__ <text> <text> <text>:
	trigger:
		if executor is player:
			send "Unknown command. Type ""help"" for help."
			stop
		if {mineplex.disguise.%arg-1%} is set:
			set {_p} to {mineplex.disguise.%arg-1%}
		else:
			set {_p} to arg-1
		loop all players:
			if loop-player has permission "mineplex.trainee":
				send "&9Punish> &7%{_p}% muted %arg-2% for %arg-3%." to loop-player

command /__mp__iubm__ <text> <text>:
	trigger:
		if executor is player:
			send "Unknown command. Type ""help"" for help."
			stop
		if {mineplex.disguise.%arg-1%} is set:
			set {_p} to {mineplex.disguise.%arg-1%}
		else:
			set {_p} to arg-1
		loop all players:
			if loop-player has permission "mineplex.trainee":
				send "&9Punish> &7%{_p}% unbanned %arg-2%." to loop-player

command /__mp__iumm__ <text> <text>:
	trigger:
		if executor is player:
			send "Unknown command. Type ""help"" for help."
			stop
		if {mineplex.disguise.%arg-1%} is set:
			set {_p} to {mineplex.disguise.%arg-1%}
		else:
			set {_p} to arg-1
		loop all players:
			if loop-player has permission "mineplex.trainee":
				send "&9Punish> &7%{_p}% ummuted %arg-2%." to loop-player

#Prefs System
 
function prefsSystem(p: player , t: number) :: number:
	if {_t} is 1:
		if {mineplex.pref.hpv.%{_p}%} is true:
			set {mineplex.pref.hpv.%{_p}%} to false
			hide all players from {_p}
		else:
			set {mineplex.pref.hpv.%{_p}%} to true
			reveal all players from {_p}
			loop all players:
				if {mineplex.vanish.%loop-player%} is true:
					add loop-player to {%{_p}%.vanishlist::*}
			loop all players:
				if loop-player does not have permission "mineplex.admin":
					hide {%{_p}%.vanishlist::*} from all players
					delete {%{_p}%.vanishlist::*}
	else if {_t} is 2:
		if {mineplex.pref.pc.%{_p}%} is true:
			set {mineplex.pref.pc.%{_p}%} to false
		else:
			set {mineplex.pref.pc.%{_p}%} to true
	else if {_t} is 3:
		if {mineplex.pref.pm.%{_p}%} is true:
			set {mineplex.pref.pm.%{_p}%} to false
		else:
			set {mineplex.pref.pm.%{_p}%} to true
	else if {_t} is 4:
		if {mineplex.pref.gwen.%{_p}%} is true:
			set {mineplex.pref.gwen.%{_p}%} to false
		else:
			set {mineplex.pref.gwen.%{_p}%} to true
	else if {_t} is 5:
		if {mineplex.pref.report.%{_p}%} is true:
			set {mineplex.pref.report.%{_p}%} to false
		else:
			set {mineplex.pref.report.%{_p}%} to true
	else if {_t} is 6:
		if {mineplex.pref.ff.%{_p}%} is true:
			set {mineplex.pref.ff.%{_p}%} to false
		else:
			set {mineplex.pref.ff.%{_p}%} to true
	else if {_t} is 7:
		if {mineplex.ff.%{_p}%} is true:
			set {mineplex.ff.%{_p}%} to false
			delete {mineplex.ff.list::%{_p}%}
		else:
			set {mineplex.ff.%{_p}%} to true
			set {mineplex.ff.list::%{_p}%} to true
 
command /prefs:
	trigger:
		set {_s} to "Steve" parsed as offline player
		open chest with 6 rows named "         &nUser Preferences" to player
		wait 1 tick
		format slot 9 of player with fire charge named "&cHub Stacker" with lore "&c&mNull" to be unstealable
		format slot 18 of player with gray dye named "&cHub Stacker" with lore "&c&mNull" to be unstealable
 
		if {mineplex.pref.hpv.%player%} is true:
			format slot 11 of player with eye of ender named "&aHub Player Visibility" with lore "&a%{mineplex.pref.hpv.%player%}%|| ||&fClick to Toggle" to close then run [prefsSystem(player, 1)]
		else:
			format slot 11 of player with eye of ender named "&cHub Player Visibility" with lore "&c%{mineplex.pref.hpv.%player%}%|| ||&fClick to Toggle" to close then run [prefsSystem(player, 1)]
		if {mineplex.pref.hpv.%player%} is true:
			format slot 20 of player with light green dye named "&aHub Player Visibility" with lore "&a%{mineplex.pref.hpv.%player%}%|| ||&fClick to Toggle" to close then run [prefsSystem(player, 1)]
		else:
			format slot 20 of player with gray dye named "&cHub Player Visibility" with lore "&c%{mineplex.pref.hpv.%player%}%|| ||&fClick to Toggle" to close then run [prefsSystem(player, 1)]
 
 
		if {mineplex.pref.pc.%player%} is true:
			format slot 13 of player with paper named "&aPlayer Chat" with lore "&a%{mineplex.pref.pc.%player%}%|| ||&fClick to Toggle" to close then run [prefsSystem(player, 2)]
		else:
			format slot 13 of player with paper named "&cPlayer Chat" with lore "&c%{mineplex.pref.pc.%player%}%|| ||&fClick to Toggle" to close then run [prefsSystem(player, 2)]
		if {mineplex.pref.pc.%player%} is true:
			format slot 22 of player with light green dye named "&aPlayer Chat" with lore "&a%{mineplex.pref.pc.%player%}%|| ||&fClick to Toggle" to close then run [prefsSystem(player, 2)]
		else:
			format slot 22 of player with gray dye named "&cPlayer Chat" with lore "&c%{mineplex.pref.pc.%player%}%|| ||&fClick to Toggle" to close then run [prefsSystem(player, 2)]
 
		if {mineplex.pref.pm.%player%} is true:
			format slot 15 of player with empty map named "&aPrivate Messaging" with lore "&a%{mineplex.pref.pm.%player%}%|| ||&fClick to Toggle" to close then run [prefsSystem(player, 3)]
		else:
			format slot 15 of player with empty map named "&cPrivate Messaging" with lore "&c%{mineplex.pref.pm.%player%}%|| ||&fClick to Toggle" to close then run [prefsSystem(player, 3)]
		if {mineplex.pref.pm.%player%} is true:
			format slot 24 of player with light green dye named "&aPrivate Messaging" with lore "&a%{mineplex.pref.pm.%player%}%|| ||&fClick to Toggle" to close then run [prefsSystem(player, 3)]
		else:
			format slot 24 of player with gray dye named "&cPrivate Messaging" with lore "&c%{mineplex.pref.pm.%player%}%|| ||&fClick to Toggle" to close then run [prefsSystem(player, 3)]
 
 
		format slot 17 of player with player's skull named "&cHub Party Requests" with lore "&c&mNull" to be unstealable
		format slot 26 of player with gray dye named "&cHub Party Requests" with lore "&c&mNull" to be unstealable
 
 
		format slot 40 of player with red flower named "&cShow Pending Friend Requests" with lore "&c&mNull" to be unstealable
		format slot 49 of player with gray dye named "&cShow Pending Friend Requests" with lore "&c&mNull" to be unstealable
 
 
		if player has permission "mineplex.trainee":
			if {mineplex.pref.gwen.%player%} is true:
				format slot 42 of player with paper named "&aGWEN Reports" with lore "&a%{mineplex.pref.gwen.%player%}%|| ||&fClick to Toggle" to close then run [prefsSystem(player, 4)]
			else:
				format slot 42 of player with paper named "&cGWEN Reports" with lore "&c%{mineplex.pref.gwen.%player%}%|| ||&fClick to Toggle" to close then run [prefsSystem(player, 4)]
			if {mineplex.pref.gwen.%player%} is true:
				format slot 51 of player with light green dye named "&aGWEN Reports" with lore "&a%{mineplex.pref.gwen.%player%}%|| ||&fClick to Toggle" to close then run [prefsSystem(player, 4)]
			else:
				format slot 51 of player with gray dye named "&cGWEN Reports" with lore "&c%{mineplex.pref.gwen.%player%}%|| ||&fClick to Toggle" to close then run [prefsSystem(player, 4)]
 
			if {mineplex.pref.ff.%player%} is true:
				format slot 44 of player with saddle named "&aHub Ignore Velocity" with lore "&a%{mineplex.pref.ff.%player%}%|| ||&fClick to Toggle" to close then run [prefsSystem(player, 6)]
			else:
				format slot 44 of player with saddle named "&cHub Ignore Velocity" with lore "&c%{mineplex.pref.ff.%player%}%|| ||&fClick to Toggle" to close then run [prefsSystem(player, 6)]
			if {mineplex.pref.ff.%player%} is true:
				format slot 53 of player with light green dye named "&aHub Ignore Velocity" with lore "&a%{mineplex.pref.ff.%player%}%|| ||&fClick to Toggle" to close then run [prefsSystem(player, 6)]
			else:
				format slot 53 of player with gray dye named "&cHub Ignore Velocity" with lore "&c%{mineplex.pref.ff.%player%}%|| ||&fClick to Toggle" to close then run [prefsSystem(player, 6)]
 
			if {mineplex.pref.report.%player%} is true:
				format slot 36 of player with book named "&aUser Reports" with lore "&a%{mineplex.pref.report.%player%}%|| ||&fClick to Toggle" to close then run [prefsSystem(player, 5)]
			else:
				format slot 36 of player with book named "&cUser Reports" with lore "&c%{mineplex.pref.report.%player%}%|| ||&fClick to Toggle" to close then run [prefsSystem(player, 5)]
			if {mineplex.pref.report.%player%} is true:
				format slot 45 of player with light green dye named "&aUser Reports" with lore "&a%{mineplex.pref.report.%player%}%|| ||&fClick to Toggle" to close then run [prefsSystem(player, 5)]
			else:
				format slot 45 of player with gray dye named "&cUser Reports" with lore "&c%{mineplex.pref.report.%player%}%|| ||&fClick to Toggle" to close then run [prefsSystem(player, 5)]
 
			if {mineplex.ff.%player%} is true:
				format slot 38 of player with slimeball named "&aHub Forcefield" with lore "&a%{mineplex.ff.%player%}%|| ||&fClick to Toggle" to close then run [prefsSystem(player, 7)]
			else:
				format slot 38 of player with slimeball named "&cHub Forcefield" with lore "&c%{mineplex.ff.%player%}%|| ||&fClick to Toggle" to close then run [prefsSystem(player, 7)]
			if {mineplex.ff.%player%} is true:
				format slot 47 of player with light green dye named "&aHub Forcefield" with lore "&a%{mineplex.ff.%player%}%|| ||&fClick to Toggle" to close then run [prefsSystem(player, 7)]
			else:
				format slot 47 of player with gray dye named "&cHub Forcefield" with lore "&c%{mineplex.ff.%player%}%|| ||&fClick to Toggle" to close then run [prefsSystem(player, 7)]
 
 
		if player has permission "mineplex.youtube":
			if {mineplex.pref.ff.%player%} is true:
				format slot 44 of player with saddle named "&aHub Ignore Velocity" with lore "&a%{mineplex.pref.ff.%player%}%|| ||&fClick to Toggle" to close then run [prefsSystem(player, 6)]
			else:
				format slot 44 of player with saddle named "&cHub Ignore Velocity" with lore "&c%{mineplex.pref.ff.%player%}%|| ||&fClick to Toggle" to close then run [prefsSystem(player, 6)]
			if {mineplex.pref.ff.%player%} is true:
				format slot 53 of player with light green dye named "&aHub Ignore Velocity" with lore "&a%{mineplex.pref.ff.%player%}%|| ||&fClick to Toggle" to close then run [prefsSystem(player, 6)]
			else:
				format slot 53 of player with gray dye named "&cHub Ignore Velocity" with lore "&c%{mineplex.pref.ff.%player%}%|| ||&fClick to Toggle" to close then run [prefsSystem(player, 6)]
 
 
			if {mineplex.ff.%player%} is true:
				format slot 38 of player with slimeball named "&aHub Forcefield" with lore "&a%{mineplex.ff.%player%}%|| ||&fClick to Toggle" to close then run [prefsSystem(player, 7)]
			else:
				format slot 38 of player with slimeball named "&cHub Forcefield" with lore "&c%{mineplex.ff.%player%}%|| ||&fClick to Toggle" to close then run [prefsSystem(player, 7)]
			if {mineplex.ff.%player%} is true:
				format slot 47 of player with light green dye named "&aHub Forcefield" with lore "&a%{mineplex.ff.%player%}%|| ||&fClick to Toggle" to close then run [prefsSystem(player, 7)]
			else:
				format slot 47 of player with gray dye named "&cHub Forcefield" with lore "&c%{mineplex.ff.%player%}%|| ||&fClick to Toggle" to close then run [prefsSystem(player, 7)]
 
 
		if player has permission "mineplex.twitch":
			if {mineplex.pref.ff.%player%} is true:
				format slot 44 of player with saddle named "&aHub Ignore Velocity" with lore "&a%{mineplex.pref.ff.%player%}%|| ||&fClick to Toggle" to close then run [prefsSystem(player, 6)]
			else:
				format slot 44 of player with saddle named "&cHub Ignore Velocity" with lore "&c%{mineplex.pref.ff.%player%}%|| ||&fClick to Toggle" to close then run [prefsSystem(player, 6)]
			if {mineplex.pref.ff.%player%} is true:
				format slot 53 of player with light green dye named "&aHub Ignore Velocity" with lore "&a%{mineplex.pref.ff.%player%}%|| ||&fClick to Toggle" to close then run [prefsSystem(player, 6)]
			else:
				format slot 53 of player with gray dye named "&cHub Ignore Velocity" with lore "&c%{mineplex.pref.ff.%player%}%|| ||&fClick to Toggle" to close then run [prefsSystem(player, 6)]
 
 
			if {mineplex.ff.%player%} is true:
				format slot 38 of player with slimeball named "&aHub Forcefield" with lore "&a%{mineplex.ff.%player%}%|| ||&fClick to Toggle" to close then run [prefsSystem(player, 7)]
			else:
				format slot 38 of player with slimeball named "&cHub Forcefield" with lore "&c%{mineplex.ff.%player%}%|| ||&fClick to Toggle" to close then run [prefsSystem(player, 7)]
			if {mineplex.ff.%player%} is true:
				format slot 47 of player with light green dye named "&aHub Forcefield" with lore "&a%{mineplex.ff.%player%}%|| ||&fClick to Toggle" to close then run [prefsSystem(player, 7)]
			else:
				format slot 47 of player with gray dye named "&cHub Forcefield" with lore "&c%{mineplex.ff.%player%}%|| ||&fClick to Toggle" to close then run [prefsSystem(player, 7)]

#GWEN CODING! (Using my old plugin Shield) (I took it down as I was ripping off json.sk but wtevr)

on damage:
	if "%Victim's name%" is "BeamCow" or "BeamGuar":
		cancel event
on death:
	if "%Victim's name%" is "BeamCow" or "BeamGuar":
		clear drops

on quit:
	delete {forcefield.past.%player%}

function beamGo(p: player) :: number:
	apply slowness 255 to {_p} for 7 seconds
	set {_p2} to location 3 blocks in front of {_p}
	add 5 to y-coordinate of {_p2}
	set {_p3} to location 3 blocks behind {_p}
	add 5 to y-coordinate of {_p3}
	set {_p4} to location 3 blocks left of {_p}
	add 5 to y-coordinate of {_p4}
	set {_p5} to location 3 blocks right of {_p}
	add 5 to y-coordinate of {_p5}
	spawn a guardian at {_p2}
	add "{CustomName:""BeamCow"", NoGravity:1, Silent:1}" to nbt of last spawned entity
	set {_t2} to last spawned entity
	spawn a guardian at {_p3}
	add "{CustomName:""BeamCow"", NoGravity:1, Silent:1}" to nbt of last spawned entity
	set {_t3} to last spawned entity
	spawn a guardian at {_p4}
	add "{CustomName:""BeamCow"", NoGravity:1, Silent:1}" to nbt of last spawned entity
	set {_t4} to last spawned entity
	spawn a guardian at {_p5}
	add "{CustomName:""BeamCow"", NoGravity:1, Silent:1}" to nbt of last spawned entity
	set {_t5} to last spawned entity
	set {_player} to {_p}
	set {_r} to randomize "abcdefgh123456789!@##$+"
	set {banned::%{_player}%} to true
	set {banned::%{_player}%::type} to "perm"
	set {banned::%{_player}%::reason} to "[GWEN] %{_r}%"
	set {banned::%{_player}%::staff} to "Mineplex Anti-Cheat"
	set {banned::%{_player}%::when} to now
	add "&ePunishment Type: &fOther||||&eReason: &f[GWEN] %{_r}%||||&eStaff: &fChiss||||&eDate: &f%now%" to {p.%{_player}%::history::*}
	Beam({_p}, {_t2})
	Beam({_p}, {_t3})
	Beam({_p}, {_t4})
	Beam({_p}, {_t5})
	wait 5.2 seconds
	broadcast "&9GWEN> &7%{_p}% has been banned. I am always watching"
	kick {_player} due to "&c&lYou are banned for Permanent by Mineplex Anti-Cheat%nl%&f[GWEN] %{_r}%%nl%&2Unfairly banned? Appeal at &a%{mineplex.config.appealwebsite}%"

command /gwenban <player>:
	permission: mineplex.admin
	permission message: &9Permissions> &7This requires Permission Rank [&9ADMIN&7].
	trigger:
		beamGo(arg-1)

on shoot:
	if {shield.toggle.fbow} is false:
		stop
	else:
		if projectile is an arrow:
			if difference between {bow.%shooter%} and now is less than 2 ticks:
				gwenAlert((shooter), ("Fast Bow"))
				
every 1.5 second:
	if {shield.toggle.fly} is false:
		stop
	else:
		loop all players:
			loop-player's gamemode is not creative
			loop-player is not flying
			set {_block} to the block below loop-player
			while {_block} is air :
				set {_block} to the block below {_block}
				add 1 to {_altitude}
			wait 1 second
			set {_block} to the block below loop-player
			while {_block} is air :
				set {_block} to the block below {_block}
				add 1 to {_altitude2}
			set {_y} to y-coordinate of location of loop-player
			set {_y} to rounded down {_y} 
			set {_loc1} to block north east loop-player
			set {_loc2} to block south west below loop-player
			loop blocks within {_loc1} to {_loc2}: 
				if loop-block is not air:
					set {_y2} to y-coordinate of location of loop-block
					set {_y2} to rounded down {_y2}
					if {_y2} = {_y}: 
						add 1 to {_wall}
					else:
						add 1 to {_edge}
			if {_altitude2} >= {_altitude}:
				{_altitude} > 2
				{jump.%loop-player%} is false
				if {_edge} is not set :
					gwenAlert((attacker), ("Fly (Raise)"))
				if {_edge} < 3 :
					{_wall} > 0
					gwenAlert((attacker), ("Fly (Raise)"))
			delete {_edge}
			delete {_wall}
on jump:
	set {jump.%player%} to true
	wait 5 ticks
	set {jump.%player%} to false
	

on damage:
	if {shield.toggle.ff} is false:
		stop
	else:
		attacker is a player
		projectile doesn't exist
		if target of attacker is victim:
			stop
		cancel event
		add 1 to {forcefield.%attacker%}
		if {forcefield.%attacker%} > 5:
			if {forcefield.past.%attacker%	} is not set:
				set {forcefield.past.%attacker%} to 1
				gwenAlert((attacker), ("Forcefield"))
				wait 3 seconds
				reduce {forcefield.%attacker%} by 1
				stop
			else if {forcefield.past.%attacker%} is 1:
				gwenAlert((attacker), ("§aForcefield"))
				add 1 to {forcefield.past.%attacker%}
				wait 3 seconds
				reduce {forcefield.%attacker%} by 1
				stop
			else if {forcefield.past.%attacker%} is 2:
				gwenAlert((attacker), ("§eForcefield"))
				add 1 to {forcefield.past.%attacker%}
				wait 3 seconds
				reduce {forcefield.%attacker%} by 1
				stop
			else if {forcefield.past.%attacker%} is 3:
				gwenAlert((attacker), ("§cForcefield"))
				add 1 to {forcefield.past.%attacker%}
				wait 3 seconds
				reduce {forcefield.%attacker%} by 1
				stop
			else if {forcefield.past.%attacker%} is 4:
				gwenAlert((attacker), ("§4Forcefield"))
				add 1 to {forcefield.past.%attacker%}
				wait 3 seconds
				reduce {forcefield.%attacker%} by 1
				stop

every 4 second :
	set {autoclick.check} to true
	wait 3 second
	set {autoclick.check} to false
	loop all players :
		delete {player.click.%loop-player%}

on left click :
	if {shield.toggle.ac} is false:
		stop
	else:
		{autoclick.check} is true
		add 1 to {player.click.%player%}
		{player.click.%player%} > 69
		gwenAlert((player), ("High CPS (%{player.click.%player%} / 3% cpsps)"))

on damage of a player :
	if {shield.toggle.akb} is false:
		stop
	else:
		block at victim is not cobweb	
		victim is not riding
		victim is not on fire
		set {_loc9} to block north east victim
		set {_loc8} to block south west victim
		blocks within {_loc9} to {_loc8} is air
		set {_loc} to location of victim
		wait 10 ticks
		set {_loc2} to location of victim
		distance between {_loc} and {_loc2} = 0
		victim's ping < 250
		gwenAlert((victim), ("Velocity"))

#Systems

on leftclick holding tnt:
	if {mineplex.tntlauncher} is true:
		player has 1 tnt
		spawn a primed tnt 1 meter above the player
		add "{Fuse:60}" to nbt of the spawned entity
		push the spawned entity in direction of player at speed 0.9
		push the spawned entity upwards at speed 0.2
		remove 1 tnt from player

on rightclick holding tnt:
	if {mineplex.tntlauncher} is true:
		player has 1 tnt
		spawn a primed tnt 1 meter above the player
		add "{Fuse:60}" to nbt of the spawned entity
		push the spawned entity in direction of player at speed 0.9
		push the spawned entity upwards at speed 0.2
		remove 1 tnt from player

#Command Completers

on tab completer for "/mineplex-core":
	add "help" to completions
	add "useChat" to completions
	add "setAdmin" to completions
	add "chestPoint" to completions
	add "chestPointSub" to completions
	add "titleOnJoin" to completions
	add "reload" to completions
	add "useScoreboard" to completions
	add "spawnCarl" to completions
	add "throwableTnt" to completions

on tab completer for "/tp":
	add "here" to completions
	add "all" to completions
	loop all players:
		add "%loop-player%" to completions

on tab completer for "/give":
	if player has permission "mineplex.admin":
		loop all items:
			add "%loop-value%" to completions
		loop all players:
			add "%loop-player%" to completions
		add "ALL" to completions

#Stats



#Modules

on load:
	delete {mineplex::modules::*}
	set {mineplex.modulesapi.online} to true

on unload:
	delete {mineplex::modules::*}
	set {mineplex.modulesapi.online} to false

command /modules:
	trigger:
		send "&9Modules> &7Modules API version 0.1"
		send "&9Modules> &7Going to *attempt* to list modules."
		send "&9Modules> &7This does not mean that your module is not loaded."
		loop {mineplex::modules::*}:
			send "&9Modules> &e%loop-value%"

#add "Bungee Module" to {mineplex::modules::*}
#remove "Bungee Module" from {mineplex::modules::*}

#MPS

#on load:
#	if {wget} is not set:
#		download file from "" to file "./WheezyMap.zip"

#command /mpsconfirm:
#	permission: mineplex.legend
#	trigger:
#		if {mineplex.mps.%player%} is not set:
#			send "&9Personal Server Manager> &7%player%-1 successfully created. You will be sent to it shortly."
#			send "&9Personal Server Manager> &7If you haven't been connected in 20 seconds, type /server %player%-1."
#			copy dir "./mps/Mineplex" to "./mps/%player%-1/"
#			load world "./mps/%player%-1"
#			set {mps.%player%-1} to "yes"
#			wait 20 seconds
#		else:
#			send "&9Personal Server Manager> &7Your server is still being created or already exists. If you haven't been connected in 20 seconds, type /server %player%-1."

#command /hostserver:
#	permission: mineplex.op
#	trigger:
#		if {mineplex.mps.%player%} is not set:
#			send "&9Personal Server Manager> &7%player%-1 successfully created. You will be sent to it shortly."
#			send "&9Personal Server Manager> &7If you haven't been connected in 20 seconds, type /server %player%-1."
#			create folder "./mps/%player%-1"
#			load world "./mps/%player%-1"
#			wait 20 seconds
#			skellett teleport player to world "./mps/%player%-1"
#		else:
#			send "&9Personal Server Manager> &7Your server is still being created or already exists. If you haven't been connected in 20 seconds, type /server %player%-1."

#command /endserver:
#	trigger:
#		loop all players:
#			loop-player's world is "./mps/%player%-1":
#				skellett teleport loop-player to world "world"
#		unload world "./mps/%player%-1"
#		wait 2 seconds
#		delete folder "./mps/%player%-1/data/"
#		delete folder "./mps/%player%-1/region/"
#		delete file "./mps/%player%-1/level.dat"
#		delete file "./mps/%player%-1/uid.dat"
#		delete file "./mps/%player%-1/session.lock"
#		delete dir "./mps/%player%-1"

#command /tpwrd <text>:
#	trigger:
#		skellett teleport player to world "%arg-1%"

#command /menu:
#	trigger:
#		open chest with 3 rows named "Private Server Menu" to player
#		wait 1 tick
#		format slot 11 of player with diamond sword named "&a&lGive Co-Host" with lore "||&e" to close then run [execute console command "say no way hosay"]
#		format slot 13 of player with lava bucket named "&aRemove Player" with lore "||&e" to close then run [execute console command "kick Citrin_ lol"]
#		format slot 15 of player with redstone comparator item named "&aGame Options" with lore "||&e" to close then run [execute console command "say xd"]
#		format slot 20 of player with golden sword named "&a&lRemove Co-Host" with lore "||&e" to close then run [execute console command "say no way hosay"]
#		format slot 22 of player with water bucket named "&a&lUn-Remove Player" with lore "||&e" to close then run [execute console command "say no way hosay"]
#		format slot 24 of player with tnt named "&a&lKill Private Server" with lore "||&7Shift-Right Click to Kill Private Server" to close then run [execute console command "say xd"]


#skPerms by LimeGlass
#Thanks for Letting Me Bake This In!
options:
	prefix: &6[&5SkPerms&6]
	maincolour: &6
	secondcolour: &7
	command: /skperms
	aliases: /perm, /permission
	permission: skperms.admin
	
	#CMD protection is basically extra security for your server. Only players inside of a list variable can use SkPerms
	CMDprotection: false
	CMDprotectionMsg: Unknown command. Type ""/help"" for help
	#The player list is the list variable that contains players that can use SkPerms if CMDprotection is enabled
	PlayerList: {example::players::*}
	
	UseChat: false #use prefix and suffix in the chat
	#Chat types:
	#Display - Changes the player's display name (Vault will hook if installed)
	#Override - !COMING SOON
	ChatType: "Display"
	
	version: 1.0.5

on script load:
	if file "plugins\SkPerms" exists:
		delete {skperms::config::*}
	else:
		set yaml value "version" from file "plugins\SkPerms\config.yml" to "{@version}"
		set yaml value "useYML" from file "plugins\SkPerms\config.yml" to false
	set {skperms::config::version} to yaml value "version" from file "plugins\SkPerms\config.yml"
	set {skperms::config::useYML} to yaml value "useYML" from file "plugins\SkPerms\config.yml"
	if {skperms::config::useYML} is true:
		if {skperms::players::*} is not set:
			stop
		delete file "plugins\SkPerms\players.yml"
		loop {skperms::players::*}:
			loop {skperms::player::%loop-value%::permissions::*}:
				add "%loop-value-2%" to yaml list "players.%loop-value-1%.permissions" from file "plugins\SkPerms\players.yml"
on script unload:
	loop {skperms::groups::*}:
		if {skperms::group::%loop-value%::*} is not set:
			loop {skperms::group::%loop-value-1%::permissions::*}:
				loop {skperms::players::*}:
					remove "%loop-value-2%" from {skperms::player::%loop-value-3%::permissions::*}
			loop {skperms::players::*}:
				remove "%loop-value-1%" from {skperms::player::%loop-value-2%::groups::*}
				if {skperms::player::%loop-value-2%::groups::*} is not empty:
					loop {skperms::player::%loop-value-2%::groups::*}:
						loop {skperms::group::%loop-value-1%::permissions::*}:
							set {_p} to "%loop-value-2%" parsed as player
							add "%loop-value-4%" to {_p}'s permissions
			remove "%loop-value%" from {skperms::groups::*}
command {@command} [<text>] [<text>] [<text>] [<text>] [<text>]:
	permission: {@permission}
	aliases: {@aliases}
	trigger:
		if {@CMDprotection} is true:
			if command sender is not console:
				if {@PlayerList} doesn't contain player or "%player%":
					message "{@CMDprotectionMsg}"
					stop
		if arg 1 is not set:
			message ""
			message "{@prefix} v{@version}:"
			message "{@maincolour}{@command} deleteDefault"
			message "{@secondcolour}Deletes default group setting (If set)"
			message "{@maincolour}{@command} (d|default) (group)"
			if {skperms::default} is set:
				message "{@secondcolour}Set the default group {@maincolour}(&7%{skperms::default}%{@maincolour})"
			else:
				message "{@secondcolour}Set the default group"
			message "{@maincolour}{@command} (p|player) (player) (add|remove|list) permission [permission]"
			message "{@secondcolour}Add/remove/list a players permissions"
			message "{@maincolour}{@command} (p|player) (player) (add|set|remove|list) group [group]"
			message "{@secondcolour}Add/remove/set/list a players group"
			message "{@maincolour}{@command} (g|group) (group) (add|remove|list) permission [permission]"
			message "{@secondcolour}Add/remove/list a group permission"
			message "{@maincolour}{@command} (g|group) (group) (add|remove|list) group [group]"
			message "{@secondcolour}Add/remove/list a groups connected groups"
			message "{@secondcolour}A group is created once it contains a permission"
			message "{@maincolour}{@command} (g|group) (group) (prefix|suffix) set (text)"
			message "{@secondcolour}Set a suffix or prefix to a group"
			message ""
		else if arg 1 is "deleteDefault":
			delete {skperms::default}
			message "{@prefix} {@maincolour}Removed default group (No group set)"
		else if arg 1 is "d", "setdefault" or "default":
			if arg 2 is set:
				set {skperms::default} to "%arg 2%"
				message "{@prefix} {@maincolour}Set default group to &l%arg 2%"
			else:
				message "{@prefix} {@maincolour}Error: Group not specified"
		else if arg 1 is "p" or "player":
			if arg 2 is not set:
				message "{@prefix} {@maincolour}Error: Player not specified"
			else if arg 2 is set:
				if arg 3 is "a" or "add":
					if arg 4 is "p", "permission" or "permissions":
						if arg 5 is set:
							if {skperms::groups::*} doesn't contain "%arg 2%":	
								add "%arg 2%" to {skperms::groups::*}
							set {_player} to arg 2 parsed as player
							add "%arg 5%" to {_player}'s permissions
							set {skperms::player::%arg 2%::permissions::*} to {_player}'s permissions
							message "{@prefix} {@maincolour}Added %arg 5% to %arg 2%'s permissions"
						else:
							message "{@prefix} {@maincolour}Error: Permission not specified"
					else if arg 4 is "g", "group" or "groups":
						if arg 5 is set:
							if {skperms::groups::*} doesn't contain "%arg 2%":	
								add "%arg 2%" to {skperms::groups::*}
							if {skperms::player::%arg 2%::groups::*} doesn't contain "%arg 5%":
								add "%arg 5%" to {skperms::player::%arg 2%::groups::*}
							else:
								message "{@prefix} {@secondcolour}%arg 2% already has group %arg 5%"
								stop
							message "{@prefix} {@maincolour}Added %arg 2% to group %arg 5%"
							if {@UseChat} is true:
								if {@ChatType} is "Display" or "display":
									loop all players:
										if {skperms::player::%player%::groups::*} contains "%arg 5%":
											if {skperms::group::%arg 5%::prefix} is set:
												if {skperms::group::%arg 5%::suffix} is set:
													set loop-player's display name to coloured "%{skperms::group::%arg 5%::prefix}%%loop-player%%{skperms::group::%arg 5%::suffix}%"
												else:
													set loop-player's display name to coloured "%{skperms::group::%arg 5%::prefix}%%loop-player%"
											else if {skperms::group::%arg 5%::suffix} is set:
												set loop-player's display name to coloured "%loop-player%%{skperms::group::%arg 5%::suffix}%"
											else:
												set loop-player's display name to "%player%"
									loop all players:
										if {skperms::player::%player%::groups::*} is not set:
											set loop-player's display name to "%player%"
						else:
							message "{@prefix} {@maincolour}Error: Group not specified"
					else:
						message "{@prefix} {@maincolour}Error: Type not specified"
				else if arg 3 is "s" or "set":
					if arg 4 is "g", "group" or "groups":
						if arg 5 is set:
							if {skperms::groups::*} doesn't contain "%arg 2%":	
								add "%arg 2%" to {skperms::groups::*}
							delete {skperms::player::%arg 2%::groups::*}
							add "%arg 5%" to {skperms::player::%arg 2%::groups::*}
							message "{@prefix} {@maincolour}Set %arg 2% to group %arg 5%"
							if {@UseChat} is true:
								if {@ChatType} is "Display" or "display":
									loop all players:
										if {skperms::player::%player%::groups::*} contains "%arg 5%":
											if {skperms::group::%arg 5%::prefix} is set:
												if {skperms::group::%arg 5%::suffix} is set:
													set loop-player's display name to coloured "%{skperms::group::%arg 5%::prefix}%%loop-player%%{skperms::group::%arg 5%::suffix}%"
												else:
													set loop-player's display name to coloured "%{skperms::group::%arg 5%::prefix}%%loop-player%"
											else if {skperms::group::%arg 5%::suffix} is set:
												set loop-player's display name to coloured "%loop-player%%{skperms::group::%arg 5%::suffix}%"
											else:
												set loop-player's display name to "%player%"
									loop all players:
										if {skperms::player::%player%::groups::*} is not set:
											set loop-player's display name to "%player%"
						else:
							message "{@prefix} {@maincolour}Error: Group not specified"
					else:
						message "{@prefix} {@maincolour}Error: Type not specified"
				else if arg 3 is "r" or "remove":
					if arg 4 is "p", "permission" or "permissions":
						if arg 5 is set:
							set {_player} to arg 2 parsed as player
							remove "%arg 5%" from {_player}'s permissions
							set {skperms::player::%arg 2%::permissions::*} to {_player}'s permissions
							message "{@prefix} {@maincolour}Removed %arg 5% from %arg 2%'s permissions"
						else:
							message "{@prefix} {@maincolour}Error: Permission not specified"
					else if arg 4 is "g", "group" or "groups":
						if arg 5 is set:
							if {skperms::player::%arg 2%::groups::*} contains "%arg 5%":
								remove "%arg 5%" from {skperms::player::%arg 2%::groups::*}
								message "{@prefix} {@maincolour}Removed %arg 2% from group %arg 5%"
								if {@UseChat} is true:
									if {@ChatType} is "Display" or "display":
										loop all players:
											if {skperms::player::%player%::groups::*} contains "%arg 5%":
												if {skperms::group::%arg 5%::prefix} is set:
													if {skperms::group::%arg 5%::suffix} is set:
														set loop-player's display name to coloured "%{skperms::group::%arg 5%::prefix}%%loop-player%%{skperms::group::%arg 5%::suffix}%"
													else:
														set loop-player's display name to coloured "%{skperms::group::%arg 5%::prefix}%%loop-player%"
												else if {skperms::group::%arg 5%::suffix} is set:
													set loop-player's display name to coloured "%loop-player%%{skperms::group::%arg 5%::suffix}%"
												else:
													set loop-player's display name to "%player%"
										loop all players:
											if {skperms::player::%player%::groups::*} is not set:
												set loop-player's display name to "%player%"
							else:
								message "{@prefix} {@maincolour}Error: Player %arg 2% doesn't have that group"
						else:
							message "{@prefix} {@maincolour}Error: Group not specified"
					else:
						message "{@prefix} {@maincolour}Error: Type not specified"
				else if arg 3 is "l" or "list":
					if arg 4 is "p", "permission" or "permissions":
						set {_player} to arg 2 parsed as player
						message "{@prefix} {@maincolour}%{_player}'s permissions%"
					else if arg 4 is "g", "group" or "groups":
						message "{@prefix} {@maincolour}%{skperms::player::%arg 2%::groups::*}%"
					else:
						message "{@prefix} {@maincolour}Error: Type not specified"
		else if arg 1 is "g", "group" or "groups":
			if arg 2 is not set:
				message "{@prefix} {@maincolour}Error: Group not specified"
			else if arg 2 is set:
				if arg 3 is "a" or "add":
					if arg 4 is "p", "permission" or "permissions":
						if arg 5 is set:
							if {skperms::groups::*} doesn't contain "%arg 2%":	
								add "%arg 2%" to {skperms::groups::*}
							add "%arg 5%" to {skperms::group::%arg 2%::permissions::*}
							message "{@prefix} {@maincolour}Added %arg 5% to group %arg 2%'s permissions"
							loop all players:
								if {skperms::player::%player%::groups::*} contains "%arg 2%":
									loop {skperms::group::%arg 2%::permissions::*}:
										add "%loop-value-2%" to loop-player's permissions
						else:
							message "{@prefix} {@maincolour}Error: Permission not specified"
					else if arg 4 is "g", "group" or "groups":
						if arg 5 is set:
							if {skperms::groups::*} doesn't contain "%arg 2%":	
								add "%arg 2%" to {skperms::groups::*}
							loop {skperms::group::%arg 5%::permissions::*}:
								add "%loop-value%" to {skperms::group::%arg 2%::permissions::*}
							message "{@prefix} {@maincolour}Added %arg 5%'s permissions to group %arg 2%"
							loop all players:
								if {skperms::player::%player%::groups::*} contains "%arg 2%":
									loop {skperms::group::%arg 2%::permissions::*}:
										add "%loop-value-2%" to loop-player's permissions
						else:
							message "{@prefix} {@maincolour}Error: Group not specified"
					else:
						message "{@prefix} {@maincolour}Error: Type not specified"
				else if arg 3 is "r" or "remove":
					if arg 4 is "p", "permission" or "permissions":
						if arg 5 is set:
							loop all players:
								if {skperms::player::%player%::groups::*} contains "%arg 2%":
									loop {skperms::group::%arg 2%::permissions::*}:
										remove "%loop-value-2%" from loop-player's permissions
							remove "%arg 5%" from {skperms::group::%arg 2%::permissions::*}
							message "{@prefix} {@maincolour}Removed %arg 5% from group %arg 2%'s permissions"
							loop all players:
								if {skperms::player::%player%::groups::*} contains "%arg 2%":
									loop {skperms::group::%arg 2%::permissions::*}:
										add "%loop-value-2%" to loop-player's permissions
						else:
							message "{@prefix} {@maincolour}Error: Permission not specified"
					else if arg 4 is "g", "group" or "groups":
						if arg 5 is set:
							loop all players:
								if {skperms::player::%player%::groups::*} contains "%arg 2%":
									loop {skperms::group::%arg 2%::permissions::*}:
										remove "%loop-value-2%" from loop-player's permissions
							loop {skperms::group::%arg 5%::permissions::*}:
								remove "%loop-value%" from {skperms::group::%arg 2%::permissions::*}
								add 1 to {_l}
							message "{@prefix} {@maincolour}Removed %{_l}% of %arg 5%'s permissions from group %arg 2%"
							loop all players:
								if {skperms::player::%player%::groups::*} contains "%arg 2%":
									loop {skperms::group::%arg 2%::permissions::*}:
										add "%loop-value-2%" to loop-player's permissions
						else:
							message "{@prefix} {@maincolour}Error: Group not specified"
					else:
						message "{@prefix} {@maincolour}Error: Type not specified"
				else if arg 3 is "l" or "list":
					if arg 4 is "p", "permission" or "permissions":
						message "{@prefix} {@maincolour}%{skperms::group::%arg 2%::permissions::*}%"
					else:
						message "{@prefix} {@maincolour}Error: Type not specified"
				else if arg 3 is "prefix" or "suffix":
					if arg 4 is "set":
						if arg 5 is set:
							set {skperms::group::%arg 2%::%arg 3%} to "%arg 5%"
							message "{@prefix} {@maincolour}%arg 3% set to %arg 5%"
							if {@UseChat} is true:
								if {@ChatType} is "Display" or "display":
									loop all players:
										if {skperms::player::%player%::groups::*} contains "%arg 5%":
											if {skperms::group::%arg 5%::prefix} is set:
												if {skperms::group::%arg 5%::suffix} is set:
													set loop-player's display name to coloured "%{skperms::group::%arg 5%::prefix}%%loop-player%%{skperms::group::%arg 5%::suffix}%"
												else:
													set loop-player's display name to coloured "%{skperms::group::%arg 5%::prefix}%%loop-player%"
											else if {skperms::group::%arg 5%::suffix} is set:
												set loop-player's display name to coloured "%loop-player%%{skperms::group::%arg 5%::suffix}%"
											else:
												set loop-player's display name to "%player%"
									loop all players:
										if {skperms::player::%player%::groups::*} is not set:
											set loop-player's display name to "%player%"
						else:
							message "{@prefix} {@maincolour}Prefix/Suffix not specified"
					else:
						message "{@prefix} {@maincolour}Error: Type not specified (Type ""set"")"
on quit:
	set {skperms::player::%player%::permissions::*} to player's permissions
on join:
	loop 2 times:
		remove "%player%" from {skperms::players::*}
	add "%player%" to {skperms::players::*}
	loop {skperms::groups::*}:
		if player has permission "skperms.group.%loop-value%":
			if {skperms::player::%player%::groups::*} doesn't contain "%loop-value%":
				add "%loop-value%" to {skperms::player::%player%::groups::*}
	if {skperms::default} is set:
		loop {skperms::group::%{skperms::default}%::permissions::*}:
			add "%loop-value%" to player's permissions
	loop {skperms::player::%player%::permissions::*}:
		add "%loop-value%" to player's permissions
	if {skperms::player::%player%::groups::*} is not empty:
		loop {skperms::player::%player%::groups::*}:
			loop {skperms::group::%loop-value%::permissions::*}:
				add "%loop-value-2%" to player's permissions
			if {@UseChat} is true:
				if {@ChatType} is "Display" or "display":
					if {skperms::group::%loop-index%::prefix} is set:
						if {skperms::group::%loop-index%::suffix} is set:
							set player's display name to coloured "%{skperms::group::%loop-index%::prefix}%%player%%{skperms::group::%loop-index%::suffix}%"
						else:
							set player's display name to coloured "%{skperms::group::%loop-index%::prefix}%%player%"
					else if {skperms::group::%loop-index%::suffix} is set:
						set player's display name to coloured "%player%%{skperms::group::%loop-index%::suffix}%"
					else:
						set player's display name to "%player%"
				loop all players:
					if {skperms::player::%player%::groups::*} is not set:
						set loop-player's display name to "%player%"
